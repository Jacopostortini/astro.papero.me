{"remainingRequest":"/media/jacopo/VolumeDati/Documenti/papero.tk/cosmos.papero.me/node_modules/thread-loader/dist/cjs.js!/media/jacopo/VolumeDati/Documenti/papero.tk/cosmos.papero.me/node_modules/babel-loader/lib/index.js!/media/jacopo/VolumeDati/Documenti/papero.tk/cosmos.papero.me/node_modules/eslint-loader/index.js??ref--13-0!/media/jacopo/VolumeDati/Documenti/papero.tk/cosmos.papero.me/src/phaser/GameScene.js","dependencies":[{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/cosmos.papero.me/src/phaser/GameScene.js","mtime":1617446273496},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/cosmos.papero.me/node_modules/cache-loader/dist/cjs.js","mtime":1616495189815},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/cosmos.papero.me/node_modules/thread-loader/dist/cjs.js","mtime":1616495190967},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/cosmos.papero.me/node_modules/babel-loader/lib/index.js","mtime":1616495189787},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/cosmos.papero.me/node_modules/eslint-loader/index.js","mtime":1616495190059}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9jb3Ntb3MucGFwZXJvLm1lL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiL21lZGlhL2phY29wby9Wb2x1bWVEYXRpL0RvY3VtZW50aS9wYXBlcm8udGsvY29zbW9zLnBhcGVyby5tZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIi9tZWRpYS9qYWNvcG8vVm9sdW1lRGF0aS9Eb2N1bWVudGkvcGFwZXJvLnRrL2Nvc21vcy5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKaW1wb3J0IF9jcmVhdGVTdXBlciBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9jb3Ntb3MucGFwZXJvLm1lL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVTdXBlciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIucGFyc2UtaW50LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLmNvbnN0cnVjdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLnBhcnNlLWZsb2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMubnVtYmVyLnRvLWZpeGVkLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnZhbHVlcy5qcyI7CmltcG9ydCAqIGFzIFBoYXNlciBmcm9tICJwaGFzZXIiOwppbXBvcnQgd2Vic29ja2V0RXZlbnRzIGZyb20gIi4uL2NvbnN0YW50cy93ZWJzb2NrZXRFdmVudHMiOwppbXBvcnQgeyBnYW1lRGltZW5zaW9ucywgbm9ybWFsaXplcnMsIHNjZW5lS2V5cyB9IGZyb20gIi4uL2NvbnN0YW50cy9nYW1lU2V0dGluZ3MiOwppbXBvcnQgeyBkZXRlY3RUb3VjaFNjcmVlbiB9IGZyb20gIi4uL2NvbnN0YW50cy9jb25zdGFudHMiOwoKdmFyIEdhbWVTY2VuZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1BoYXNlciRTY2VuZSkgewogIF9pbmhlcml0cyhHYW1lU2NlbmUsIF9QaGFzZXIkU2NlbmUpOwoKICB2YXIgX3N1cGVyID0gX2NyZWF0ZVN1cGVyKEdhbWVTY2VuZSk7CgogIGZ1bmN0aW9uIEdhbWVTY2VuZShzb2NrZXQsIGdhbWUpIHsKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgR2FtZVNjZW5lKTsKCiAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHsKICAgICAga2V5OiBzY2VuZUtleXMuZ2FtZQogICAgfSk7CiAgICBfdGhpcy5zb2NrZXQgPSBzb2NrZXQ7CiAgICBfdGhpcy5zZXR0aW5ncyA9IGdhbWUuc2V0dGluZ3M7CiAgICBfdGhpcy5jdXJyZW50UGxheWVyID0gZ2FtZS5jdXJyZW50UGxheWVyOwogICAgX3RoaXMuc2V0dGluZ3MubWF4VmVsb2NpdHlMaXR0bGUgPSBnYW1lLnNldHRpbmdzLnZlbG9jaXR5ICsgMC41OwogICAgX3RoaXMuc2V0dGluZ3MuYWNjZWxlcmF0aW9uTGl0dGxlID0gMC41OwogICAgX3RoaXMuc2V0dGluZ3MucmVzcGF3blRpbWUgPSA1MDAwOwogICAgX3RoaXMuc2V0dGluZ3MuZnJpY3Rpb25BaXIgPSAwLjE7CiAgICBfdGhpcy5wbGF5ZXJzID0ge307CiAgICBnYW1lLnBsYXllcnMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7CiAgICAgIF90aGlzLnBsYXllcnNbcGxheWVyLmxvY2FsSWRdID0gcGxheWVyOwogICAgICBfdGhpcy5wbGF5ZXJzW3BsYXllci5sb2NhbElkXS5hdmFpbGFibGVCdWxsZXRzID0gMzsKICAgICAgX3RoaXMucGxheWVyc1twbGF5ZXIubG9jYWxJZF0uc3RhdGUgPSAyOwogICAgICBfdGhpcy5wbGF5ZXJzW3BsYXllci5sb2NhbElkXS5sYXN0VGltZXN0YW1wID0gMDsKICAgIH0pOwogICAgX3RoaXMudXBkYXRlRnBzID0gMTU7CiAgICBfdGhpcy50b3VjaFNjcmVlbiA9IGRldGVjdFRvdWNoU2NyZWVuKCk7CiAgICBfdGhpcy5yZWxvYWRJbnRlcnZhbCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKF90aGlzLnBsYXllcnNbX3RoaXMuY3VycmVudFBsYXllcl0uYXZhaWxhYmxlQnVsbGV0cyA+PSAzKSByZXR1cm47CiAgICAgIHZhciBhdmFpbGFibGVCdWxsZXRzID0gX3RoaXMucGxheWVyc1tfdGhpcy5jdXJyZW50UGxheWVyXS5hdmFpbGFibGVCdWxsZXRzICsgMTsKICAgICAgdmFyIGRhdGEgPSB7CiAgICAgICAgbG9jYWxJZDogX3RoaXMuY3VycmVudFBsYXllciwKICAgICAgICBhdmFpbGFibGVCdWxsZXRzOiBhdmFpbGFibGVCdWxsZXRzCiAgICAgIH07CgogICAgICBfdGhpcy5zb2NrZXQuZW1pdCh3ZWJzb2NrZXRFdmVudHMuUkVMT0FELCBkYXRhKTsKCiAgICAgIF90aGlzLnJlbG9hZChkYXRhKTsKICAgIH0sIDEgLyAoX3RoaXMuc2V0dGluZ3MucmVsb2FkaW5nVmVsb2NpdHkgKiBub3JtYWxpemVycy5yZWxvYWRpbmdWZWxvY2l0eSkpOwogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEdhbWVTY2VuZSwgW3sKICAgIGtleTogInByZWxvYWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHByZWxvYWQoKSB7CiAgICAgIHRoaXMubG9hZC5pbWFnZSgic2hpcDAiLCAiLi9zaGlwcy9zaGlwMC5wbmciKTsKICAgICAgdGhpcy5sb2FkLmltYWdlKCJzaGlwMSIsICIuL3NoaXBzL3NoaXAxLnBuZyIpOwogICAgICB0aGlzLmxvYWQuaW1hZ2UoInNoaXAyIiwgIi4vc2hpcHMvc2hpcDIucG5nIik7CiAgICAgIHRoaXMubG9hZC5pbWFnZSgic2hpcDMiLCAiLi9zaGlwcy9zaGlwMy5wbmciKTsKICAgICAgdGhpcy5sb2FkLmltYWdlKCJsaXR0bGUwIiwgIi4vbGl0dGxlLnBuZyIpOwogICAgICB0aGlzLmxvYWQuaW1hZ2UoImxpdHRsZTEiLCAiLi9saXR0bGUucG5nIik7CiAgICAgIHRoaXMubG9hZC5pbWFnZSgibGl0dGxlMiIsICIuL2xpdHRsZS5wbmciKTsKICAgICAgdGhpcy5sb2FkLmltYWdlKCJsaXR0bGUzIiwgIi4vbGl0dGxlLnBuZyIpOwogICAgICB0aGlzLmxvYWQuaW1hZ2UoImJ1bGxldCIsICIuL2J1bGxldC5wbmciKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjcmVhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZSgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB0aGlzLmNyZWF0ZUdyb3VwcygpOwogICAgICB0aGlzLmNyZWF0ZVNoaXBzKCk7CiAgICAgIHRoaXMuc29ja2V0Lm9uKHdlYnNvY2tldEV2ZW50cy5VUERBVEVfU0hJUCwgZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMyLnVwZGF0ZVNoaXAoZGF0YSk7CiAgICAgIH0pOwogICAgICB0aGlzLnNvY2tldC5vbih3ZWJzb2NrZXRFdmVudHMuU0hPT1QsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMi5jcmVhdGVCdWxsZXQoZGF0YSk7CiAgICAgIH0pOwogICAgICB0aGlzLnNvY2tldC5vbih3ZWJzb2NrZXRFdmVudHMuQ0hBTkdFX1NUQVRFLCBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczIudXBkYXRlU3RhdGUoZGF0YSk7CiAgICAgIH0pOwogICAgICB0aGlzLnNvY2tldC5vbih3ZWJzb2NrZXRFdmVudHMuUkVMT0FELCBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczIucmVsb2FkKGRhdGEpOwogICAgICB9KTsKICAgICAgdGhpcy5yb3RhdGlvbktleSA9IHRoaXMuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KFBoYXNlci5JbnB1dC5LZXlib2FyZC5LZXlDb2Rlcy5TUEFDRSk7CiAgICAgIHRoaXMuYWNjZWxlcmF0ZUxpdHRsZUtleSA9IHRoaXMuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KFBoYXNlci5JbnB1dC5LZXlib2FyZC5LZXlDb2Rlcy5FTlRFUik7CiAgICAgIHRoaXMuaW5wdXQua2V5Ym9hcmQub24oImtleWRvd24tRU5URVIiLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKF90aGlzMi5wbGF5ZXJzW190aGlzMi5jdXJyZW50UGxheWVyXS5zdGF0ZSA+PSAyKSBfdGhpczIuc2hvb3QoKTsKICAgICAgfSk7CiAgICAgIHRoaXMucGh5c2ljcy53b3JsZC5vbigid29ybGRib3VuZHMiLCBmdW5jdGlvbiAoYnVsbGV0KSB7CiAgICAgICAgYnVsbGV0LmdhbWVPYmplY3QuZGVzdHJveSgpOwogICAgICB9KTsKCiAgICAgIGlmICh0aGlzLnRvdWNoU2NyZWVuKSB7CiAgICAgICAgdGhpcy5pbnB1dC5hZGRQb2ludGVyKDEpOwogICAgICAgIHRoaXMuaW5wdXQub24oInBvaW50ZXJ1cCIsIGZ1bmN0aW9uIChwb2ludGVyKSB7CiAgICAgICAgICBpZiAocG9pbnRlci54IDwgZ2FtZURpbWVuc2lvbnMud2lkdGggLyAyKSB7CiAgICAgICAgICAgIF90aGlzMi5yb3RhdGluZyA9IGZhbHNlOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgX3RoaXMyLmFjY2VsZXJhdGluZyA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHRoaXMuaW5wdXQub24oInBvaW50ZXJkb3duIiwgZnVuY3Rpb24gKHBvaW50ZXIpIHsKICAgICAgICAgIGlmIChwb2ludGVyLnggPCBnYW1lRGltZW5zaW9ucy53aWR0aCAvIDIpIHsKICAgICAgICAgICAgX3RoaXMyLnJvdGF0aW5nID0gdHJ1ZTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmIChfdGhpczIucGxheWVyc1tfdGhpczIuY3VycmVudFBsYXllcl0uc3RhdGUgPj0gMikgewogICAgICAgICAgICAgIGlmIChfdGhpczIuYXZhaWxhYmxlQnVsbGV0cyA+IDApIF90aGlzMi5zaG9vdCgpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIF90aGlzMi5hY2NlbGVyYXRpbmcgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHRoaXMudXBkYXRlU2hpcEludGVydmFsID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzMi5zb2NrZXQuZW1pdCh3ZWJzb2NrZXRFdmVudHMuVVBEQVRFX1NISVAsIFtfdGhpczIuY3VycmVudFBsYXllciwgTnVtYmVyLnBhcnNlSW50KF90aGlzMi5wbGF5ZXJzW190aGlzMi5jdXJyZW50UGxheWVyXS5zaGlwLmFuZ2xlKSwgW051bWJlci5wYXJzZUZsb2F0KF90aGlzMi5wbGF5ZXJzW190aGlzMi5jdXJyZW50UGxheWVyXS5zaGlwLngudG9GaXhlZCgyKSksIE51bWJlci5wYXJzZUZsb2F0KF90aGlzMi5wbGF5ZXJzW190aGlzMi5jdXJyZW50UGxheWVyXS5zaGlwLnkudG9GaXhlZCgyKSldLCBfdGhpczIudGltZS5ub3ddKTsKICAgICAgfSwgMTAwMCAvIHRoaXMudXBkYXRlRnBzKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ1cGRhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZSh0aW1lLCBkZWx0YSkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIGlmICh0aGlzLnJvdGF0aW9uS2V5LmlzRG93biB8fCB0aGlzLnJvdGF0aW5nKSB0aGlzLnJvdGF0ZShkZWx0YSk7CiAgICAgIGlmICh0aGlzLmFjY2VsZXJhdGVMaXR0bGVLZXkuaXNEb3duIHx8IHRoaXMuYWNjZWxlcmF0aW5nKSB0aGlzLm1vdmVMaXR0bGUoZGVsdGEpOwoKICAgICAgdmFyIF90aGlzJHBoeXNpY3MkdmVsb2NpdCA9IHRoaXMucGh5c2ljcy52ZWxvY2l0eUZyb21BbmdsZSh0aGlzLnBsYXllcnNbdGhpcy5jdXJyZW50UGxheWVyXS5zaGlwLmFuZ2xlLCB0aGlzLnBsYXllcnNbdGhpcy5jdXJyZW50UGxheWVyXS5zaGlwLnZlbG9jaXR5TWFnbml0dWRlKSwKICAgICAgICAgIHggPSBfdGhpcyRwaHlzaWNzJHZlbG9jaXQueCwKICAgICAgICAgIHkgPSBfdGhpcyRwaHlzaWNzJHZlbG9jaXQueTsKCiAgICAgIHRoaXMucGxheWVyc1t0aGlzLmN1cnJlbnRQbGF5ZXJdLnNoaXAuc2V0VmVsb2NpdHkoeCwgeSk7CgogICAgICBpZiAodGhpcy5wbGF5ZXJzW3RoaXMuY3VycmVudFBsYXllcl0uc3RhdGUgPT09IDEpIHsKICAgICAgICB0aGlzLnBsYXllcnNbdGhpcy5jdXJyZW50UGxheWVyXS5zaGlwLnZlbG9jaXR5TWFnbml0dWRlID0gTWF0aC5tYXgoMCwgdGhpcy5wbGF5ZXJzW3RoaXMuY3VycmVudFBsYXllcl0uc2hpcC52ZWxvY2l0eU1hZ25pdHVkZSAtIHRoaXMuc2V0dGluZ3MuZnJpY3Rpb25BaXIgKiBkZWx0YSk7CiAgICAgIH0KCiAgICAgIE9iamVjdC52YWx1ZXModGhpcy5wbGF5ZXJzKS5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHsKICAgICAgICBpZiAocGxheWVyLmxvY2FsSWQgIT09IF90aGlzMy5jdXJyZW50UGxheWVyKSB7CiAgICAgICAgICBwbGF5ZXIuc2hpcC5hdXRvbm9teVRpbWUgLT0gZGVsdGE7CgogICAgICAgICAgaWYgKHBsYXllci5zaGlwLmF1dG9ub215VGltZSA8IDApIHsKICAgICAgICAgICAgcGxheWVyLnNoaXAuc2V0VmVsb2NpdHkoMCk7CiAgICAgICAgICAgIHBsYXllci5zaGlwLnNldEFuZ3VsYXJWZWxvY2l0eSgwKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOyAvL2lmKHRoaXMuc2hpcHMuY291bnRBY3RpdmUoKSA8PSAxKSBjb25zb2xlLmxvZygiZ2FtZSBvdmVyIikgLy9UT0RPOiBTRVRVUCBFTkQgT0YgVEhFIFRVUk4KICAgIH0gLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgLy9DcmVhdGluZyB0aGluZ3MKCiAgfSwgewogICAga2V5OiAiY3JlYXRlR3JvdXBzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVHcm91cHMoKSB7CiAgICAgIHRoaXMuc2hpcHMgPSB0aGlzLnBoeXNpY3MuYWRkLmdyb3VwKCk7CiAgICAgIHRoaXMuYnVsbGV0cyA9IHRoaXMucGh5c2ljcy5hZGQuZ3JvdXAoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjcmVhdGVTaGlwcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlU2hpcHMoKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgdmFyIGluZGV4ID0gMDsKICAgICAgT2JqZWN0LnZhbHVlcyh0aGlzLnBsYXllcnMpLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikgewogICAgICAgIHBsYXllci5zaGlwID0gX3RoaXM0LnNoaXBzLmNyZWF0ZSgoaW5kZXggPCAyID8gMC4wNSA6IDAuOTUpICogZ2FtZURpbWVuc2lvbnMud2lkdGgsIChpbmRleCAlIDIgPT09IDAgPyAwLjA1IDogMC45NSkgKiBnYW1lRGltZW5zaW9ucy5oZWlnaHQsICJzaGlwIiArIHBsYXllci5jb2xvcik7CiAgICAgICAgcGxheWVyLnNoaXAubG9jYWxJZCA9IHBsYXllci5sb2NhbElkOwogICAgICAgIHBsYXllci5zaGlwLnNldEFuZ2xlKC00NSAqIChpbmRleCA8IDIgPyAxIDogMykgKiAoaW5kZXggJSAyICogMiAtIDEpKTsKICAgICAgICBwbGF5ZXIuc2hpcC52ZWxvY2l0eU1hZ25pdHVkZSA9IF90aGlzNC5zZXR0aW5ncy52ZWxvY2l0eSAqIG5vcm1hbGl6ZXJzLnZlbG9jaXR5OwogICAgICAgIHBsYXllci5zaGlwLmF1dG9ub215VGltZSA9IDA7CgogICAgICAgIGlmIChwbGF5ZXIubG9jYWxJZCA9PT0gX3RoaXM0LmN1cnJlbnRQbGF5ZXIpIHsKICAgICAgICAgIHBsYXllci5zaGlwLnNldENvbGxpZGVXb3JsZEJvdW5kcyh0cnVlKTsKCiAgICAgICAgICBfdGhpczQucGh5c2ljcy5hZGQub3ZlcmxhcChwbGF5ZXIuc2hpcCwgX3RoaXM0LmJ1bGxldHMsIGZ1bmN0aW9uIChzaGlwLCBidWxsZXQpIHsKICAgICAgICAgICAgX3RoaXM0Lm9uQnVsbGV0Q29sbGlzaW9uKHNoaXAsIGJ1bGxldCk7CiAgICAgICAgICB9KTsKCiAgICAgICAgICBfdGhpczQucGh5c2ljcy5hZGQuY29sbGlkZXIocGxheWVyLnNoaXAsIF90aGlzNC5zaGlwcywgZnVuY3Rpb24gKGN1cnJlbnRTaGlwLCBzaGlwKSB7CiAgICAgICAgICAgIGlmIChfdGhpczQucGxheWVyc1tfdGhpczQuY3VycmVudFBsYXllcl0uc3RhdGUgPT09IDEgJiYgX3RoaXM0LnBsYXllcnNbc2hpcC5sb2NhbElkXS5zdGF0ZSA+PSAyKSB7CiAgICAgICAgICAgICAgX3RoaXM0LmtpbGxlZEJ5ID0gc2hpcC5sb2NhbElkOwogICAgICAgICAgICAgIHZhciBkYXRhID0gewogICAgICAgICAgICAgICAgbG9jYWxJZDogX3RoaXM0LmN1cnJlbnRQbGF5ZXIsCiAgICAgICAgICAgICAgICBzdGF0ZTogMAogICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgIF90aGlzNC5zb2NrZXQuZW1pdCh3ZWJzb2NrZXRFdmVudHMuQ0hBTkdFX1NUQVRFLCBkYXRhKTsKCiAgICAgICAgICAgICAgX3RoaXM0LnVwZGF0ZVN0YXRlKGRhdGEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGluZGV4Kys7CiAgICAgIH0pOwogICAgICB0aGlzLnBoeXNpY3MuYWRkLmNvbGxpZGVyKHRoaXMuc2hpcHMsIHRoaXMuc2hpcHMpOwogICAgfQogIH0sIHsKICAgIGtleTogImNyZWF0ZUJ1bGxldCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlQnVsbGV0KGRhdGEpIHsKICAgICAgdmFyIF90aGlzJHBoeXNpY3MkdmVsb2NpdDIgPSB0aGlzLnBoeXNpY3MudmVsb2NpdHlGcm9tQW5nbGUoZGF0YS5hbmdsZSwgdGhpcy5zZXR0aW5ncy5idWxsZXRWZWxvY2l0eSAqIG5vcm1hbGl6ZXJzLmJ1bGxldFZlbG9jaXR5KSwKICAgICAgICAgIHggPSBfdGhpcyRwaHlzaWNzJHZlbG9jaXQyLngsCiAgICAgICAgICB5ID0gX3RoaXMkcGh5c2ljcyR2ZWxvY2l0Mi55OwoKICAgICAgdmFyIGRlbHRhVGltZSA9IERhdGUubm93KCkgLSBkYXRhLnRpbWVzdGFtcDsKICAgICAgdmFyIGJ1bGxldCA9IHRoaXMuYnVsbGV0cy5jcmVhdGUoZGF0YS5wb3NpdGlvbi54ICsgZGVsdGFUaW1lICogeCAvIDEwMDAsIGRhdGEucG9zaXRpb24ueSArIGRlbHRhVGltZSAqIHkgLyAxMDAwLCAiYnVsbGV0Iik7CiAgICAgIGJ1bGxldC5hbmdsZSA9IGRhdGEuYW5nbGU7CiAgICAgIGJ1bGxldC5zZXRWZWxvY2l0eSh4LCB5KTsKICAgICAgYnVsbGV0LnNob3RCeSA9IGRhdGEubG9jYWxJZDsKICAgICAgYnVsbGV0LnNldENvbGxpZGVXb3JsZEJvdW5kcyh0cnVlKTsKICAgICAgYnVsbGV0LmJvZHkub25Xb3JsZEJvdW5kcyA9IHRydWU7CiAgICAgIHRoaXMucGxheWVyc1tkYXRhLmxvY2FsSWRdLmF2YWlsYWJsZUJ1bGxldHMtLTsKICAgIH0gLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgLy9PdGhlcnMgZG8gdGhpbmdzIHZpYSB0aGUgd2Vic29ja2V0CgogIH0sIHsKICAgIGtleTogInVwZGF0ZVNoaXAiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZVNoaXAoZGF0YSkgewogICAgICBjb25zb2xlLmxvZygic2hpcCB1cGRhdGVkIiwgZGF0YSk7CiAgICAgIHZhciBwbGF5ZXIgPSB0aGlzLnBsYXllcnNbZGF0YVswXV07CiAgICAgIHZhciBkZWx0YVRpbWUgPSAoZGF0YVszXSAtIHBsYXllci5sYXN0VGltZXN0YW1wKSAvIDEwMDA7CiAgICAgIGlmIChkZWx0YVRpbWUgPD0gMCkgcmV0dXJuOwogICAgICB2YXIgZGVsdGFUaGV0YSA9IGRhdGFbMV0gLSBOdW1iZXIucGFyc2VJbnQocGxheWVyLnNoaXAuYW5nbGUpOwogICAgICBpZiAoZGVsdGFUaGV0YSA8IC0xMCkgZGVsdGFUaGV0YSArPSAzNjA7ZWxzZSBpZiAoZGVsdGFUaGV0YSA8IDApIGRlbHRhVGhldGEgPSAwOwogICAgICB2YXIgYW5ndWxhclZlbG9jaXR5ID0gZGVsdGFUaGV0YSAvIGRlbHRhVGltZTsKICAgICAgcGxheWVyLnNoaXAuc2V0QW5ndWxhclZlbG9jaXR5KGFuZ3VsYXJWZWxvY2l0eSk7CiAgICAgIHBsYXllci5zaGlwLnNldFZlbG9jaXR5KChkYXRhWzJdWzBdIC0gcGxheWVyLnNoaXAueCkgLyBkZWx0YVRpbWUsIChkYXRhWzJdWzFdIC0gcGxheWVyLnNoaXAueSkgLyBkZWx0YVRpbWUpOwogICAgICBwbGF5ZXIubGFzdFRpbWVzdGFtcCA9IGRhdGFbM107CiAgICAgIHBsYXllci5zaGlwLmF1dG9ub215VGltZSA9IGRlbHRhVGltZSAqIDEwMDA7CiAgICB9IC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIC8vQ3VycmVudCBwbGF5ZXJzIGRvZXMgdGhpbmdzCgogIH0sIHsKICAgIGtleTogInJvdGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcm90YXRlKGRlbHRhKSB7CiAgICAgIHRoaXMucGxheWVyc1t0aGlzLmN1cnJlbnRQbGF5ZXJdLnNoaXAuYW5nbGUgKz0gZGVsdGEgKiB0aGlzLnNldHRpbmdzLmFuZ3VsYXJWZWxvY2l0eSAqIG5vcm1hbGl6ZXJzLmFuZ3VsYXJWZWxvY2l0eTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJtb3ZlTGl0dGxlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtb3ZlTGl0dGxlKGRlbHRhKSB7CiAgICAgIGlmICh0aGlzLnBsYXllcnNbdGhpcy5jdXJyZW50UGxheWVyXS5zdGF0ZSA9PT0gMSkgewogICAgICAgIHZhciBzaGlwID0gdGhpcy5wbGF5ZXJzW3RoaXMuY3VycmVudFBsYXllcl0uc2hpcDsKICAgICAgICB2YXIgcHJldmlvdXNNYWcgPSBzaGlwLnZlbG9jaXR5TWFnbml0dWRlOwoKICAgICAgICBpZiAocHJldmlvdXNNYWcgPCB0aGlzLnNldHRpbmdzLm1heFZlbG9jaXR5TGl0dGxlICogbm9ybWFsaXplcnMudmVsb2NpdHkpIHsKICAgICAgICAgIHRoaXMucGxheWVyc1t0aGlzLmN1cnJlbnRQbGF5ZXJdLnNoaXAudmVsb2NpdHlNYWduaXR1ZGUgKz0gZGVsdGEgKiB0aGlzLnNldHRpbmdzLmFjY2VsZXJhdGlvbkxpdHRsZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5wbGF5ZXJzW3RoaXMuY3VycmVudFBsYXllcl0uc2hpcC52ZWxvY2l0eU1hZ25pdHVkZSA9IHRoaXMuc2V0dGluZ3MubWF4VmVsb2NpdHlMaXR0bGUgKiBub3JtYWxpemVycy52ZWxvY2l0eTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJzaG9vdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2hvb3QoKSB7CiAgICAgIGlmICh0aGlzLnBsYXllcnNbdGhpcy5jdXJyZW50UGxheWVyXS5hdmFpbGFibGVCdWxsZXRzID4gMCkgewogICAgICAgIHZhciBzaGlwID0gdGhpcy5wbGF5ZXJzW3RoaXMuY3VycmVudFBsYXllcl0uc2hpcDsKICAgICAgICB2YXIgYW5nbGUgPSBzaGlwLmFuZ2xlOwogICAgICAgIHZhciBkYXRhID0gewogICAgICAgICAgcG9zaXRpb246IHsKICAgICAgICAgICAgeDogc2hpcC54ICsgc2hpcC53aWR0aCAqIE1hdGguY29zKGFuZ2xlICogTWF0aC5QSSAvIDE4MCksCiAgICAgICAgICAgIHk6IHNoaXAueSArIHNoaXAud2lkdGggKiBNYXRoLnNpbihhbmdsZSAqIE1hdGguUEkgLyAxODApCiAgICAgICAgICB9LAogICAgICAgICAgYW5nbGU6IGFuZ2xlLAogICAgICAgICAgbG9jYWxJZDogdGhpcy5jdXJyZW50UGxheWVyLAogICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpCiAgICAgICAgfTsKICAgICAgICB0aGlzLnNvY2tldC5lbWl0KHdlYnNvY2tldEV2ZW50cy5TSE9PVCwgZGF0YSk7CiAgICAgICAgdGhpcy5jcmVhdGVCdWxsZXQoZGF0YSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJ1cGRhdGVTdGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlU3RhdGUoZGF0YSkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIHRoaXMucGxheWVyc1tkYXRhLmxvY2FsSWRdLnN0YXRlID0gZGF0YS5zdGF0ZTsKICAgICAgdmFyIHNoaXAgPSB0aGlzLnBsYXllcnNbZGF0YS5sb2NhbElkXS5zaGlwOwoKICAgICAgc3dpdGNoIChkYXRhLnN0YXRlKSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgICAgdGhpcy5zaGlwcy5raWxsQW5kSGlkZShzaGlwKTsKICAgICAgICAgIHRoaXMuc2hpcHMucmVtb3ZlKHNoaXApOwogICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnJlbG9hZEludGVydmFsKTsKICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGhpcy51cGRhdGVTaGlwSW50ZXJ2YWwpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMToKICAgICAgICAgIHNoaXAuc2V0VGV4dHVyZSgibGl0dGxlIiArIHRoaXMucGxheWVyc1tkYXRhLmxvY2FsSWRdLmNvbG9yKTsKCiAgICAgICAgICBpZiAoZGF0YS5sb2NhbElkID09PSB0aGlzLmN1cnJlbnRQbGF5ZXIpIHsKICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgaWYgKF90aGlzNS5wbGF5ZXJzW2RhdGEubG9jYWxJZF0uc3RhdGUgPT09IDEpIHsKICAgICAgICAgICAgICAgIHZhciBfZGF0YSA9IHsKICAgICAgICAgICAgICAgICAgbG9jYWxJZDogX3RoaXM1LmN1cnJlbnRQbGF5ZXIsCiAgICAgICAgICAgICAgICAgIHN0YXRlOiAyCiAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgIF90aGlzNS51cGRhdGVTdGF0ZShfZGF0YSk7CgogICAgICAgICAgICAgICAgX3RoaXM1LnNvY2tldC5lbWl0KHdlYnNvY2tldEV2ZW50cy5DSEFOR0VfU1RBVEUsIF9kYXRhKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIHRoaXMuc2V0dGluZ3MucmVzcGF3blRpbWUpOwogICAgICAgICAgfQoKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDI6CiAgICAgICAgICBzaGlwLnZlbG9jaXR5TWFnbml0dWRlID0gdGhpcy5zZXR0aW5ncy52ZWxvY2l0eSAqIG5vcm1hbGl6ZXJzLnZlbG9jaXR5OwogICAgICAgICAgc2hpcC5zZXRUZXh0dXJlKCJzaGlwIiArIHRoaXMucGxheWVyc1tkYXRhLmxvY2FsSWRdLmNvbG9yKTsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAib25CdWxsZXRDb2xsaXNpb24iLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uQnVsbGV0Q29sbGlzaW9uKHNoaXAsIGJ1bGxldCkgewogICAgICBidWxsZXQuZGVzdHJveSgpOwogICAgICB2YXIgc3RhdGUgPSB0aGlzLnBsYXllcnNbc2hpcC5sb2NhbElkXS5zdGF0ZSAtIDE7CiAgICAgIGlmIChzdGF0ZSA9PT0gMCkgdGhpcy5raWxsZWRCeSA9IGJ1bGxldC5zaG90Qnk7CiAgICAgIHZhciBkYXRhID0gewogICAgICAgIGxvY2FsSWQ6IHNoaXAubG9jYWxJZCwKICAgICAgICBzdGF0ZTogc3RhdGUKICAgICAgfTsKICAgICAgdGhpcy5zb2NrZXQuZW1pdCh3ZWJzb2NrZXRFdmVudHMuQ0hBTkdFX1NUQVRFLCBkYXRhKTsKICAgICAgdGhpcy51cGRhdGVTdGF0ZShkYXRhKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZWxvYWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbG9hZChkYXRhKSB7CiAgICAgIHRoaXMucGxheWVyc1tkYXRhLmxvY2FsSWRdLmF2YWlsYWJsZUJ1bGxldHMgPSBkYXRhLmF2YWlsYWJsZUJ1bGxldHM7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gR2FtZVNjZW5lOwp9KFBoYXNlci5TY2VuZSk7CgpleHBvcnQgeyBHYW1lU2NlbmUgYXMgZGVmYXVsdCB9Ow=="},{"version":3,"sources":["/media/jacopo/VolumeDati/Documenti/papero.tk/cosmos.papero.me/src/phaser/GameScene.js"],"names":["Phaser","websocketEvents","gameDimensions","normalizers","sceneKeys","detectTouchScreen","GameScene","socket","game","key","settings","currentPlayer","maxVelocityLittle","velocity","accelerationLittle","respawnTime","frictionAir","players","forEach","player","localId","availableBullets","state","lastTimestamp","updateFps","touchScreen","reloadInterval","setInterval","data","emit","RELOAD","reload","reloadingVelocity","load","image","createGroups","createShips","on","UPDATE_SHIP","updateShip","SHOOT","createBullet","CHANGE_STATE","updateState","rotationKey","input","keyboard","addKey","Input","Keyboard","KeyCodes","SPACE","accelerateLittleKey","ENTER","shoot","physics","world","bullet","gameObject","destroy","addPointer","pointer","x","width","rotating","accelerating","updateShipInterval","Number","parseInt","ship","angle","parseFloat","toFixed","y","time","now","delta","isDown","rotate","moveLittle","velocityFromAngle","velocityMagnitude","setVelocity","Math","max","Object","values","autonomyTime","setAngularVelocity","ships","add","group","bullets","index","create","height","color","setAngle","setCollideWorldBounds","overlap","onBulletCollision","collider","currentShip","killedBy","bulletVelocity","deltaTime","Date","timestamp","position","shotBy","body","onWorldBounds","console","log","deltaTheta","angularVelocity","previousMag","cos","PI","sin","killAndHide","remove","clearInterval","setTexture","setTimeout","Scene"],"mappings":";;;;;;;;;;AAAA,OAAO,KAAKA,MAAZ,MAAwB,QAAxB;AACA,OAAOC,eAAP,MAA4B,8BAA5B;AACA,SAAQC,cAAR,EAAwBC,WAAxB,EAAqCC,SAArC,QAAqD,2BAArD;AACA,SAAQC,iBAAR,QAAgC,wBAAhC;;IAGqBC,S;;;;;AAEjB,qBAAYC,MAAZ,EAAoBC,IAApB,EAA0B;AAAA;;AAAA;;AACtB,8BAAM;AAACC,MAAAA,GAAG,EAAEL,SAAS,CAACI;AAAhB,KAAN;AAEA,UAAKD,MAAL,GAAcA,MAAd;AACA,UAAKG,QAAL,GAAgBF,IAAI,CAACE,QAArB;AACA,UAAKC,aAAL,GAAqBH,IAAI,CAACG,aAA1B;AACA,UAAKD,QAAL,CAAcE,iBAAd,GAAkCJ,IAAI,CAACE,QAAL,CAAcG,QAAd,GAAuB,GAAzD;AACA,UAAKH,QAAL,CAAcI,kBAAd,GAAmC,GAAnC;AACA,UAAKJ,QAAL,CAAcK,WAAd,GAA4B,IAA5B;AACA,UAAKL,QAAL,CAAcM,WAAd,GAA4B,GAA5B;AACA,UAAKC,OAAL,GAAe,EAAf;AACAT,IAAAA,IAAI,CAACS,OAAL,CAAaC,OAAb,CAAqB,UAAAC,MAAM,EAAI;AAC3B,YAAKF,OAAL,CAAaE,MAAM,CAACC,OAApB,IAA+BD,MAA/B;AACA,YAAKF,OAAL,CAAaE,MAAM,CAACC,OAApB,EAA6BC,gBAA7B,GAAgD,CAAhD;AACA,YAAKJ,OAAL,CAAaE,MAAM,CAACC,OAApB,EAA6BE,KAA7B,GAAqC,CAArC;AACA,YAAKL,OAAL,CAAaE,MAAM,CAACC,OAApB,EAA6BG,aAA7B,GAA6C,CAA7C;AACH,KALD;AAOA,UAAKC,SAAL,GAAiB,EAAjB;AACA,UAAKC,WAAL,GAAmBpB,iBAAiB,EAApC;AAEA,UAAKqB,cAAL,GAAsBC,WAAW,CAAC,YAAM;AACpC,UAAG,MAAKV,OAAL,CAAa,MAAKN,aAAlB,EAAiCU,gBAAjC,IAAmD,CAAtD,EAAyD;AACzD,UAAMA,gBAAgB,GAAG,MAAKJ,OAAL,CAAa,MAAKN,aAAlB,EAAiCU,gBAAjC,GAAoD,CAA7E;AACA,UAAMO,IAAI,GAAG;AACTR,QAAAA,OAAO,EAAE,MAAKT,aADL;AAETU,QAAAA,gBAAgB,EAAhBA;AAFS,OAAb;;AAIA,YAAKd,MAAL,CAAYsB,IAAZ,CAAiB5B,eAAe,CAAC6B,MAAjC,EAAyCF,IAAzC;;AACA,YAAKG,MAAL,CAAYH,IAAZ;AACH,KATgC,EAS9B,KAAG,MAAKlB,QAAL,CAAcsB,iBAAd,GAAkC7B,WAAW,CAAC6B,iBAAjD,CAT8B,CAAjC;AArBsB;AA+BzB;;;;WAED,mBAAS;AAEL,WAAKC,IAAL,CAAUC,KAAV,CAAgB,OAAhB,EAAyB,mBAAzB;AACA,WAAKD,IAAL,CAAUC,KAAV,CAAgB,OAAhB,EAAyB,mBAAzB;AACA,WAAKD,IAAL,CAAUC,KAAV,CAAgB,OAAhB,EAAyB,mBAAzB;AACA,WAAKD,IAAL,CAAUC,KAAV,CAAgB,OAAhB,EAAyB,mBAAzB;AACA,WAAKD,IAAL,CAAUC,KAAV,CAAgB,SAAhB,EAA2B,cAA3B;AACA,WAAKD,IAAL,CAAUC,KAAV,CAAgB,SAAhB,EAA2B,cAA3B;AACA,WAAKD,IAAL,CAAUC,KAAV,CAAgB,SAAhB,EAA2B,cAA3B;AACA,WAAKD,IAAL,CAAUC,KAAV,CAAgB,SAAhB,EAA2B,cAA3B;AACA,WAAKD,IAAL,CAAUC,KAAV,CAAgB,QAAhB,EAA0B,cAA1B;AAEH;;;WAED,kBAAQ;AAAA;;AACJ,WAAKC,YAAL;AACA,WAAKC,WAAL;AAEA,WAAK7B,MAAL,CAAY8B,EAAZ,CAAepC,eAAe,CAACqC,WAA/B,EAA4C,UAAAV,IAAI;AAAA,eAAI,MAAI,CAACW,UAAL,CAAgBX,IAAhB,CAAJ;AAAA,OAAhD;AACA,WAAKrB,MAAL,CAAY8B,EAAZ,CAAepC,eAAe,CAACuC,KAA/B,EAAsC,UAAAZ,IAAI;AAAA,eAAI,MAAI,CAACa,YAAL,CAAkBb,IAAlB,CAAJ;AAAA,OAA1C;AACA,WAAKrB,MAAL,CAAY8B,EAAZ,CAAepC,eAAe,CAACyC,YAA/B,EAA6C,UAAAd,IAAI;AAAA,eAAI,MAAI,CAACe,WAAL,CAAiBf,IAAjB,CAAJ;AAAA,OAAjD;AACA,WAAKrB,MAAL,CAAY8B,EAAZ,CAAepC,eAAe,CAAC6B,MAA/B,EAAuC,UAAAF,IAAI;AAAA,eAAI,MAAI,CAACG,MAAL,CAAYH,IAAZ,CAAJ;AAAA,OAA3C;AAEA,WAAKgB,WAAL,GAAmB,KAAKC,KAAL,CAAWC,QAAX,CAAoBC,MAApB,CAA2B/C,MAAM,CAACgD,KAAP,CAAaC,QAAb,CAAsBC,QAAtB,CAA+BC,KAA1D,CAAnB;AACA,WAAKC,mBAAL,GAA2B,KAAKP,KAAL,CAAWC,QAAX,CAAoBC,MAApB,CAA2B/C,MAAM,CAACgD,KAAP,CAAaC,QAAb,CAAsBC,QAAtB,CAA+BG,KAA1D,CAA3B;AACA,WAAKR,KAAL,CAAWC,QAAX,CAAoBT,EAApB,CAAuB,eAAvB,EAAwC,YAAI;AACxC,YAAG,MAAI,CAACpB,OAAL,CAAa,MAAI,CAACN,aAAlB,EAAiCW,KAAjC,IAAwC,CAA3C,EAA8C,MAAI,CAACgC,KAAL;AACjD,OAFD;AAGA,WAAKC,OAAL,CAAaC,KAAb,CAAmBnB,EAAnB,CAAsB,aAAtB,EAAqC,UAACoB,MAAD,EAAU;AAACA,QAAAA,MAAM,CAACC,UAAP,CAAkBC,OAAlB;AAA4B,OAA5E;;AAEA,UAAG,KAAKlC,WAAR,EAAoB;AAChB,aAAKoB,KAAL,CAAWe,UAAX,CAAsB,CAAtB;AACA,aAAKf,KAAL,CAAWR,EAAX,CAAc,WAAd,EAA2B,UAACwB,OAAD,EAAa;AACpC,cAAGA,OAAO,CAACC,CAAR,GAAU5D,cAAc,CAAC6D,KAAf,GAAqB,CAAlC,EAAoC;AAChC,YAAA,MAAI,CAACC,QAAL,GAAgB,KAAhB;AACH,WAFD,MAEO;AACH,YAAA,MAAI,CAACC,YAAL,GAAoB,KAApB;AACH;AACJ,SAND;AAOA,aAAKpB,KAAL,CAAWR,EAAX,CAAc,aAAd,EAA6B,UAACwB,OAAD,EAAa;AACtC,cAAGA,OAAO,CAACC,CAAR,GAAU5D,cAAc,CAAC6D,KAAf,GAAqB,CAAlC,EAAoC;AAChC,YAAA,MAAI,CAACC,QAAL,GAAgB,IAAhB;AACH,WAFD,MAEO;AACH,gBAAG,MAAI,CAAC/C,OAAL,CAAa,MAAI,CAACN,aAAlB,EAAiCW,KAAjC,IAA0C,CAA7C,EAA+C;AAC3C,kBAAG,MAAI,CAACD,gBAAL,GAAsB,CAAzB,EAA4B,MAAI,CAACiC,KAAL;AAC/B,aAFD,MAEO;AACH,cAAA,MAAI,CAACW,YAAL,GAAoB,IAApB;AACH;AACJ;AACJ,SAVD;AAWH;;AAGD,WAAKC,kBAAL,GAA0BvC,WAAW,CAAC,YAAI;AACtC,QAAA,MAAI,CAACpB,MAAL,CAAYsB,IAAZ,CAAiB5B,eAAe,CAACqC,WAAjC,EAA8C,CAC1C,MAAI,CAAC3B,aADqC,EAE1CwD,MAAM,CAACC,QAAP,CAAgB,MAAI,CAACnD,OAAL,CAAa,MAAI,CAACN,aAAlB,EAAiC0D,IAAjC,CAAsCC,KAAtD,CAF0C,EAG1C,CACIH,MAAM,CAACI,UAAP,CAAkB,MAAI,CAACtD,OAAL,CAAa,MAAI,CAACN,aAAlB,EAAiC0D,IAAjC,CAAsCP,CAAtC,CAAwCU,OAAxC,CAAgD,CAAhD,CAAlB,CADJ,EAEIL,MAAM,CAACI,UAAP,CAAkB,MAAI,CAACtD,OAAL,CAAa,MAAI,CAACN,aAAlB,EAAiC0D,IAAjC,CAAsCI,CAAtC,CAAwCD,OAAxC,CAAgD,CAAhD,CAAlB,CAFJ,CAH0C,EAO1C,MAAI,CAACE,IAAL,CAAUC,GAPgC,CAA9C;AASH,OAVoC,EAUlC,OAAK,KAAKnD,SAVwB,CAArC;AAWH;;;WAED,gBAAOkD,IAAP,EAAaE,KAAb,EAAmB;AAAA;;AACf,UAAG,KAAKhC,WAAL,CAAiBiC,MAAjB,IAA2B,KAAKb,QAAnC,EAA6C,KAAKc,MAAL,CAAYF,KAAZ;AAC7C,UAAG,KAAKxB,mBAAL,CAAyByB,MAAzB,IAAmC,KAAKZ,YAA3C,EAAyD,KAAKc,UAAL,CAAgBH,KAAhB;;AAF1C,kCAGA,KAAKrB,OAAL,CAAayB,iBAAb,CACX,KAAK/D,OAAL,CAAa,KAAKN,aAAlB,EAAiC0D,IAAjC,CAAsCC,KAD3B,EAEX,KAAKrD,OAAL,CAAa,KAAKN,aAAlB,EAAiC0D,IAAjC,CAAsCY,iBAF3B,CAHA;AAAA,UAGRnB,CAHQ,yBAGRA,CAHQ;AAAA,UAGLW,CAHK,yBAGLA,CAHK;;AAOf,WAAKxD,OAAL,CAAa,KAAKN,aAAlB,EAAiC0D,IAAjC,CAAsCa,WAAtC,CAAkDpB,CAAlD,EAAqDW,CAArD;;AACA,UAAI,KAAKxD,OAAL,CAAa,KAAKN,aAAlB,EAAiCW,KAAjC,KAA2C,CAA/C,EAAkD;AAC9C,aAAKL,OAAL,CAAa,KAAKN,aAAlB,EAAiC0D,IAAjC,CAAsCY,iBAAtC,GAA0DE,IAAI,CAACC,GAAL,CACtD,CADsD,EACnD,KAAKnE,OAAL,CAAa,KAAKN,aAAlB,EAAiC0D,IAAjC,CAAsCY,iBAAtC,GAA0D,KAAKvE,QAAL,CAAcM,WAAd,GAA4B4D,KADnC,CAA1D;AAGH;;AACDS,MAAAA,MAAM,CAACC,MAAP,CAAc,KAAKrE,OAAnB,EAA4BC,OAA5B,CAAoC,UAAAC,MAAM,EAAI;AAC3C,YAAGA,MAAM,CAACC,OAAP,KAAiB,MAAI,CAACT,aAAzB,EAAuC;AACnCQ,UAAAA,MAAM,CAACkD,IAAP,CAAYkB,YAAZ,IAA4BX,KAA5B;;AACA,cAAGzD,MAAM,CAACkD,IAAP,CAAYkB,YAAZ,GAAyB,CAA5B,EAA+B;AAC3BpE,YAAAA,MAAM,CAACkD,IAAP,CAAYa,WAAZ,CAAwB,CAAxB;AACA/D,YAAAA,MAAM,CAACkD,IAAP,CAAYmB,kBAAZ,CAA+B,CAA/B;AACH;AACJ;AACH,OARD,EAbe,CAsBf;AACH,K,CAKD;AACA;;;;WACA,wBAAc;AACV,WAAKC,KAAL,GAAa,KAAKlC,OAAL,CAAamC,GAAb,CAAiBC,KAAjB,EAAb;AACA,WAAKC,OAAL,GAAe,KAAKrC,OAAL,CAAamC,GAAb,CAAiBC,KAAjB,EAAf;AACH;;;WAED,uBAAa;AAAA;;AACT,UAAIE,KAAK,GAAG,CAAZ;AACAR,MAAAA,MAAM,CAACC,MAAP,CAAc,KAAKrE,OAAnB,EAA4BC,OAA5B,CAAoC,UAAAC,MAAM,EAAI;AAC1CA,QAAAA,MAAM,CAACkD,IAAP,GAAc,MAAI,CAACoB,KAAL,CAAWK,MAAX,CACV,CAACD,KAAK,GAAC,CAAN,GAAU,IAAV,GAAiB,IAAlB,IAA0B3F,cAAc,CAAC6D,KAD/B,EAEV,CAAE8B,KAAK,GAAC,CAAN,KAAY,CAAZ,GAAgB,IAAhB,GAAuB,IAAzB,IAAkC3F,cAAc,CAAC6F,MAFvC,EAGV,SAAO5E,MAAM,CAAC6E,KAHJ,CAAd;AAMA7E,QAAAA,MAAM,CAACkD,IAAP,CAAYjD,OAAZ,GAAsBD,MAAM,CAACC,OAA7B;AACAD,QAAAA,MAAM,CAACkD,IAAP,CAAY4B,QAAZ,CAAqB,CAAC,EAAD,IAASJ,KAAK,GAAG,CAAR,GAAY,CAAZ,GAAgB,CAAzB,KAAkCA,KAAK,GAAG,CAAV,GAAgB,CAAhB,GAAoB,CAApD,CAArB;AACA1E,QAAAA,MAAM,CAACkD,IAAP,CAAYY,iBAAZ,GAAgC,MAAI,CAACvE,QAAL,CAAcG,QAAd,GAAuBV,WAAW,CAACU,QAAnE;AACAM,QAAAA,MAAM,CAACkD,IAAP,CAAYkB,YAAZ,GAA2B,CAA3B;;AAEA,YAAGpE,MAAM,CAACC,OAAP,KAAiB,MAAI,CAACT,aAAzB,EAAuC;AACnCQ,UAAAA,MAAM,CAACkD,IAAP,CAAY6B,qBAAZ,CAAkC,IAAlC;;AACA,UAAA,MAAI,CAAC3C,OAAL,CAAamC,GAAb,CAAiBS,OAAjB,CAAyBhF,MAAM,CAACkD,IAAhC,EAAsC,MAAI,CAACuB,OAA3C,EAAoD,UAACvB,IAAD,EAAOZ,MAAP,EAAkB;AAClE,YAAA,MAAI,CAAC2C,iBAAL,CAAuB/B,IAAvB,EAA6BZ,MAA7B;AACH,WAFD;;AAGA,UAAA,MAAI,CAACF,OAAL,CAAamC,GAAb,CAAiBW,QAAjB,CAA0BlF,MAAM,CAACkD,IAAjC,EAAuC,MAAI,CAACoB,KAA5C,EAAmD,UAACa,WAAD,EAAcjC,IAAd,EAAqB;AACpE,gBAAG,MAAI,CAACpD,OAAL,CAAa,MAAI,CAACN,aAAlB,EAAiCW,KAAjC,KAA2C,CAA3C,IAAgD,MAAI,CAACL,OAAL,CAAaoD,IAAI,CAACjD,OAAlB,EAA2BE,KAA3B,IAAoC,CAAvF,EAAyF;AACrF,cAAA,MAAI,CAACiF,QAAL,GAAgBlC,IAAI,CAACjD,OAArB;AACA,kBAAMQ,IAAI,GAAG;AACTR,gBAAAA,OAAO,EAAE,MAAI,CAACT,aADL;AAETW,gBAAAA,KAAK,EAAE;AAFE,eAAb;;AAIA,cAAA,MAAI,CAACf,MAAL,CAAYsB,IAAZ,CAAiB5B,eAAe,CAACyC,YAAjC,EAA+Cd,IAA/C;;AACA,cAAA,MAAI,CAACe,WAAL,CAAiBf,IAAjB;AACH;AACJ,WAVD;AAWH;;AAEDiE,QAAAA,KAAK;AACR,OA/BD;AAiCA,WAAKtC,OAAL,CAAamC,GAAb,CAAiBW,QAAjB,CAA0B,KAAKZ,KAA/B,EAAsC,KAAKA,KAA3C;AACH;;;WAED,sBAAa7D,IAAb,EAAkB;AAAA,mCACC,KAAK2B,OAAL,CAAayB,iBAAb,CAA+BpD,IAAI,CAAC0C,KAApC,EAA2C,KAAK5D,QAAL,CAAc8F,cAAd,GAA6BrG,WAAW,CAACqG,cAApF,CADD;AAAA,UACP1C,CADO,0BACPA,CADO;AAAA,UACJW,CADI,0BACJA,CADI;;AAEd,UAAMgC,SAAS,GAAGC,IAAI,CAAC/B,GAAL,KAAW/C,IAAI,CAAC+E,SAAlC;AACA,UAAMlD,MAAM,GAAG,KAAKmC,OAAL,CAAaE,MAAb,CAAoBlE,IAAI,CAACgF,QAAL,CAAc9C,CAAd,GAAgB2C,SAAS,GAAC3C,CAAV,GAAY,IAAhD,EAAsDlC,IAAI,CAACgF,QAAL,CAAcnC,CAAd,GAAgBgC,SAAS,GAAChC,CAAV,GAAY,IAAlF,EAAwF,QAAxF,CAAf;AACAhB,MAAAA,MAAM,CAACa,KAAP,GAAe1C,IAAI,CAAC0C,KAApB;AACAb,MAAAA,MAAM,CAACyB,WAAP,CAAmBpB,CAAnB,EAAsBW,CAAtB;AACAhB,MAAAA,MAAM,CAACoD,MAAP,GAAgBjF,IAAI,CAACR,OAArB;AACAqC,MAAAA,MAAM,CAACyC,qBAAP,CAA6B,IAA7B;AACAzC,MAAAA,MAAM,CAACqD,IAAP,CAAYC,aAAZ,GAA4B,IAA5B;AACA,WAAK9F,OAAL,CAAaW,IAAI,CAACR,OAAlB,EAA2BC,gBAA3B;AACH,K,CAOD;AACA;;;;WACA,oBAAWO,IAAX,EAAgB;AACZoF,MAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAA4BrF,IAA5B;AACA,UAAMT,MAAM,GAAG,KAAKF,OAAL,CAAaW,IAAI,CAAC,CAAD,CAAjB,CAAf;AACA,UAAM6E,SAAS,GAAG,CAAC7E,IAAI,CAAC,CAAD,CAAJ,GAAQT,MAAM,CAACI,aAAhB,IAA+B,IAAjD;AACA,UAAGkF,SAAS,IAAE,CAAd,EAAiB;AAEjB,UAAIS,UAAU,GAAGtF,IAAI,CAAC,CAAD,CAAJ,GAAUuC,MAAM,CAACC,QAAP,CAAgBjD,MAAM,CAACkD,IAAP,CAAYC,KAA5B,CAA3B;AAEA,UAAG4C,UAAU,GAAG,CAAC,EAAjB,EAAqBA,UAAU,IAAI,GAAd,CAArB,KACK,IAAGA,UAAU,GAAG,CAAhB,EAAmBA,UAAU,GAAG,CAAb;AACxB,UAAMC,eAAe,GAAGD,UAAU,GAAGT,SAArC;AACAtF,MAAAA,MAAM,CAACkD,IAAP,CAAYmB,kBAAZ,CAA+B2B,eAA/B;AAEAhG,MAAAA,MAAM,CAACkD,IAAP,CAAYa,WAAZ,CAAyB,CAAEtD,IAAI,CAAC,CAAD,CAAJ,CAAQ,CAAR,IAAWT,MAAM,CAACkD,IAAP,CAAYP,CAAzB,IAA+B2C,SAAxD,EAAmE,CAAE7E,IAAI,CAAC,CAAD,CAAJ,CAAQ,CAAR,IAAWT,MAAM,CAACkD,IAAP,CAAYI,CAAzB,IAA+BgC,SAAlG;AAEAtF,MAAAA,MAAM,CAACI,aAAP,GAAuBK,IAAI,CAAC,CAAD,CAA3B;AACAT,MAAAA,MAAM,CAACkD,IAAP,CAAYkB,YAAZ,GAA2BkB,SAAS,GAAC,IAArC;AACH,K,CAID;AACA;;;;WACA,gBAAO7B,KAAP,EAAa;AACT,WAAK3D,OAAL,CAAa,KAAKN,aAAlB,EAAiC0D,IAAjC,CAAsCC,KAAtC,IAA+CM,KAAK,GAAG,KAAKlE,QAAL,CAAcyG,eAAtB,GAAwChH,WAAW,CAACgH,eAAnG;AACH;;;WAED,oBAAWvC,KAAX,EAAiB;AACb,UAAG,KAAK3D,OAAL,CAAa,KAAKN,aAAlB,EAAiCW,KAAjC,KAA2C,CAA9C,EAAgD;AAC5C,YAAM+C,IAAI,GAAG,KAAKpD,OAAL,CAAa,KAAKN,aAAlB,EAAiC0D,IAA9C;AACA,YAAM+C,WAAW,GAAG/C,IAAI,CAACY,iBAAzB;;AACA,YAAGmC,WAAW,GAAG,KAAK1G,QAAL,CAAcE,iBAAd,GAAkCT,WAAW,CAACU,QAA/D,EAAwE;AACpE,eAAKI,OAAL,CAAa,KAAKN,aAAlB,EAAiC0D,IAAjC,CAAsCY,iBAAtC,IAA2DL,KAAK,GAAC,KAAKlE,QAAL,CAAcI,kBAA/E;AACH,SAFD,MAEO;AACH,eAAKG,OAAL,CAAa,KAAKN,aAAlB,EAAiC0D,IAAjC,CAAsCY,iBAAtC,GAA0D,KAAKvE,QAAL,CAAcE,iBAAd,GAAkCT,WAAW,CAACU,QAAxG;AACH;AACJ;AACJ;;;WAED,iBAAO;AACH,UAAG,KAAKI,OAAL,CAAa,KAAKN,aAAlB,EAAiCU,gBAAjC,GAAkD,CAArD,EAAuD;AACnD,YAAMgD,IAAI,GAAG,KAAKpD,OAAL,CAAa,KAAKN,aAAlB,EAAiC0D,IAA9C;AACA,YAAMC,KAAK,GAAGD,IAAI,CAACC,KAAnB;AACA,YAAM1C,IAAI,GAAG;AACTgF,UAAAA,QAAQ,EAAE;AACN9C,YAAAA,CAAC,EAAEO,IAAI,CAACP,CAAL,GAASO,IAAI,CAACN,KAAL,GAAWoB,IAAI,CAACkC,GAAL,CAAS/C,KAAK,GAAGa,IAAI,CAACmC,EAAb,GAAkB,GAA3B,CADjB;AAEN7C,YAAAA,CAAC,EAAEJ,IAAI,CAACI,CAAL,GAASJ,IAAI,CAACN,KAAL,GAAWoB,IAAI,CAACoC,GAAL,CAASjD,KAAK,GAAGa,IAAI,CAACmC,EAAb,GAAkB,GAA3B;AAFjB,WADD;AAKThD,UAAAA,KAAK,EAAEA,KALE;AAMTlD,UAAAA,OAAO,EAAE,KAAKT,aANL;AAOTgG,UAAAA,SAAS,EAAED,IAAI,CAAC/B,GAAL;AAPF,SAAb;AASA,aAAKpE,MAAL,CAAYsB,IAAZ,CAAiB5B,eAAe,CAACuC,KAAjC,EAAwCZ,IAAxC;AACA,aAAKa,YAAL,CAAkBb,IAAlB;AACH;AACJ;;;WAGD,qBAAYA,IAAZ,EAAiB;AAAA;;AACb,WAAKX,OAAL,CAAaW,IAAI,CAACR,OAAlB,EAA2BE,KAA3B,GAAmCM,IAAI,CAACN,KAAxC;AACA,UAAM+C,IAAI,GAAG,KAAKpD,OAAL,CAAaW,IAAI,CAACR,OAAlB,EAA2BiD,IAAxC;;AACA,cAAQzC,IAAI,CAACN,KAAb;AACI,aAAK,CAAL;AACI,eAAKmE,KAAL,CAAW+B,WAAX,CAAuBnD,IAAvB;AACA,eAAKoB,KAAL,CAAWgC,MAAX,CAAkBpD,IAAlB;AACAqD,UAAAA,aAAa,CAAC,KAAKhG,cAAN,CAAb;AACAgG,UAAAA,aAAa,CAAC,KAAKxD,kBAAN,CAAb;AACA;;AACJ,aAAK,CAAL;AACIG,UAAAA,IAAI,CAACsD,UAAL,CAAgB,WAAW,KAAK1G,OAAL,CAAaW,IAAI,CAACR,OAAlB,EAA2B4E,KAAtD;;AACA,cAAGpE,IAAI,CAACR,OAAL,KAAiB,KAAKT,aAAzB,EAAwC;AACpCiH,YAAAA,UAAU,CAAC,YAAM;AACb,kBAAI,MAAI,CAAC3G,OAAL,CAAaW,IAAI,CAACR,OAAlB,EAA2BE,KAA3B,KAAqC,CAAzC,EAA4C;AACxC,oBAAMM,KAAI,GAAG;AACTR,kBAAAA,OAAO,EAAE,MAAI,CAACT,aADL;AAETW,kBAAAA,KAAK,EAAE;AAFE,iBAAb;;AAIA,gBAAA,MAAI,CAACqB,WAAL,CAAiBf,KAAjB;;AACA,gBAAA,MAAI,CAACrB,MAAL,CAAYsB,IAAZ,CAAiB5B,eAAe,CAACyC,YAAjC,EAA+Cd,KAA/C;AACH;AACJ,aATS,EASP,KAAKlB,QAAL,CAAcK,WATP,CAAV;AAUH;;AACD;;AACJ,aAAK,CAAL;AACIsD,UAAAA,IAAI,CAACY,iBAAL,GAAyB,KAAKvE,QAAL,CAAcG,QAAd,GAAyBV,WAAW,CAACU,QAA9D;AACAwD,UAAAA,IAAI,CAACsD,UAAL,CAAgB,SAAS,KAAK1G,OAAL,CAAaW,IAAI,CAACR,OAAlB,EAA2B4E,KAApD;AACA;AAzBR;AA2BH;;;WAED,2BAAkB3B,IAAlB,EAAwBZ,MAAxB,EAA+B;AAC3BA,MAAAA,MAAM,CAACE,OAAP;AACA,UAAMrC,KAAK,GAAG,KAAKL,OAAL,CAAaoD,IAAI,CAACjD,OAAlB,EAA2BE,KAA3B,GAAiC,CAA/C;AACA,UAAGA,KAAK,KAAK,CAAb,EAAgB,KAAKiF,QAAL,GAAgB9C,MAAM,CAACoD,MAAvB;AAChB,UAAMjF,IAAI,GAAG;AACTR,QAAAA,OAAO,EAAEiD,IAAI,CAACjD,OADL;AAETE,QAAAA,KAAK,EAALA;AAFS,OAAb;AAIA,WAAKf,MAAL,CAAYsB,IAAZ,CAAiB5B,eAAe,CAACyC,YAAjC,EAA+Cd,IAA/C;AACA,WAAKe,WAAL,CAAiBf,IAAjB;AACH;;;WAGD,gBAAOA,IAAP,EAAY;AACR,WAAKX,OAAL,CAAaW,IAAI,CAACR,OAAlB,EAA2BC,gBAA3B,GAA8CO,IAAI,CAACP,gBAAnD;AACH;;;;EA1SkCrB,MAAM,CAAC6H,K;;SAAzBvH,S","sourcesContent":["import * as Phaser from \"phaser\";\nimport websocketEvents from \"../constants/websocketEvents\";\nimport {gameDimensions, normalizers, sceneKeys} from \"../constants/gameSettings\";\nimport {detectTouchScreen} from \"../constants/constants\";\n\n\nexport default class GameScene extends Phaser.Scene {\n\n    constructor(socket, game) {\n        super({key: sceneKeys.game});\n\n        this.socket = socket;\n        this.settings = game.settings;\n        this.currentPlayer = game.currentPlayer;\n        this.settings.maxVelocityLittle = game.settings.velocity+0.5;\n        this.settings.accelerationLittle = 0.5;\n        this.settings.respawnTime = 5000;\n        this.settings.frictionAir = 0.1;\n        this.players = {};\n        game.players.forEach(player => {\n            this.players[player.localId] = player;\n            this.players[player.localId].availableBullets = 3;\n            this.players[player.localId].state = 2;\n            this.players[player.localId].lastTimestamp = 0;\n        });\n\n        this.updateFps = 15;\n        this.touchScreen = detectTouchScreen();\n\n        this.reloadInterval = setInterval(() => {\n            if(this.players[this.currentPlayer].availableBullets>=3) return;\n            const availableBullets = this.players[this.currentPlayer].availableBullets + 1;\n            const data = {\n                localId: this.currentPlayer,\n                availableBullets\n            };\n            this.socket.emit(websocketEvents.RELOAD, data);\n            this.reload(data);\n        }, 1/(this.settings.reloadingVelocity * normalizers.reloadingVelocity));\n    }\n\n    preload(){\n\n        this.load.image(\"ship0\", \"./ships/ship0.png\");\n        this.load.image(\"ship1\", \"./ships/ship1.png\");\n        this.load.image(\"ship2\", \"./ships/ship2.png\");\n        this.load.image(\"ship3\", \"./ships/ship3.png\");\n        this.load.image(\"little0\", \"./little.png\");\n        this.load.image(\"little1\", \"./little.png\");\n        this.load.image(\"little2\", \"./little.png\");\n        this.load.image(\"little3\", \"./little.png\");\n        this.load.image(\"bullet\", \"./bullet.png\");\n\n    }\n\n    create(){\n        this.createGroups();\n        this.createShips();\n\n        this.socket.on(websocketEvents.UPDATE_SHIP, data => this.updateShip(data));\n        this.socket.on(websocketEvents.SHOOT, data => this.createBullet(data));\n        this.socket.on(websocketEvents.CHANGE_STATE, data => this.updateState(data));\n        this.socket.on(websocketEvents.RELOAD, data => this.reload(data));\n\n        this.rotationKey = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE);\n        this.accelerateLittleKey = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.ENTER);\n        this.input.keyboard.on(\"keydown-ENTER\", ()=>{\n            if(this.players[this.currentPlayer].state>=2) this.shoot();\n        });\n        this.physics.world.on(\"worldbounds\", (bullet)=>{bullet.gameObject.destroy()});\n\n        if(this.touchScreen){\n            this.input.addPointer(1);\n            this.input.on(\"pointerup\", (pointer) => {\n                if(pointer.x<gameDimensions.width/2){\n                    this.rotating = false;\n                } else {\n                    this.accelerating = false;\n                }\n            });\n            this.input.on(\"pointerdown\", (pointer) => {\n                if(pointer.x<gameDimensions.width/2){\n                    this.rotating = true;\n                } else {\n                    if(this.players[this.currentPlayer].state >= 2){\n                        if(this.availableBullets>0) this.shoot();\n                    } else {\n                        this.accelerating = true;\n                    }\n                }\n            });\n        }\n\n\n        this.updateShipInterval = setInterval(()=>{\n            this.socket.emit(websocketEvents.UPDATE_SHIP, [\n                this.currentPlayer,\n                Number.parseInt(this.players[this.currentPlayer].ship.angle),\n                [\n                    Number.parseFloat(this.players[this.currentPlayer].ship.x.toFixed(2)),\n                    Number.parseFloat(this.players[this.currentPlayer].ship.y.toFixed(2))\n                ],\n                this.time.now\n            ]);\n        }, 1000/this.updateFps);\n    }\n\n    update(time, delta){\n        if(this.rotationKey.isDown || this.rotating) this.rotate(delta);\n        if(this.accelerateLittleKey.isDown || this.accelerating) this.moveLittle(delta);\n        const {x, y} = this.physics.velocityFromAngle(\n            this.players[this.currentPlayer].ship.angle,\n            this.players[this.currentPlayer].ship.velocityMagnitude\n        );\n        this.players[this.currentPlayer].ship.setVelocity(x, y);\n        if (this.players[this.currentPlayer].state === 1) {\n            this.players[this.currentPlayer].ship.velocityMagnitude = Math.max(\n                0, this.players[this.currentPlayer].ship.velocityMagnitude - this.settings.frictionAir * delta\n            );\n        }\n        Object.values(this.players).forEach(player => {\n           if(player.localId!==this.currentPlayer){\n               player.ship.autonomyTime -= delta;\n               if(player.ship.autonomyTime<0) {\n                   player.ship.setVelocity(0);\n                   player.ship.setAngularVelocity(0);\n               }\n           }\n        });\n        //if(this.ships.countActive() <= 1) console.log(\"game over\") //TODO: SETUP END OF THE TURN\n    }\n\n\n\n\n    //=============================================================================\n    //Creating things\n    createGroups(){\n        this.ships = this.physics.add.group();\n        this.bullets = this.physics.add.group();\n    }\n\n    createShips(){\n        let index = 0;\n        Object.values(this.players).forEach(player => {\n            player.ship = this.ships.create(\n                (index<2 ? 0.05 : 0.95) * gameDimensions.width,\n                ( index%2 === 0 ? 0.05 : 0.95 ) * gameDimensions.height,\n                \"ship\"+player.color\n            )\n\n            player.ship.localId = player.localId;\n            player.ship.setAngle(-45  * ( index < 2 ? 1 : 3) * ( ( index % 2 ) * 2 - 1 ));\n            player.ship.velocityMagnitude = this.settings.velocity*normalizers.velocity;\n            player.ship.autonomyTime = 0;\n\n            if(player.localId===this.currentPlayer){\n                player.ship.setCollideWorldBounds(true);\n                this.physics.add.overlap(player.ship, this.bullets, (ship, bullet) => {\n                    this.onBulletCollision(ship, bullet);\n                });\n                this.physics.add.collider(player.ship, this.ships, (currentShip, ship)=>{\n                    if(this.players[this.currentPlayer].state === 1 && this.players[ship.localId].state >= 2){\n                        this.killedBy = ship.localId;\n                        const data = {\n                            localId: this.currentPlayer,\n                            state: 0\n                        };\n                        this.socket.emit(websocketEvents.CHANGE_STATE, data);\n                        this.updateState(data);\n                    }\n                });\n            }\n\n            index++;\n        });\n\n        this.physics.add.collider(this.ships, this.ships);\n    }\n\n    createBullet(data){\n        const {x, y} = this.physics.velocityFromAngle(data.angle, this.settings.bulletVelocity*normalizers.bulletVelocity);\n        const deltaTime = Date.now()-data.timestamp;\n        const bullet = this.bullets.create(data.position.x+deltaTime*x/1000, data.position.y+deltaTime*y/1000, \"bullet\");\n        bullet.angle = data.angle;\n        bullet.setVelocity(x, y);\n        bullet.shotBy = data.localId;\n        bullet.setCollideWorldBounds(true);\n        bullet.body.onWorldBounds = true;\n        this.players[data.localId].availableBullets--;\n    }\n\n\n\n\n\n\n    //=============================================================================\n    //Others do things via the websocket\n    updateShip(data){\n        console.log(\"ship updated\", data);\n        const player = this.players[data[0]];\n        const deltaTime = (data[3]-player.lastTimestamp)/1000;\n        if(deltaTime<=0) return;\n\n        let deltaTheta = data[1] - Number.parseInt(player.ship.angle);\n\n        if(deltaTheta < -10) deltaTheta += 360;\n        else if(deltaTheta < 0) deltaTheta = 0;\n        const angularVelocity = deltaTheta / deltaTime;\n        player.ship.setAngularVelocity(angularVelocity);\n\n        player.ship.setVelocity( ( data[2][0]-player.ship.x ) / deltaTime, ( data[2][1]-player.ship.y ) / deltaTime );\n\n        player.lastTimestamp = data[3];\n        player.ship.autonomyTime = deltaTime*1000;\n    }\n\n\n\n    //=============================================================================\n    //Current players does things\n    rotate(delta){\n        this.players[this.currentPlayer].ship.angle += delta * this.settings.angularVelocity * normalizers.angularVelocity;\n    }\n\n    moveLittle(delta){\n        if(this.players[this.currentPlayer].state === 1){\n            const ship = this.players[this.currentPlayer].ship;\n            const previousMag = ship.velocityMagnitude;\n            if(previousMag < this.settings.maxVelocityLittle * normalizers.velocity){\n                this.players[this.currentPlayer].ship.velocityMagnitude += delta*this.settings.accelerationLittle;\n            } else {\n                this.players[this.currentPlayer].ship.velocityMagnitude = this.settings.maxVelocityLittle * normalizers.velocity;\n            }\n        }\n    }\n\n    shoot(){\n        if(this.players[this.currentPlayer].availableBullets>0){\n            const ship = this.players[this.currentPlayer].ship;\n            const angle = ship.angle;\n            const data = {\n                position: {\n                    x: ship.x + ship.width*Math.cos(angle * Math.PI / 180),\n                    y: ship.y + ship.width*Math.sin(angle * Math.PI / 180)\n                },\n                angle: angle,\n                localId: this.currentPlayer,\n                timestamp: Date.now()\n            };\n            this.socket.emit(websocketEvents.SHOOT, data);\n            this.createBullet(data);\n        }\n    }\n\n\n    updateState(data){\n        this.players[data.localId].state = data.state;\n        const ship = this.players[data.localId].ship;\n        switch (data.state) {\n            case 0:\n                this.ships.killAndHide(ship);\n                this.ships.remove(ship);\n                clearInterval(this.reloadInterval);\n                clearInterval(this.updateShipInterval);\n                break;\n            case 1:\n                ship.setTexture(\"little\" + this.players[data.localId].color);\n                if(data.localId === this.currentPlayer) {\n                    setTimeout(() => {\n                        if (this.players[data.localId].state === 1) {\n                            const data = {\n                                localId: this.currentPlayer,\n                                state: 2\n                            };\n                            this.updateState(data);\n                            this.socket.emit(websocketEvents.CHANGE_STATE, data);\n                        }\n                    }, this.settings.respawnTime);\n                }\n                break;\n            case 2:\n                ship.velocityMagnitude = this.settings.velocity * normalizers.velocity;\n                ship.setTexture(\"ship\" + this.players[data.localId].color);\n                break;\n        }\n    }\n\n    onBulletCollision(ship, bullet){\n        bullet.destroy();\n        const state = this.players[ship.localId].state-1;\n        if(state === 0) this.killedBy = bullet.shotBy;\n        const data = {\n            localId: ship.localId,\n            state\n        };\n        this.socket.emit(websocketEvents.CHANGE_STATE, data);\n        this.updateState(data);\n    }\n\n\n    reload(data){\n        this.players[data.localId].availableBullets = data.availableBullets;\n    }\n}"]}]}