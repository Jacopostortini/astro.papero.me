{"remainingRequest":"/media/jacopo/VolumeDati/Documenti/papero.tk/cosmos.papero.me/node_modules/thread-loader/dist/cjs.js!/media/jacopo/VolumeDati/Documenti/papero.tk/cosmos.papero.me/node_modules/babel-loader/lib/index.js!/media/jacopo/VolumeDati/Documenti/papero.tk/cosmos.papero.me/node_modules/eslint-loader/index.js??ref--13-0!/media/jacopo/VolumeDati/Documenti/papero.tk/cosmos.papero.me/src/phaser/GameScene.js","dependencies":[{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/cosmos.papero.me/src/phaser/GameScene.js","mtime":1616952439251},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/cosmos.papero.me/node_modules/cache-loader/dist/cjs.js","mtime":1616495189815},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/cosmos.papero.me/node_modules/thread-loader/dist/cjs.js","mtime":1616495190967},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/cosmos.papero.me/node_modules/babel-loader/lib/index.js","mtime":1616495189787},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/cosmos.papero.me/node_modules/eslint-loader/index.js","mtime":1616495190059}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9jb3Ntb3MucGFwZXJvLm1lL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiL21lZGlhL2phY29wby9Wb2x1bWVEYXRpL0RvY3VtZW50aS9wYXBlcm8udGsvY29zbW9zLnBhcGVyby5tZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIi9tZWRpYS9qYWNvcG8vVm9sdW1lRGF0aS9Eb2N1bWVudGkvcGFwZXJvLnRrL2Nvc21vcy5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKaW1wb3J0IF9jcmVhdGVTdXBlciBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9jb3Ntb3MucGFwZXJvLm1lL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVTdXBlciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudmFsdWVzLmpzIjsKaW1wb3J0ICogYXMgUGhhc2VyIGZyb20gInBoYXNlciI7CmltcG9ydCB3ZWJzb2NrZXRFdmVudHMgZnJvbSAiLi4vY29uc3RhbnRzL3dlYnNvY2tldEV2ZW50cyI7CmltcG9ydCB7IGdhbWVEaW1lbnNpb25zLCBnZXRWZWxvY2l0eSwgbm9ybWFsaXplcnMsIHNjZW5lS2V5cyB9IGZyb20gIi4uL2NvbnN0YW50cy9nYW1lU2V0dGluZ3MiOwoKdmFyIEdhbWVTY2VuZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1BoYXNlciRTY2VuZSkgewogIF9pbmhlcml0cyhHYW1lU2NlbmUsIF9QaGFzZXIkU2NlbmUpOwoKICB2YXIgX3N1cGVyID0gX2NyZWF0ZVN1cGVyKEdhbWVTY2VuZSk7CgogIGZ1bmN0aW9uIEdhbWVTY2VuZShzb2NrZXQsIGdhbWUpIHsKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgR2FtZVNjZW5lKTsKCiAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHsKICAgICAga2V5OiBzY2VuZUtleXMuZ2FtZQogICAgfSk7CiAgICBfdGhpcy5zb2NrZXQgPSBzb2NrZXQ7CiAgICBfdGhpcy5zZXR0aW5ncyA9IGdhbWUuc2V0dGluZ3M7CiAgICBfdGhpcy5jdXJyZW50UGxheWVyID0gZ2FtZS5jdXJyZW50UGxheWVyOwogICAgX3RoaXMuc2V0dGluZ3MubWF4VmVsb2NpdHlMaXR0bGUgPSBnYW1lLnNldHRpbmdzLnZlbG9jaXR5ICsgMC41OwogICAgX3RoaXMuc2V0dGluZ3MuYWNjZWxlcmF0aW9uTGl0dGxlID0gMC41OwogICAgX3RoaXMuc2V0dGluZ3MuZnJpY3Rpb25BaXIgPSAwLjE7CiAgICBfdGhpcy5wbGF5ZXJzID0ge307CiAgICBnYW1lLnBsYXllcnMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7CiAgICAgIF90aGlzLnBsYXllcnNbcGxheWVyLmxvY2FsSWRdID0gcGxheWVyOwogICAgICBfdGhpcy5wbGF5ZXJzW3BsYXllci5sb2NhbElkXS5hdmFpbGFibGVCdWxsZXRzID0gMzsKICAgIH0pOwogICAgLyp0aGlzLnNldHRpbmdzID0gZGVmYXVsdFNldHRpbmdzOwogICAgdGhpcy5zZXR0aW5ncy5tYXhWZWxvY2l0eUxpdHRsZSA9IDIuNTsKICAgIHRoaXMuc2V0dGluZ3MuYWNjZWxlcmF0aW9uTGl0dGxlID0gMC41OwogICAgdGhpcy5zZXR0aW5ncy5mcmljdGlvbkFpciA9IDAuMTsKICAgIHRoaXMuY3VycmVudFBsYXllciA9IDA7CiAgICB0aGlzLnBsYXllcnMgPSB7IC8vU1RBVEU6IDA9ZGVhZCAxPWxpdHRsZSAyPXNoaXAgMz1zaGllbGQoPykKICAgICAgICAnMCc6IHsKICAgICAgICAgICAgbG9jYWxJZDogMCwKICAgICAgICAgICAgY29sb3I6IDAsCiAgICAgICAgICAgIGF2YWlsYWJsZUJ1bGxldHM6IDMsCiAgICAgICAgICAgIHN0YXRlOiAyCiAgICAgICAgfSwKICAgICAgICAnMSc6IHsKICAgICAgICAgICAgbG9jYWxJZDogMSwKICAgICAgICAgICAgY29sb3I6IDEsCiAgICAgICAgICAgIGF2YWlsYWJsZUJ1bGxldHM6IDMsCiAgICAgICAgICAgIHN0YXRlOiAyCiAgICAgICAgfSwKICAgICAgICAnMic6IHsKICAgICAgICAgICAgbG9jYWxJZDogMiwKICAgICAgICAgICAgY29sb3I6IDIsCiAgICAgICAgICAgIGF2YWlsYWJsZUJ1bGxldHM6IDMsCiAgICAgICAgICAgIHN0YXRlOiAyCiAgICAgICAgfQogICAgfTsqLwoKICAgIHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGF2YWlsYWJsZUJ1bGxldHMgPSBNYXRoLm1pbigzLCBfdGhpcy5wbGF5ZXJzW190aGlzLmN1cnJlbnRQbGF5ZXJdLmF2YWlsYWJsZUJ1bGxldHMgKyAxKTsKICAgICAgdmFyIGRhdGEgPSB7CiAgICAgICAgbG9jYWxJZDogX3RoaXMuY3VycmVudFBsYXllciwKICAgICAgICBhdmFpbGFibGVCdWxsZXRzOiBhdmFpbGFibGVCdWxsZXRzCiAgICAgIH07CgogICAgICBfdGhpcy5zb2NrZXQuZW1pdCh3ZWJzb2NrZXRFdmVudHMuUkVMT0FELCBkYXRhKTsKCiAgICAgIF90aGlzLnJlbG9hZChkYXRhKTsKICAgIH0sIDEgLyAoX3RoaXMuc2V0dGluZ3MucmVsb2FkaW5nVmVsb2NpdHkgKiBub3JtYWxpemVycy5yZWxvYWRpbmdWZWxvY2l0eSkpOwogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEdhbWVTY2VuZSwgW3sKICAgIGtleTogInByZWxvYWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHByZWxvYWQoKSB7CiAgICAgIHRoaXMubG9hZC5pbWFnZSgic2hpcDAiLCAiLi9zaGlwcy9zaGlwMC5wbmciKTsKICAgICAgdGhpcy5sb2FkLmltYWdlKCJzaGlwMSIsICIuL3NoaXBzL3NoaXAxLnBuZyIpOwogICAgICB0aGlzLmxvYWQuaW1hZ2UoInNoaXAyIiwgIi4vc2hpcHMvc2hpcDIucG5nIik7CiAgICAgIHRoaXMubG9hZC5pbWFnZSgic2hpcDMiLCAiLi9zaGlwcy9zaGlwMy5wbmciKTsKICAgICAgdGhpcy5sb2FkLmltYWdlKCJsaXR0bGUwIiwgIi4vbGl0dGxlLnBuZyIpOwogICAgICB0aGlzLmxvYWQuaW1hZ2UoImxpdHRsZTEiLCAiLi9saXR0bGUucG5nIik7CiAgICAgIHRoaXMubG9hZC5pbWFnZSgibGl0dGxlMiIsICIuL2xpdHRsZS5wbmciKTsKICAgICAgdGhpcy5sb2FkLmltYWdlKCJsaXR0bGUzIiwgIi4vbGl0dGxlLnBuZyIpOwogICAgICB0aGlzLmxvYWQuaW1hZ2UoImJ1bGxldCIsICIuL2J1bGxldC5wbmciKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjcmVhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZSgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB0aGlzLmNyZWF0ZUdyb3VwcygpOwogICAgICB0aGlzLmNyZWF0ZVNoaXBzKCk7CiAgICAgIHRoaXMuc29ja2V0Lm9uKHdlYnNvY2tldEV2ZW50cy5ST1RBVEVfU0hJUCwgZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMyLm9uU2hpcFJvdGF0ZWQoZGF0YSk7CiAgICAgIH0pOwogICAgICB0aGlzLnNvY2tldC5vbih3ZWJzb2NrZXRFdmVudHMuTU9WRV9MSVRUTEUsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgcmV0dXJuIF90aGlzMi5vbkxpdHRsZU1vdmVkKGRhdGEpOwogICAgICB9KTsKICAgICAgdGhpcy5zb2NrZXQub24od2Vic29ja2V0RXZlbnRzLlNIT09ULCBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIHJldHVybiBfdGhpczIuY3JlYXRlQnVsbGV0KGRhdGEpOwogICAgICB9KTsKICAgICAgdGhpcy5zb2NrZXQub24od2Vic29ja2V0RXZlbnRzLkNIQU5HRV9TVEFURSwgZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMyLnVwZGF0ZVN0YXRlKGRhdGEpOwogICAgICB9KTsKICAgICAgdGhpcy5zb2NrZXQub24od2Vic29ja2V0RXZlbnRzLlJFTE9BRCwgZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICByZXR1cm4gX3RoaXMyLnJlbG9hZChkYXRhKTsKICAgICAgfSk7CiAgICAgIHRoaXMucm90YXRpb25LZXkgPSB0aGlzLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuSW5wdXQuS2V5Ym9hcmQuS2V5Q29kZXMuU1BBQ0UpOwogICAgICB0aGlzLmFjY2VsZXJhdGVMaXR0bGVLZXkgPSB0aGlzLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuSW5wdXQuS2V5Ym9hcmQuS2V5Q29kZXMuRU5URVIpOwogICAgICB0aGlzLmlucHV0LmtleWJvYXJkLm9uKCJrZXl1cC1FTlRFUiIsIHRoaXMuc2hvb3QsIHRoaXMpOwogICAgICB0aGlzLnBoeXNpY3Mud29ybGQub24oIndvcmxkYm91bmRzIiwgZnVuY3Rpb24gKGJ1bGxldCkgewogICAgICAgIGJ1bGxldC5nYW1lT2JqZWN0LmRlc3Ryb3koKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAidXBkYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGUodGltZSwgZGVsdGEpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICBpZiAodGhpcy5yb3RhdGlvbktleS5pc0Rvd24pIHRoaXMucm90YXRlKGRlbHRhKTsKCiAgICAgIGlmICh0aGlzLnBsYXllcnNbdGhpcy5jdXJyZW50UGxheWVyXS5zdGF0ZSA9PT0gMSkgewogICAgICAgIGlmICh0aGlzLmFjY2VsZXJhdGVMaXR0bGVLZXkuaXNEb3duKSB0aGlzLm1vdmVMaXR0bGUoZGVsdGEpOwogICAgICB9CgogICAgICBPYmplY3QudmFsdWVzKHRoaXMucGxheWVycykuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7CiAgICAgICAgdmFyIF9nZXRWZWxvY2l0eSA9IGdldFZlbG9jaXR5KHBsYXllci5zaGlwLnJvdGF0aW9uLCBfdGhpczMuc2V0dGluZ3MudmVsb2NpdHkgKiBub3JtYWxpemVycy52ZWxvY2l0eSksCiAgICAgICAgICAgIHggPSBfZ2V0VmVsb2NpdHkueCwKICAgICAgICAgICAgeSA9IF9nZXRWZWxvY2l0eS55OwoKICAgICAgICBwbGF5ZXIuc2hpcC5zZXRWZWxvY2l0eSh4LCB5KTsKCiAgICAgICAgaWYgKHBsYXllci5zdGF0ZSA9PT0gMikgewogICAgICAgICAgcGxheWVyLnNoaXAudmVsb2NpdHlNYWduaXR1ZGUgPSBNYXRoLm1heCgwLCBwbGF5ZXIuc2hpcC52ZWxvY2l0eU1hZ25pdHVkZSAtIF90aGlzMy5zZXR0aW5ncy5mcmljdGlvbkFpciAqIGRlbHRhKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAvL0NyZWF0aW5nIHRoaW5ncwoKICB9LCB7CiAgICBrZXk6ICJjcmVhdGVHcm91cHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZUdyb3VwcygpIHsKICAgICAgdGhpcy5zaGlwcyA9IHRoaXMucGh5c2ljcy5hZGQuZ3JvdXAoKTsKICAgICAgdGhpcy5idWxsZXRzID0gdGhpcy5waHlzaWNzLmFkZC5ncm91cCgpOwogICAgfQogIH0sIHsKICAgIGtleTogImNyZWF0ZVNoaXBzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVTaGlwcygpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICB2YXIgaW5kZXggPSAwOwogICAgICBPYmplY3QudmFsdWVzKHRoaXMucGxheWVycykuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7CiAgICAgICAgcGxheWVyLnNoaXAgPSBfdGhpczQuc2hpcHMuY3JlYXRlKChpbmRleCA8IDIgPyAwLjA1IDogMC45NSkgKiBnYW1lRGltZW5zaW9ucy53aWR0aCwgKGluZGV4ICUgMiA9PT0gMCA/IDAuMDUgOiAwLjk1KSAqIGdhbWVEaW1lbnNpb25zLmhlaWdodCwgInNoaXAiICsgcGxheWVyLmNvbG9yKTsKICAgICAgICBwbGF5ZXIuc2hpcC5sb2NhbElkID0gcGxheWVyLmxvY2FsSWQ7CiAgICAgICAgcGxheWVyLnNoaXAuc2V0Um90YXRpb24oLU1hdGguUEkgLyA0ICogKGluZGV4IDwgMiA/IDEgOiAzKSAqIChpbmRleCAlIDIgKiAyIC0gMSkpOwogICAgICAgIHBsYXllci5zaGlwLnNldENvbGxpZGVXb3JsZEJvdW5kcyh0cnVlKTsKICAgICAgICBwbGF5ZXIuc2hpcC52ZWxvY2l0eU1hZ25pdHVkZSA9IF90aGlzNC5zZXR0aW5ncy52ZWxvY2l0eSAqIG5vcm1hbGl6ZXJzLnZlbG9jaXR5OwoKICAgICAgICBpZiAocGxheWVyLmxvY2FsSWQgPT09IF90aGlzNC5jdXJyZW50UGxheWVyKSB7CiAgICAgICAgICBfdGhpczQucGh5c2ljcy5hZGQub3ZlcmxhcChwbGF5ZXIuc2hpcCwgX3RoaXM0LmJ1bGxldHMsIGZ1bmN0aW9uIChzaGlwLCBidWxsZXQpIHsKICAgICAgICAgICAgX3RoaXM0Lm9uQnVsbGV0Q29sbGlzaW9uKHNoaXAsIGJ1bGxldCk7CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGluZGV4Kys7CiAgICAgIH0pOwogICAgICB0aGlzLnBoeXNpY3MuYWRkLmNvbGxpZGVyKHRoaXMuc2hpcHMsIHRoaXMuc2hpcHMpOwogICAgfQogIH0sIHsKICAgIGtleTogImNyZWF0ZUJ1bGxldCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlQnVsbGV0KGRhdGEpIHsKICAgICAgdmFyIGJ1bGxldCA9IHRoaXMuYnVsbGV0cy5jcmVhdGUoZGF0YS5wb3NpdGlvbi54LCBkYXRhLnBvc2l0aW9uLnksICJidWxsZXQiKTsKICAgICAgYnVsbGV0LnJvdGF0aW9uID0gZGF0YS5yb3RhdGlvbjsKCiAgICAgIHZhciBfZ2V0VmVsb2NpdHkyID0gZ2V0VmVsb2NpdHkoZGF0YS5yb3RhdGlvbiwgdGhpcy5zZXR0aW5ncy5idWxsZXRWZWxvY2l0eSAqIG5vcm1hbGl6ZXJzLmJ1bGxldFZlbG9jaXR5KSwKICAgICAgICAgIHggPSBfZ2V0VmVsb2NpdHkyLngsCiAgICAgICAgICB5ID0gX2dldFZlbG9jaXR5Mi55OwoKICAgICAgYnVsbGV0LnNldFZlbG9jaXR5KHgsIHkpOwogICAgICBidWxsZXQuc2hvdEJ5ID0gZGF0YS5sb2NhbElkOwogICAgICBidWxsZXQuc2V0Q29sbGlkZVdvcmxkQm91bmRzKHRydWUpOwogICAgICBidWxsZXQuYm9keS5vbldvcmxkQm91bmRzID0gdHJ1ZTsKICAgICAgdGhpcy5wbGF5ZXJzW2RhdGEubG9jYWxJZF0uYXZhaWxhYmxlQnVsbGV0cy0tOwogICAgfSAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAvL090aGVycyBkbyB0aGluZ3MgdmlhIHRoZSB3ZWJzb2NrZXQKCiAgfSwgewogICAga2V5OiAib25TaGlwUm90YXRlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25TaGlwUm90YXRlZChkYXRhKSB7CiAgICAgIHRoaXMucGxheWVyc1tkYXRhLmxvY2FsSWRdLnNoaXAuc2V0UG9zaXRpb24oZGF0YS5wb3NpdGlvbi54LCBkYXRhLnBvc2l0aW9uLnkpOwogICAgICB0aGlzLnBsYXllcnNbZGF0YS5sb2NhbElkXS5zaGlwLnNldFJvdGF0aW9uKGRhdGEucm90YXRpb24pOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uTGl0dGxlTW92ZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uTGl0dGxlTW92ZWQoZGF0YSkgewogICAgICB0aGlzLnBsYXllcnNbZGF0YS5sb2NhbElkXS5zaGlwLnNldFBvc2l0aW9uKGRhdGEucG9zaXRpb24ueCwgZGF0YS5wb3NpdGlvbi55KTsKICAgICAgdGhpcy5wbGF5ZXJzW2RhdGEubG9jYWxJZF0uc2hpcC52ZWxvY2l0eU1hZ25pdHVkZSA9IGRhdGEudmVsb2NpdHlNYWduaXR1ZGU7CiAgICB9IC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgIC8vQ3VycmVudCBwbGF5ZXJzIGRvZXMgdGhpbmdzCgogIH0sIHsKICAgIGtleTogInJvdGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcm90YXRlKGRlbHRhKSB7CiAgICAgIHRoaXMucGxheWVyc1t0aGlzLmN1cnJlbnRQbGF5ZXJdLnNoaXAucm90YXRpb24gKz0gZGVsdGEgKiB0aGlzLnNldHRpbmdzLmFuZ3VsYXJWZWxvY2l0eSAqIG5vcm1hbGl6ZXJzLmFuZ3VsYXJWZWxvY2l0eTsKICAgICAgdGhpcy5zb2NrZXQuZW1pdCh3ZWJzb2NrZXRFdmVudHMuUk9UQVRFX1NISVAsIHsKICAgICAgICBsb2NhbElkOiB0aGlzLmN1cnJlbnRQbGF5ZXIsCiAgICAgICAgcm90YXRpb246IHRoaXMucGxheWVyc1t0aGlzLmN1cnJlbnRQbGF5ZXJdLnNoaXAucm90YXRpb24sCiAgICAgICAgcG9zaXRpb246IHsKICAgICAgICAgIHg6IHRoaXMucGxheWVyc1t0aGlzLmN1cnJlbnRQbGF5ZXJdLnNoaXAueCwKICAgICAgICAgIHk6IHRoaXMucGxheWVyc1t0aGlzLmN1cnJlbnRQbGF5ZXJdLnNoaXAueQogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAibW92ZUxpdHRsZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbW92ZUxpdHRsZShkZWx0YSkgewogICAgICBpZiAodGhpcy5wbGF5ZXJzW3RoaXMuY3VycmVudFBsYXllcl0uc3RhdGUgPT09IDEpIHsKICAgICAgICB2YXIgc2hpcCA9IHRoaXMucGxheWVyc1t0aGlzLmN1cnJlbnRQbGF5ZXJdLnNoaXA7CgogICAgICAgIGlmIChzaGlwLnZlbG9jaXR5TWFnbml0dWRlIDwgdGhpcy5zZXR0aW5ncy5tYXhWZWxvY2l0eUxpdHRsZSAqIG5vcm1hbGl6ZXJzLnZlbG9jaXR5KSB7CiAgICAgICAgICBzaGlwLnZlbG9jaXR5TWFnbml0dWRlICs9IGRlbHRhICogdGhpcy5zZXR0aW5ncy5hY2NlbGVyYXRpb25MaXR0bGU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHNoaXAudmVsb2NpdHlNYWduaXR1ZGUgPSB0aGlzLnNldHRpbmdzLm1heFZlbG9jaXR5TGl0dGxlICogbm9ybWFsaXplcnMudmVsb2NpdHk7CiAgICAgICAgfQoKICAgICAgICB0aGlzLnNvY2tldC5lbWl0KHdlYnNvY2tldEV2ZW50cy5NT1ZFX0xJVFRMRSwgewogICAgICAgICAgbG9jYWxJZDogdGhpcy5jdXJyZW50UGxheWVyLAogICAgICAgICAgcG9zaXRpb246IHsKICAgICAgICAgICAgeDogc2hpcC54LAogICAgICAgICAgICB5OiBzaGlwLnkKICAgICAgICAgIH0sCiAgICAgICAgICB2ZWxvY2l0eU1hZ25pdHVkZTogc2hpcC52ZWxvY2l0eU1hZ25pdHVkZQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAic2hvb3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNob290KCkgewogICAgICBpZiAodGhpcy5wbGF5ZXJzW3RoaXMuY3VycmVudFBsYXllcl0uYXZhaWxhYmxlQnVsbGV0cyA+IDAgJiYgdGhpcy5wbGF5ZXJzW3RoaXMuY3VycmVudFBsYXllcl0uc3RhdGUgPj0gMikgewogICAgICAgIHZhciBzaGlwID0gdGhpcy5wbGF5ZXJzW3RoaXMuY3VycmVudFBsYXllcl0uc2hpcDsKICAgICAgICB2YXIgYW5nbGUgPSBzaGlwLnJvdGF0aW9uOwogICAgICAgIHZhciBkYXRhID0gewogICAgICAgICAgcG9zaXRpb246IHsKICAgICAgICAgICAgeDogc2hpcC54ICsgc2hpcC53aWR0aCAqIE1hdGguY29zKGFuZ2xlKSwKICAgICAgICAgICAgeTogc2hpcC55ICsgc2hpcC53aWR0aCAqIE1hdGguc2luKGFuZ2xlKQogICAgICAgICAgfSwKICAgICAgICAgIHJvdGF0aW9uOiBhbmdsZSwKICAgICAgICAgIGxvY2FsSWQ6IHRoaXMuY3VycmVudFBsYXllcgogICAgICAgIH07CiAgICAgICAgdGhpcy5zb2NrZXQuZW1pdCh3ZWJzb2NrZXRFdmVudHMuU0hPT1QsIGRhdGEpOwogICAgICAgIHRoaXMuY3JlYXRlQnVsbGV0KGRhdGEpOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAidXBkYXRlU3RhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZVN0YXRlKGRhdGEpIHsKICAgICAgdGhpcy5wbGF5ZXJzW2RhdGEubG9jYWxJZF0uc3RhdGUgPSBkYXRhLnN0YXRlOwogICAgfQogIH0sIHsKICAgIGtleTogIm9uQnVsbGV0Q29sbGlzaW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkJ1bGxldENvbGxpc2lvbihzaGlwLCBidWxsZXQpIHsKICAgICAgYnVsbGV0LmRlc3Ryb3koKTsKICAgICAgdGhpcy5wbGF5ZXJzW3NoaXAubG9jYWxJZF0uc3RhdGUtLTsKCiAgICAgIHN3aXRjaCAodGhpcy5wbGF5ZXJzW3NoaXAubG9jYWxJZF0uc3RhdGUpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBzaGlwLmRlc3Ryb3koKTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDE6CiAgICAgICAgICBzaGlwLnNldFRleHR1cmUoImxpdHRsZSIgKyBzaGlwLmxvY2FsSWQpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgMjoKICAgICAgICAgIHNoaXAuc2V0VGV4dHVyZSgic2hpcCIgKyBzaGlwLmxvY2FsSWQpOwogICAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIHRoaXMuc29ja2V0LmVtaXQod2Vic29ja2V0RXZlbnRzLkNIQU5HRV9TVEFURSwgewogICAgICAgIGxvY2FsSWQ6IHNoaXAubG9jYWxJZCwKICAgICAgICBzdGF0ZTogdGhpcy5wbGF5ZXJzW3NoaXAubG9jYWxJZF0uc3RhdGUKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAicmVsb2FkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZWxvYWQoZGF0YSkgewogICAgICBjb25zb2xlLmxvZyhkYXRhKTsKICAgICAgdGhpcy5wbGF5ZXJzW2RhdGEubG9jYWxJZF0uYXZhaWxhYmxlQnVsbGV0cyA9IGRhdGEuYXZhaWxhYmxlQnVsbGV0czsKICAgIH0KICB9XSk7CgogIHJldHVybiBHYW1lU2NlbmU7Cn0oUGhhc2VyLlNjZW5lKTsKCmV4cG9ydCB7IEdhbWVTY2VuZSBhcyBkZWZhdWx0IH07"},{"version":3,"sources":["/media/jacopo/VolumeDati/Documenti/papero.tk/cosmos.papero.me/src/phaser/GameScene.js"],"names":["Phaser","websocketEvents","gameDimensions","getVelocity","normalizers","sceneKeys","GameScene","socket","game","key","settings","currentPlayer","maxVelocityLittle","velocity","accelerationLittle","frictionAir","players","forEach","player","localId","availableBullets","setInterval","Math","min","data","emit","RELOAD","reload","reloadingVelocity","load","image","createGroups","createShips","on","ROTATE_SHIP","onShipRotated","MOVE_LITTLE","onLittleMoved","SHOOT","createBullet","CHANGE_STATE","updateState","rotationKey","input","keyboard","addKey","Input","Keyboard","KeyCodes","SPACE","accelerateLittleKey","ENTER","shoot","physics","world","bullet","gameObject","destroy","time","delta","isDown","rotate","state","moveLittle","Object","values","ship","rotation","x","y","setVelocity","velocityMagnitude","max","ships","add","group","bullets","index","create","width","height","color","setRotation","PI","setCollideWorldBounds","overlap","onBulletCollision","collider","position","bulletVelocity","shotBy","body","onWorldBounds","setPosition","angularVelocity","angle","cos","sin","setTexture","console","log","Scene"],"mappings":"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","sourcesContent":["import * as Phaser from \"phaser\";\nimport websocketEvents from \"../constants/websocketEvents\";\nimport {gameDimensions, getVelocity, normalizers, sceneKeys} from \"../constants/gameSettings\";\n\n\nexport default class GameScene extends Phaser.Scene {\n\n    constructor(socket, game) {\n        super({key: sceneKeys.game});\n\n        this.socket = socket;\n        this.settings = game.settings;\n        this.currentPlayer = game.currentPlayer;\n        this.settings.maxVelocityLittle = game.settings.velocity+0.5;\n        this.settings.accelerationLittle = 0.5;\n        this.settings.frictionAir = 0.1;\n        this.players = {};\n        game.players.forEach(player => {\n            this.players[player.localId] = player;\n            this.players[player.localId].availableBullets = 3;\n        });\n\n        /*this.settings = defaultSettings;\n        this.settings.maxVelocityLittle = 2.5;\n        this.settings.accelerationLittle = 0.5;\n        this.settings.frictionAir = 0.1;\n        this.currentPlayer = 0;\n        this.players = { //STATE: 0=dead 1=little 2=ship 3=shield(?)\n            '0': {\n                localId: 0,\n                color: 0,\n                availableBullets: 3,\n                state: 2\n            },\n            '1': {\n                localId: 1,\n                color: 1,\n                availableBullets: 3,\n                state: 2\n            },\n            '2': {\n                localId: 2,\n                color: 2,\n                availableBullets: 3,\n                state: 2\n            }\n        };*/\n\n        setInterval(() => {\n            const availableBullets = Math.min(3, this.players[this.currentPlayer].availableBullets + 1);\n            const data = {\n                localId: this.currentPlayer,\n                availableBullets\n            };\n            this.socket.emit(websocketEvents.RELOAD, data);\n            this.reload(data);\n        }, 1/(this.settings.reloadingVelocity * normalizers.reloadingVelocity));\n    }\n\n    preload(){\n\n        this.load.image(\"ship0\", \"./ships/ship0.png\");\n        this.load.image(\"ship1\", \"./ships/ship1.png\");\n        this.load.image(\"ship2\", \"./ships/ship2.png\");\n        this.load.image(\"ship3\", \"./ships/ship3.png\");\n        this.load.image(\"little0\", \"./little.png\");\n        this.load.image(\"little1\", \"./little.png\");\n        this.load.image(\"little2\", \"./little.png\");\n        this.load.image(\"little3\", \"./little.png\");\n        this.load.image(\"bullet\", \"./bullet.png\");\n\n    }\n\n    create(){\n        this.createGroups();\n        this.createShips();\n\n        this.socket.on(websocketEvents.ROTATE_SHIP, data => this.onShipRotated(data));\n        this.socket.on(websocketEvents.MOVE_LITTLE, data => this.onLittleMoved(data));\n        this.socket.on(websocketEvents.SHOOT, data => this.createBullet(data));\n        this.socket.on(websocketEvents.CHANGE_STATE, data => this.updateState(data));\n        this.socket.on(websocketEvents.RELOAD, data => this.reload(data));\n\n        this.rotationKey = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE);\n        this.accelerateLittleKey = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.ENTER);\n        this.input.keyboard.on(\"keyup-ENTER\", this.shoot, this);\n        this.physics.world.on(\"worldbounds\", (bullet)=>{bullet.gameObject.destroy()});\n    }\n\n    update(time, delta){\n        if(this.rotationKey.isDown) this.rotate(delta);\n        if(this.players[this.currentPlayer].state === 1){\n            if(this.accelerateLittleKey.isDown) this.moveLittle(delta)\n        }\n        Object.values(this.players).forEach(player => {\n            const {x, y} = getVelocity(player.ship.rotation, this.settings.velocity * normalizers.velocity);\n            player.ship.setVelocity(x, y);\n            if(player.state === 2){\n                player.ship.velocityMagnitude = Math.max(\n                    0, player.ship.velocityMagnitude-this.settings.frictionAir*delta\n                );\n            }\n        });\n    }\n\n\n\n\n    //=============================================================================\n    //Creating things\n    createGroups(){\n        this.ships = this.physics.add.group();\n        this.bullets = this.physics.add.group();\n    }\n\n    createShips(){\n        let index = 0;\n        Object.values(this.players).forEach(player => {\n            player.ship = this.ships.create(\n                (index<2 ? 0.05 : 0.95) * gameDimensions.width,\n                ( index%2 === 0 ? 0.05 : 0.95 ) * gameDimensions.height,\n                \"ship\"+player.color\n            )\n\n            player.ship.localId = player.localId;\n            player.ship.setRotation(-Math.PI / 4  * ( index < 2 ? 1 : 3) * ( ( index % 2 ) * 2 - 1 ));\n            player.ship.setCollideWorldBounds(true);\n            player.ship.velocityMagnitude = this.settings.velocity*normalizers.velocity;\n\n            if(player.localId===this.currentPlayer){\n                this.physics.add.overlap(player.ship, this.bullets, (ship, bullet) => {\n                    this.onBulletCollision(ship, bullet);\n                });\n            }\n\n            index++;\n        });\n\n        this.physics.add.collider(this.ships, this.ships);\n    }\n\n    createBullet(data){\n        const bullet = this.bullets.create(data.position.x, data.position.y, \"bullet\");\n        bullet.rotation = data.rotation;\n        const {x, y} = getVelocity(data.rotation, this.settings.bulletVelocity*normalizers.bulletVelocity);\n        bullet.setVelocity(x, y);\n        bullet.shotBy = data.localId;\n        bullet.setCollideWorldBounds(true);\n        bullet.body.onWorldBounds = true;\n        this.players[data.localId].availableBullets--;\n    }\n\n\n\n\n\n\n    //=============================================================================\n    //Others do things via the websocket\n    onShipRotated(data){\n        this.players[data.localId].ship.setPosition(data.position.x, data.position.y);\n        this.players[data.localId].ship.setRotation(data.rotation);\n    }\n\n    onLittleMoved(data){\n        this.players[data.localId].ship.setPosition(data.position.x, data.position.y);\n        this.players[data.localId].ship.velocityMagnitude = data.velocityMagnitude;\n    }\n\n\n\n    //=============================================================================\n    //Current players does things\n    rotate(delta){\n        this.players[this.currentPlayer].ship.rotation += delta * this.settings.angularVelocity * normalizers.angularVelocity;\n        this.socket.emit(websocketEvents.ROTATE_SHIP, {\n            localId: this.currentPlayer,\n            rotation: this.players[this.currentPlayer].ship.rotation,\n            position: {\n                x: this.players[this.currentPlayer].ship.x,\n                y: this.players[this.currentPlayer].ship.y\n            }\n        });\n    }\n\n    moveLittle(delta){\n        if(this.players[this.currentPlayer].state === 1){\n            const ship = this.players[this.currentPlayer].ship;\n            if(ship.velocityMagnitude < this.settings.maxVelocityLittle * normalizers.velocity){\n                ship.velocityMagnitude += delta*this.settings.accelerationLittle;\n            } else {\n                ship.velocityMagnitude = this.settings.maxVelocityLittle * normalizers.velocity;\n            }\n\n            this.socket.emit(websocketEvents.MOVE_LITTLE, {\n                localId: this.currentPlayer,\n                position: {\n                    x: ship.x,\n                    y: ship.y\n                },\n                velocityMagnitude: ship.velocityMagnitude\n            })\n        }\n    }\n\n    shoot(){\n        if(this.players[this.currentPlayer].availableBullets>0 && this.players[this.currentPlayer].state>=2){\n            const ship = this.players[this.currentPlayer].ship;\n            const angle = ship.rotation;\n            const data = {\n                position: {\n                    x: ship.x + ship.width*Math.cos(angle),\n                    y: ship.y + ship.width*Math.sin(angle)\n                },\n                rotation: angle,\n                localId: this.currentPlayer\n            };\n            this.socket.emit(websocketEvents.SHOOT, data);\n            this.createBullet(data);\n        }\n    }\n\n\n    updateState(data){\n        this.players[data.localId].state = data.state;\n    }\n\n    onBulletCollision(ship, bullet){\n        bullet.destroy();\n        this.players[ship.localId].state--;\n        switch (this.players[ship.localId].state){\n            case 0:\n                ship.destroy();\n                break;\n            case 1:\n                ship.setTexture(\"little\"+ship.localId);\n                break;\n            case 2:\n                ship.setTexture(\"ship\"+ship.localId);\n                break;\n        }\n        this.socket.emit(websocketEvents.CHANGE_STATE, {\n            localId: ship.localId,\n            state: this.players[ship.localId].state\n        })\n    }\n\n\n    reload(data){\n        console.log(data);\n        this.players[data.localId].availableBullets = data.availableBullets;\n    }\n\n\n}"]}]}