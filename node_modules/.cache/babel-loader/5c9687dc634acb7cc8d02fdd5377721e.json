{"remainingRequest":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/babel-loader/lib/index.js!/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/eslint-loader/index.js??ref--13-0!/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/src/scenes/LobbyScene.js","dependencies":[{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/src/scenes/LobbyScene.js","mtime":1616402886749},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/cache-loader/dist/cjs.js","mtime":1610909371557},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/babel-loader/lib/index.js","mtime":1610909371562},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/eslint-loader/index.js","mtime":1610909415268}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL21lZGlhL2phY29wby9Wb2x1bWVEYXRpL0RvY3VtZW50aS9wYXBlcm8udGsvYXN0cm8ucGFwZXJvLm1lL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF9pbmhlcml0cyBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKaW1wb3J0IF9jcmVhdGVTdXBlciBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZVN1cGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzLmpzIjsKaW1wb3J0ICogYXMgUGhhc2VyIGZyb20gInBoYXNlciI7CmltcG9ydCB7IGNvbG9ycywgc2NlbmVLZXlzIH0gZnJvbSAiLi4vY29uc3RhbnRzL2NvbnN0YW50cyI7CmltcG9ydCBtaXR0IGZyb20gIm1pdHQiOwppbXBvcnQgd2Vic29ja2V0RXZlbnRzIGZyb20gIi4uL2NvbnN0YW50cy93ZWJzb2NrZXRFdmVudHMiOwp3aW5kb3cubWl0dCA9IHdpbmRvdy5taXR0IHx8IG1pdHQoKTsKCnZhciBMb2JieVNjZW5lID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfUGhhc2VyJFNjZW5lKSB7CiAgX2luaGVyaXRzKExvYmJ5U2NlbmUsIF9QaGFzZXIkU2NlbmUpOwoKICB2YXIgX3N1cGVyID0gX2NyZWF0ZVN1cGVyKExvYmJ5U2NlbmUpOwoKICBmdW5jdGlvbiBMb2JieVNjZW5lKCkgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBMb2JieVNjZW5lKTsKCiAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHsKICAgICAga2V5OiBzY2VuZUtleXMubG9iYnkKICAgIH0pOwogICAgLyp0aGlzLmxvYmJ5ID0gewogICAgICAgIHBsYXllcnM6IFtdLAogICAgICAgIGN1cnJlbnRQbGF5ZXI6IG51bGwsCiAgICAgICAgc2V0dGluZ3M6IHsKICAgICAgICAgICAgdG90YWxUdXJuczogNSwKICAgICAgICAgICAgdmVsb2NpdHk6IDIsCiAgICAgICAgICAgIGFuZ3VsYXJWZWxvY2l0eTogMiwKICAgICAgICAgICAgcmVsb2FkaW5nVmVsb2NpdHk6IDIKICAgICAgICB9CiAgICB9Ki8KCiAgICBfdGhpcy5sb2JieSA9IHsKICAgICAgcGxheWVyczogW3sKICAgICAgICBsb2NhbElkOiAwLAogICAgICAgIGNvbG9yOiAwCiAgICAgIH0sIHsKICAgICAgICBsb2NhbElkOiAxLAogICAgICAgIGNvbG9yOiAxCiAgICAgIH1dLAogICAgICBhZG1pbjogMCwKICAgICAgY3VycmVudFBsYXllcjogMSwKICAgICAgc2V0dGluZ3M6IHsKICAgICAgICB0b3RhbFR1cm5zOiA1LAogICAgICAgIHZlbG9jaXR5OiAyLAogICAgICAgIGFuZ3VsYXJWZWxvY2l0eTogMiwKICAgICAgICByZWxvYWRpbmdWZWxvY2l0eTogMgogICAgICB9CiAgICB9OwogICAgX3RoaXMubm9ybWFsaXplcnMgPSB7CiAgICAgIHZlbG9jaXR5OiAxMDAsCiAgICAgIGFuZ3VsYXJWZWxvY2l0eTogTWF0aC5QSSAvIDEyMDAsCiAgICAgIHJlbG9hZGluZ1ZlbG9jaXR5OiAxIC8gMjAwMCwKICAgICAgYnVsbGV0VmVsb2NpdHk6IDIwMAogICAgfTsKICAgIF90aGlzLnNoaXBzID0ge307CiAgICBfdGhpcy5hdmFpbGFibGVCdWxsZXRzID0gMzsKICAgIHZhciBpbnRlcnZhbDsKCiAgICB2YXIgaGFuZGxlciA9IGZ1bmN0aW9uIGhhbmRsZXIoKSB7CiAgICAgIF90aGlzLmF2YWlsYWJsZUJ1bGxldHMgPSBfdGhpcy5hdmFpbGFibGVCdWxsZXRzID49IDMgPyBfdGhpcy5hdmFpbGFibGVCdWxsZXRzIDogX3RoaXMuYXZhaWxhYmxlQnVsbGV0cyArIDE7CiAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpOwogICAgICBpbnRlcnZhbCA9IHNldEludGVydmFsKGhhbmRsZXIsIDIwMDAgLyBfdGhpcy5sb2JieS5zZXR0aW5ncy5yZWxvYWRpbmdWZWxvY2l0eSk7CiAgICB9OwoKICAgIGludGVydmFsID0gc2V0SW50ZXJ2YWwoaGFuZGxlciwgMjAwMCAvIF90aGlzLmxvYmJ5LnNldHRpbmdzLnJlbG9hZGluZ1ZlbG9jaXR5KTsKICAgIHJldHVybiBfdGhpczsKICB9CgogIF9jcmVhdGVDbGFzcyhMb2JieVNjZW5lLCBbewogICAga2V5OiAiZ2V0QW5nbGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEFuZ2xlKHgsIHkpIHsKICAgICAgdmFyIGFuZ2xlOwoKICAgICAgaWYgKHggIT09IDApIHsKICAgICAgICBhbmdsZSA9IE1hdGguYXRhbih5IC8geCk7CiAgICAgICAgYW5nbGUgPSB4IDwgMCA/IGFuZ2xlICsgTWF0aC5QSSA6IGFuZ2xlOwogICAgICB9IGVsc2UgaWYgKHkgPj0gMCkgYW5nbGUgPSBNYXRoLlBJIC8gMjtlbHNlIGlmICh5IDwgMCkgYW5nbGUgPSAtTWF0aC5QSSAvIDI7CgogICAgICByZXR1cm4gYW5nbGU7CiAgICB9CiAgfSwgewogICAga2V5OiAiY3JlYXRlTmV3U2hpcCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlTmV3U2hpcChjb2xvciwgYm91bmNlKSB7CiAgICAgIHZhciB4ID0gUGhhc2VyLk1hdGguQmV0d2VlbigwLCB0aGlzLndpZHRoKTsKICAgICAgdmFyIHkgPSBQaGFzZXIuTWF0aC5CZXR3ZWVuKDAsIHRoaXMuaGVpZ2h0KTsKICAgICAgdmFyIHNoaXAgPSB0aGlzLnBoeXNpY3MuYWRkLmltYWdlKHgsIHksICJzaGlwIiArIGNvbG9yKTsKICAgICAgdmFyIGFuZ2xlID0gUGhhc2VyLk1hdGguQmV0d2VlbihNYXRoLlBJIC8gNCwgTWF0aC5QSSAqIDMgLyA0KTsKICAgICAgc2hpcC5zZXRWZWxvY2l0eSh0aGlzLmxvYmJ5LnNldHRpbmdzLnZlbG9jaXR5ICogdGhpcy5ub3JtYWxpemVycy52ZWxvY2l0eSAqIE1hdGguY29zKGFuZ2xlKSwgdGhpcy5sb2JieS5zZXR0aW5ncy52ZWxvY2l0eSAqIHRoaXMubm9ybWFsaXplcnMudmVsb2NpdHkgKiBNYXRoLnNpbihhbmdsZSkpOwogICAgICBzaGlwLnJvdGF0aW9uID0gYW5nbGU7CiAgICAgIHNoaXAuc2V0Q29sbGlkZVdvcmxkQm91bmRzKHRydWUpOwogICAgICBpZiAoYm91bmNlKSBzaGlwLnNldEJvdW5jZSgxLCAxKTsKICAgICAgcmV0dXJuIHNoaXA7CiAgICB9CiAgfSwgewogICAga2V5OiAiZmluZFBsYXllckJ5SWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZpbmRQbGF5ZXJCeUlkKGlkKSB7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5sb2JieS5wbGF5ZXJzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKHRoaXMubG9iYnkucGxheWVyc1tpXS5sb2NhbElkID09PSBpZCkgcmV0dXJuIHRoaXMubG9iYnkucGxheWVyc1tpXTsKICAgICAgfQoKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgfSwgewogICAga2V5OiAicHJlbG9hZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcHJlbG9hZCgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICAvL2xvYWQgaW1hZ2VzCiAgICAgIHRoaXMud2lkdGggPSB0aGlzLnN5cy5nYW1lLmNhbnZhcy53aWR0aDsKICAgICAgdGhpcy5oZWlnaHQgPSB0aGlzLnN5cy5nYW1lLmNhbnZhcy5oZWlnaHQ7CiAgICAgIGNvbG9ycy5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSwgaW5kZXgpIHsKICAgICAgICBfdGhpczIubG9hZC5pbWFnZSgic2hpcCIgKyBpbmRleCwgcmVxdWlyZSgiQC9hc3NldHMvc2hpcCIgKyBpbmRleCArICIucG5nIikpOwogICAgICB9KTsKICAgICAgdGhpcy5sb2FkLmltYWdlKCJidWxsZXQiLCAiQC9hc3NldHMvYnVsbGV0LnBuZyIpOwogICAgfQogIH0sIHsKICAgIGtleTogImNyZWF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHRoaXMuc2hpcHNbIjAiXSA9IHRoaXMuY3JlYXRlTmV3U2hpcCgwLCB0cnVlKTsKICAgICAgdGhpcy5zaGlwc1siMSJdID0gdGhpcy5jcmVhdGVOZXdTaGlwKDEsIGZhbHNlKTsgLy9FdmVudCBsb2JieS1tb2RpZmllZAoKICAgICAgd2luZG93Lm1pdHQub24od2Vic29ja2V0RXZlbnRzLkxPQkJZX01PRElGSUVELCBmdW5jdGlvbiAoZ2FtZSkgewogICAgICAgIHZhciBjdXJyZW50bHlQbGF5aW5nSWRzID0gW107CiAgICAgICAgZ2FtZS5wbGF5ZXJzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikgewogICAgICAgICAgY3VycmVudGx5UGxheWluZ0lkcy5wdXNoKHBsYXllci5sb2NhbElkKTsKICAgICAgICB9KTsKICAgICAgICB2YXIgcHJldmlvdXNQbGF5aW5nSWRzID0gW107CgogICAgICAgIF90aGlzMy5sb2JieS5wbGF5ZXJzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikgewogICAgICAgICAgcHJldmlvdXNQbGF5aW5nSWRzLnB1c2gocGxheWVyLmxvY2FsSWQpOwogICAgICAgIH0pOwoKICAgICAgICBfdGhpczMubG9iYnkgPSBfb2JqZWN0U3ByZWFkKHt9LCBnYW1lKTsKICAgICAgICB2YXIgbmV3U2hpcHMgPSB7fTsKICAgICAgICBjdXJyZW50bHlQbGF5aW5nSWRzLmZvckVhY2goZnVuY3Rpb24gKGlkKSB7CiAgICAgICAgICBpZiAocHJldmlvdXNQbGF5aW5nSWRzLmluY2x1ZGVzKGlkKSkgewogICAgICAgICAgICBuZXdTaGlwc1tpZF0gPSBfdGhpczMuc2hpcHNbaWRdOwogICAgICAgICAgICBuZXdTaGlwc1tpZF0uc2V0VmVsb2NpdHkoX3RoaXMzLmxvYmJ5LnNldHRpbmdzLnZlbG9jaXR5ICogX3RoaXMzLm5vcm1hbGl6ZXJzLnZlbG9jaXR5ICogTWF0aC5jb3MobmV3U2hpcHNbaWRdLnJvdGF0aW9uKSwgX3RoaXMzLmxvYmJ5LnNldHRpbmdzLnZlbG9jaXR5ICogX3RoaXMzLm5vcm1hbGl6ZXJzLnZlbG9jaXR5ICogTWF0aC5zaW4obmV3U2hpcHNbaWRdLnJvdGF0aW9uKSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdTaGlwc1tpZF0gPSBfdGhpczMuY3JlYXRlTmV3U2hpcChfdGhpczMuZmluZFBsYXllckJ5SWQoaWQpLmNvbG9yLCBpZCAhPT0gZ2FtZS5jdXJyZW50UGxheWVyKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICBfdGhpczMuc2hpcHMgPSBuZXdTaGlwczsKICAgICAgfSk7IC8vU2V0dGluZyB1cCByb3RhdGlvbiBhbmQgc2hvb3RpbmcKCiAgICAgIHRoaXMua2V5U3BhY2UgPSB0aGlzLmlucHV0LmtleWJvYXJkLmFkZEtleShQaGFzZXIuSW5wdXQuS2V5Ym9hcmQuS2V5Q29kZXMuU1BBQ0UpOwogICAgICB0aGlzLmlucHV0LmtleWJvYXJkLm9uKCJrZXl1cC1FTlRFUiIsIGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoX3RoaXMzLmF2YWlsYWJsZUJ1bGxldHMgPiAwKSB7CiAgICAgICAgICB2YXIgYnVsbGV0ID0gX3RoaXMzLnBoeXNpY3MuYWRkLmltYWdlKF90aGlzMy5zaGlwc1tfdGhpczMubG9iYnkuY3VycmVudFBsYXllcl0ueCwgX3RoaXMzLnNoaXBzW190aGlzMy5sb2JieS5jdXJyZW50UGxheWVyXS55LCAiYnVsbGV0Iik7CgogICAgICAgICAgYnVsbGV0LnJvdGF0aW9uID0gX3RoaXMzLnNoaXBzW190aGlzMy5sb2JieS5jdXJyZW50UGxheWVyXS5yb3RhdGlvbjsKICAgICAgICAgIGJ1bGxldC5zZXRWZWxvY2l0eShfdGhpczMubG9iYnkuc2V0dGluZ3MudmVsb2NpdHkgKiBfdGhpczMubm9ybWFsaXplcnMuYnVsbGV0VmVsb2NpdHkgKiBNYXRoLmNvcyhidWxsZXQucm90YXRpb24pLCBfdGhpczMubG9iYnkuc2V0dGluZ3MudmVsb2NpdHkgKiBfdGhpczMubm9ybWFsaXplcnMuYnVsbGV0VmVsb2NpdHkgKiBNYXRoLnNpbihidWxsZXQucm90YXRpb24pKTsKICAgICAgICAgIF90aGlzMy5hdmFpbGFibGVCdWxsZXRzLS07CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJ1cGRhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZSh0aW1lLCBkZWx0YSkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIGlmIChBcnJheS5pc0FycmF5KHRoaXMubG9iYnkucGxheWVycykgJiYgdGhpcy5sb2JieS5wbGF5ZXJzLmxlbmd0aCA+IDApIHsKICAgICAgICB0aGlzLmxvYmJ5LnBsYXllcnMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7CiAgICAgICAgICBpZiAocGxheWVyLmxvY2FsSWQgIT09IF90aGlzNC5sb2JieS5jdXJyZW50UGxheWVyKSB7CiAgICAgICAgICAgIHZhciBfdGhpczQkc2hpcHMkcGxheWVyJGwgPSBfdGhpczQuc2hpcHNbcGxheWVyLmxvY2FsSWRdLmJvZHkudmVsb2NpdHksCiAgICAgICAgICAgICAgICB4ID0gX3RoaXM0JHNoaXBzJHBsYXllciRsLngsCiAgICAgICAgICAgICAgICB5ID0gX3RoaXM0JHNoaXBzJHBsYXllciRsLnk7CiAgICAgICAgICAgIF90aGlzNC5zaGlwc1twbGF5ZXIubG9jYWxJZF0ucm90YXRpb24gPSBfdGhpczQuZ2V0QW5nbGUoeCwgeSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmxvYmJ5LmN1cnJlbnRQbGF5ZXIgJiYgdGhpcy5rZXlTcGFjZS5pc0Rvd24pIHsKICAgICAgICB0aGlzLnNoaXBzW3RoaXMubG9iYnkuY3VycmVudFBsYXllcl0ucm90YXRpb24gKz0gdGhpcy5sb2JieS5zZXR0aW5ncy5hbmd1bGFyVmVsb2NpdHkgKiB0aGlzLm5vcm1hbGl6ZXJzLmFuZ3VsYXJWZWxvY2l0eSAqIGRlbHRhOwogICAgICAgIHRoaXMuc2hpcHNbdGhpcy5sb2JieS5jdXJyZW50UGxheWVyXS5zZXRWZWxvY2l0eSh0aGlzLmxvYmJ5LnNldHRpbmdzLnZlbG9jaXR5ICogdGhpcy5ub3JtYWxpemVycy52ZWxvY2l0eSAqIE1hdGguY29zKHRoaXMuc2hpcHNbdGhpcy5sb2JieS5jdXJyZW50UGxheWVyXS5yb3RhdGlvbiksIHRoaXMubG9iYnkuc2V0dGluZ3MudmVsb2NpdHkgKiB0aGlzLm5vcm1hbGl6ZXJzLnZlbG9jaXR5ICogTWF0aC5zaW4odGhpcy5zaGlwc1t0aGlzLmxvYmJ5LmN1cnJlbnRQbGF5ZXJdLnJvdGF0aW9uKSk7CiAgICAgIH0KICAgIH0KICB9XSk7CgogIHJldHVybiBMb2JieVNjZW5lOwp9KFBoYXNlci5TY2VuZSk7CgpleHBvcnQgeyBMb2JieVNjZW5lIGFzIGRlZmF1bHQgfTs="},{"version":3,"sources":["/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/src/scenes/LobbyScene.js"],"names":["Phaser","colors","sceneKeys","mitt","websocketEvents","window","LobbyScene","key","lobby","players","localId","color","admin","currentPlayer","settings","totalTurns","velocity","angularVelocity","reloadingVelocity","normalizers","Math","PI","bulletVelocity","ships","availableBullets","interval","handler","clearInterval","setInterval","x","y","angle","atan","bounce","Between","width","height","ship","physics","add","image","setVelocity","cos","sin","rotation","setCollideWorldBounds","setBounce","id","i","length","sys","game","canvas","forEach","value","index","load","require","createNewShip","on","LOBBY_MODIFIED","currentlyPlayingIds","player","push","previousPlayingIds","newShips","includes","findPlayerById","keySpace","input","keyboard","addKey","Input","Keyboard","KeyCodes","SPACE","bullet","time","delta","Array","isArray","body","getAngle","isDown","Scene"],"mappings":"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","sourcesContent":["import * as Phaser from \"phaser\";\nimport {colors, sceneKeys} from \"../constants/constants\";\nimport mitt from \"mitt\";\nimport websocketEvents from \"../constants/websocketEvents\";\n\nwindow.mitt = window.mitt || mitt();\nexport default class LobbyScene extends Phaser.Scene {\n\n    constructor() {\n        super({key: sceneKeys.lobby});\n        /*this.lobby = {\n            players: [],\n            currentPlayer: null,\n            settings: {\n                totalTurns: 5,\n                velocity: 2,\n                angularVelocity: 2,\n                reloadingVelocity: 2\n            }\n        }*/\n        this.lobby = {\n            players: [\n                {\n                    localId: 0,\n                    color: 0\n                },\n                {\n                    localId: 1,\n                    color: 1\n                }\n            ],\n            admin: 0,\n            currentPlayer: 1,\n            settings: {\n                totalTurns: 5,\n                velocity: 2,\n                angularVelocity: 2,\n                reloadingVelocity: 2\n            }\n        }\n        this.normalizers = {\n            velocity: 100,\n            angularVelocity: Math.PI/1200,\n            reloadingVelocity: 1/2000,\n            bulletVelocity: 200\n        }\n        this.ships = {};\n        this.availableBullets = 3;\n        let interval;\n        let handler = () => {\n            this.availableBullets = this.availableBullets>=3 ? this.availableBullets : this.availableBullets+1;\n            clearInterval(interval)\n            interval = setInterval(handler, 2000/this.lobby.settings.reloadingVelocity);\n        }\n        interval = setInterval(handler, 2000/this.lobby.settings.reloadingVelocity);\n    }\n\n    getAngle(x, y){\n        let angle;\n        if(x!==0) {\n            angle = Math.atan(y / x);\n            angle = x < 0 ? angle + Math.PI : angle;\n        } else if(y>=0) angle = Math.PI / 2;\n        else if(y<0) angle = -Math.PI / 2;\n        return angle;\n    }\n\n    createNewShip(color, bounce){\n        let x = Phaser.Math.Between(0, this.width);\n        let y = Phaser.Math.Between(0, this.height);\n        let ship = this.physics.add.image(x, y, \"ship\"+color);\n        let angle = Phaser.Math.Between(Math.PI/4, Math.PI*3/4);\n        ship.setVelocity(\n            this.lobby.settings.velocity*this.normalizers.velocity*Math.cos(angle),\n            this.lobby.settings.velocity*this.normalizers.velocity*Math.sin(angle)\n        );\n        ship.rotation = angle;\n        ship.setCollideWorldBounds(true);\n        if(bounce) ship.setBounce(1, 1);\n        return ship;\n    }\n\n    findPlayerById(id){\n        for(let i = 0; i < this.lobby.players.length; i++){\n            if(this.lobby.players[i].localId === id) return this.lobby.players[i];\n        }\n        return null;\n    }\n\n    preload(){\n\n        //load images\n        this.width = this.sys.game.canvas.width;\n        this.height = this.sys.game.canvas.height;\n        colors.forEach((value, index) => {\n            this.load.image(\"ship\"+index, require(\"@/assets/ship\"+index+\".png\"))\n        });\n        this.load.image(\"bullet\", \"@/assets/bullet.png\");\n\n    }\n\n    create(){\n        this.ships[\"0\"] = this.createNewShip(0, true)\n        this.ships[\"1\"] = this.createNewShip(1, false)\n\n        //Event lobby-modified\n        window.mitt.on(websocketEvents.LOBBY_MODIFIED, game => {\n            let currentlyPlayingIds = [];\n            game.players.forEach(player => {currentlyPlayingIds.push(player.localId)});\n\n            let previousPlayingIds = [];\n            this.lobby.players.forEach(player => {previousPlayingIds.push(player.localId)});\n\n            this.lobby = {...game};\n\n            let newShips = {};\n            currentlyPlayingIds.forEach(id => {\n                if(previousPlayingIds.includes(id)){\n                    newShips[id] = this.ships[id];\n                    newShips[id].setVelocity(\n                        this.lobby.settings.velocity* this.normalizers.velocity * Math.cos(newShips[id].rotation),\n                        this.lobby.settings.velocity* this.normalizers.velocity * Math.sin(newShips[id].rotation)\n                    );\n                } else {\n                    newShips[id] = this.createNewShip(this.findPlayerById(id).color, id!==game.currentPlayer);\n                }\n            });\n\n            this.ships = newShips;\n        });\n\n        //Setting up rotation and shooting\n        this.keySpace = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE);\n        this.input.keyboard.on(\"keyup-ENTER\", ()=>{\n            if(this.availableBullets>0){\n                let bullet = this.physics.add.image(\n                    this.ships[this.lobby.currentPlayer].x,\n                    this.ships[this.lobby.currentPlayer].y,\n                    \"bullet\"\n                );\n                bullet.rotation = this.ships[this.lobby.currentPlayer].rotation;\n                bullet.setVelocity(\n                    this.lobby.settings.velocity*this.normalizers.bulletVelocity*Math.cos(bullet.rotation),\n                    this.lobby.settings.velocity*this.normalizers.bulletVelocity*Math.sin(bullet.rotation)\n                );\n                this.availableBullets--;\n            }\n        });\n    }\n\n    update(time, delta){\n        if(Array.isArray(this.lobby.players) && this.lobby.players.length>0) {\n            this.lobby.players.forEach(player => {\n                if(player.localId !== this.lobby.currentPlayer) {\n                    let {x, y} = this.ships[player.localId].body.velocity;\n                    this.ships[player.localId].rotation = this.getAngle(x, y);\n                }\n            });\n        }\n        if(this.lobby.currentPlayer && this.keySpace.isDown){\n            this.ships[this.lobby.currentPlayer].rotation += this.lobby.settings.angularVelocity* this.normalizers.angularVelocity *delta;\n            this.ships[this.lobby.currentPlayer].setVelocity(\n                this.lobby.settings.velocity* this.normalizers.velocity * Math.cos(this.ships[this.lobby.currentPlayer].rotation),\n                this.lobby.settings.velocity* this.normalizers.velocity * Math.sin(this.ships[this.lobby.currentPlayer].rotation)\n            );\n        }\n    }\n}"]}]}