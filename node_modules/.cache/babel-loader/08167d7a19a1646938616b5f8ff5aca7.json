{"remainingRequest":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/babel-loader/lib/index.js!/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/eslint-loader/index.js??ref--13-0!/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/src/scenes/GameScene.js","dependencies":[{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/src/scenes/GameScene.js","mtime":1616332674738},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/cache-loader/dist/cjs.js","mtime":1610909371557},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/babel-loader/lib/index.js","mtime":1610909371562},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/eslint-loader/index.js","mtime":1610909415268}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF9pbmhlcml0cyBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKaW1wb3J0IF9jcmVhdGVTdXBlciBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZVN1cGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAqIGFzIFBoYXNlciBmcm9tICJwaGFzZXIiOwppbXBvcnQgeyBzY2VuZUtleXMgfSBmcm9tICIuLi9jb25zdGFudHMvY29uc3RhbnRzIjsKaW1wb3J0IG1pdHQgZnJvbSAibWl0dCI7Cgp2YXIgR2FtZVNjZW5lID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfUGhhc2VyJFNjZW5lKSB7CiAgX2luaGVyaXRzKEdhbWVTY2VuZSwgX1BoYXNlciRTY2VuZSk7CgogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoR2FtZVNjZW5lKTsKCiAgZnVuY3Rpb24gR2FtZVNjZW5lKCkgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBHYW1lU2NlbmUpOwoKICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgewogICAgICBrZXk6IHNjZW5lS2V5cy5nYW1lCiAgICB9KTsKICAgIF90aGlzLmFuZ3VsYXJWZWxvY2l0eSA9IE1hdGguUEkgKiAyOwogICAgX3RoaXMuc2hpcFZlbG9jaXR5ID0gMjAwOwogICAgX3RoaXMuYnVsbGV0VmVsb2NpdHkgPSA1MDA7CiAgICBfdGhpcy5wbGF5ZXJzID0gW107CiAgICBfdGhpcy5wbGF5ZXJJRCA9IG51bGw7CiAgICBfdGhpcy5lbWl0dGVyID0gbWl0dCgpOwogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEdhbWVTY2VuZSwgW3sKICAgIGtleTogInByZWxvYWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHByZWxvYWQoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdGhpcy5sb2FkLmltYWdlKCJzaGlwIiwgImh0dHBzOi8vbGFicy5waGFzZXIuaW8vYXNzZXRzL3Nwcml0ZXMvYXN0ZXJvaWRzX3NoaXAucG5nIik7CiAgICAgIHRoaXMubG9hZC5pbWFnZSgiYnVsbGV0IiwgImh0dHBzOi8vbGFicy5waGFzZXIuaW8vYXNzZXRzL3Nwcml0ZXMvYnVsbGV0LnBuZyIpOwogICAgICB0aGlzLmVtaXR0ZXIub24oImdldC1nYW1lIiwgZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICBmb3IgKHZhciBpZCA9IDA7IGlkIDwgZGF0YTsgaWQrKykgewogICAgICAgICAgdmFyIHNoaXAgPSBfdGhpczIucGh5c2ljcy5hZGQuaW1hZ2UoMCwgMCwgInNoaXAiKTsKCiAgICAgICAgICBzaGlwLnNldENvbGxpZGVXb3JsZEJvdW5kcyh0cnVlKTsKCiAgICAgICAgICBfdGhpczIucGxheWVycy5wdXNoKHsKICAgICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgICBzaGlwOiBzaGlwCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICB0aGlzLmVtaXR0ZXIub24oIm5ldy1wbGF5ZXIiLCBmdW5jdGlvbiAoaWQpIHsKICAgICAgICBjb25zb2xlLmxvZygibmV3LXBsYXllciIpOwoKICAgICAgICB2YXIgc2hpcCA9IF90aGlzMi5waHlzaWNzLmFkZC5pbWFnZSg0MDAsIDMwMCwgInNoaXAiKTsKCiAgICAgICAgc2hpcC5zZXRDb2xsaWRlV29ybGRCb3VuZHModHJ1ZSk7CgogICAgICAgIF90aGlzMi5wbGF5ZXJzLnB1c2goewogICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgc2hpcDogc2hpcAogICAgICAgIH0pOwogICAgICB9KTsKICAgICAgdGhpcy5lbWl0dGVyLm9uKCJ5b3VyLWlkIiwgZnVuY3Rpb24gKGlkKSB7CiAgICAgICAgX3RoaXMyLnBsYXllcklEID0gaWQ7CiAgICAgICAgX3RoaXMyLnBsYXllclNoaXAgPSBfdGhpczIucGh5c2ljcy5hZGQuaW1hZ2UoNDAwLCAzMDAsICJzaGlwIik7CgogICAgICAgIF90aGlzMi5wbGF5ZXJTaGlwLnNldENvbGxpZGVXb3JsZEJvdW5kcyh0cnVlKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY3JlYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGUoKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdGhpcy5lbWl0dGVyLmVtaXQoImdldC1nYW1lIik7CiAgICAgIHRoaXMuZW1pdHRlci5lbWl0KCJuZXctcGxheWVyIik7CiAgICAgIHRoaXMua2V5QSA9IHRoaXMuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KFBoYXNlci5JbnB1dC5LZXlib2FyZC5LZXlDb2Rlcy5TUEFDRSk7CiAgICAgIHRoaXMuaW5wdXQua2V5Ym9hcmQub24oImtleXVwLUVOVEVSIiwgZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBidWxsZXQgPSBfdGhpczMucGh5c2ljcy5hZGQuaW1hZ2UoX3RoaXMzLnBsYXllclNoaXAueCwgX3RoaXMzLnBsYXllclNoaXAueSwgImJ1bGxldCIpOwoKICAgICAgICBidWxsZXQucm90YXRpb24gPSBfdGhpczMucGxheWVyU2hpcC5yb3RhdGlvbiAtIE1hdGguUEkgLyAyOwogICAgICAgIHZhciB2ZWxvY2l0eVggPSBfdGhpczMuYnVsbGV0VmVsb2NpdHkgKiBNYXRoLmNvcyhfdGhpczMucGxheWVyU2hpcC5yb3RhdGlvbik7CiAgICAgICAgdmFyIHZlbG9jaXR5WSA9IF90aGlzMy5idWxsZXRWZWxvY2l0eSAqIE1hdGguc2luKF90aGlzMy5wbGF5ZXJTaGlwLnJvdGF0aW9uKTsKICAgICAgICBidWxsZXQuc2V0VmVsb2NpdHkodmVsb2NpdHlYLCB2ZWxvY2l0eVkpOwoKICAgICAgICBfdGhpczMuc29ja2V0LmVtaXQoInNob290IiwgewogICAgICAgICAgaWQ6IF90aGlzMy5wbGF5ZXJJRCwKICAgICAgICAgIHJvdGF0aW9uOiBidWxsZXQucm90YXRpb24sCiAgICAgICAgICB2ZWxvY2l0eTogewogICAgICAgICAgICB4OiB2ZWxvY2l0eVgsCiAgICAgICAgICAgIHk6IHZlbG9jaXR5WQogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgICAgdGhpcy5lbWl0dGVyLm9uKCJtb3ZlIiwgZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICBfdGhpczMucGxheWVycy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHsKICAgICAgICAgIGlmIChwbGF5ZXIuaWQgPT09IGRhdGEuaWQpIHsKICAgICAgICAgICAgcGxheWVyLnNoaXAucm90YXRpb24gPSBkYXRhLnJvdGF0aW9uOwogICAgICAgICAgICBwbGF5ZXIuc2hpcC54ID0gZGF0YS5wb3NpdGlvbi54OwogICAgICAgICAgICBwbGF5ZXIuc2hpcC55ID0gZGF0YS5wb3NpdGlvbi55OwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgICAgdGhpcy5lbWl0dGVyLm9uKCJzaG9vdCIsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgX3RoaXMzLnBsYXllcnMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7CiAgICAgICAgICBpZiAocGxheWVyLmlkID09PSBkYXRhLmlkKSB7CiAgICAgICAgICAgIHZhciBidWxsZXQgPSBfdGhpczMucGh5c2ljcy5hZGQuaW1hZ2UocGxheWVyLnNoaXAueCwgcGxheWVyLnNoaXAueSwgImJ1bGxldCIpOwoKICAgICAgICAgICAgYnVsbGV0LnJvdGF0aW9uID0gZGF0YS5yb3RhdGlvbjsKICAgICAgICAgICAgYnVsbGV0LnNldFZlbG9jaXR5KGRhdGEudmVsb2NpdHkueCwgZGF0YS52ZWxvY2l0eS55KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAidXBkYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGUodGltZSwgZGVsdGEpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICB0aGlzLnBsYXllcnMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7CiAgICAgICAgcGxheWVyLnNoaXAuc2V0VmVsb2NpdHkoX3RoaXM0LnNoaXBWZWxvY2l0eSAqIE1hdGguY29zKHBsYXllci5zaGlwLnJvdGF0aW9uKSwgX3RoaXM0LnNoaXBWZWxvY2l0eSAqIE1hdGguc2luKHBsYXllci5zaGlwLnJvdGF0aW9uKSk7CiAgICAgIH0pOwoKICAgICAgdHJ5IHsKICAgICAgICB0aGlzLnBsYXllclNoaXAuc2V0VmVsb2NpdHkodGhpcy5zaGlwVmVsb2NpdHkgKiBNYXRoLmNvcyh0aGlzLnBsYXllclNoaXAucm90YXRpb24pLCB0aGlzLnNoaXBWZWxvY2l0eSAqIE1hdGguc2luKHRoaXMucGxheWVyU2hpcC5yb3RhdGlvbikpOwogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgY29uc29sZS5sb2coZSk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmtleUEuaXNEb3duKSB7CiAgICAgICAgdGhpcy5wbGF5ZXJTaGlwLnJvdGF0aW9uICs9IHRoaXMuYW5ndWxhclZlbG9jaXR5ICogZGVsdGEgLyAxMDAwOwogICAgICAgIHRoaXMuZW1pdHRlci5lbWl0KCJtb3ZlIiwgewogICAgICAgICAgaWQ6IHRoaXMucGxheWVySUQsCiAgICAgICAgICByb3RhdGlvbjogdGhpcy5wbGF5ZXJTaGlwLnJvdGF0aW9uLAogICAgICAgICAgcG9zaXRpb246IHsKICAgICAgICAgICAgeDogdGhpcy5wbGF5ZXJTaGlwLngsCiAgICAgICAgICAgIHk6IHRoaXMucGxheWVyU2hpcC55CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9XSk7CgogIHJldHVybiBHYW1lU2NlbmU7Cn0oUGhhc2VyLlNjZW5lKTsKCmV4cG9ydCB7IEdhbWVTY2VuZSBhcyBkZWZhdWx0IH07"},{"version":3,"sources":["/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/src/scenes/GameScene.js"],"names":["Phaser","sceneKeys","mitt","GameScene","key","game","angularVelocity","Math","PI","shipVelocity","bulletVelocity","players","playerID","emitter","load","image","on","data","id","ship","physics","add","setCollideWorldBounds","push","console","log","playerShip","emit","keyA","input","keyboard","addKey","Input","Keyboard","KeyCodes","SPACE","bullet","x","y","rotation","velocityX","cos","velocityY","sin","setVelocity","socket","velocity","forEach","player","position","time","delta","e","isDown","Scene"],"mappings":"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","sourcesContent":["import * as Phaser from \"phaser\";\nimport {sceneKeys} from \"../constants/constants\";\nimport mitt from \"mitt\";\n\nexport default class GameScene extends Phaser.Scene {\n\n    constructor() {\n        super({key: sceneKeys.game});\n        this.angularVelocity = Math.PI*2;\n        this.shipVelocity = 200;\n        this.bulletVelocity = 500;\n        this.players = [];\n        this.playerID = null;\n\n        this.emitter = mitt();\n    }\n\n    preload(){\n        this.load.image(\"ship\", \"https://labs.phaser.io/assets/sprites/asteroids_ship.png\");\n        this.load.image(\"bullet\", \"https://labs.phaser.io/assets/sprites/bullet.png\");\n        this.emitter.on(\"get-game\", (data)=>{\n            for(let id= 0; id < data; id++){\n                let ship = this.physics.add.image(0, 0, \"ship\");\n                ship.setCollideWorldBounds(true);\n                this.players.push({\n                    id,\n                    ship,\n                });\n            }\n        });\n        this.emitter.on(\"new-player\", (id)=> {\n            console.log(\"new-player\")\n            let ship = this.physics.add.image(400, 300, \"ship\");\n            ship.setCollideWorldBounds(true);\n            this.players.push({\n                id,\n                ship,\n            });\n        });\n        this.emitter.on(\"your-id\", (id)=>{\n            this.playerID = id;\n            this.playerShip = this.physics.add.image(400, 300, \"ship\");\n            this.playerShip.setCollideWorldBounds(true);\n        })\n    }\n\n    create(){\n        this.emitter.emit(\"get-game\");\n        this.emitter.emit(\"new-player\");\n\n        this.keyA = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE);\n        this.input.keyboard.on(\"keyup-ENTER\", ()=>{\n            let bullet = this.physics.add.image(this.playerShip.x, this.playerShip.y, \"bullet\");\n            bullet.rotation = this.playerShip.rotation-Math.PI/2;\n            let velocityX = this.bulletVelocity*Math.cos(this.playerShip.rotation);\n            let velocityY = this.bulletVelocity*Math.sin(this.playerShip.rotation);\n            bullet.setVelocity(velocityX, velocityY);\n            this.socket.emit(\"shoot\", {\n                id: this.playerID,\n                rotation: bullet.rotation,\n                velocity: {\n                    x: velocityX,\n                    y: velocityY\n                }\n            })\n        })\n\n        this.emitter.on(\"move\", (data)=>{\n           this.players.forEach(player => {\n               if(player.id === data.id){\n                   player.ship.rotation = data.rotation;\n                   player.ship.x = data.position.x;\n                   player.ship.y = data.position.y;\n               }\n           });\n        });\n\n        this.emitter.on(\"shoot\", data => {\n            this.players.forEach(player => {\n                if(player.id === data.id){\n                    let bullet = this.physics.add.image(player.ship.x, player.ship.y, \"bullet\");\n                    bullet.rotation = data.rotation;\n                    bullet.setVelocity(data.velocity.x, data.velocity.y);\n                }\n            })\n        })\n    }\n\n    update(time, delta){\n        this.players.forEach(player => {\n            player.ship.setVelocity(this.shipVelocity*Math.cos(player.ship.rotation), this.shipVelocity*Math.sin(player.ship.rotation));\n        });\n        try {\n            this.playerShip.setVelocity(this.shipVelocity*Math.cos(this.playerShip.rotation), this.shipVelocity*Math.sin(this.playerShip.rotation));\n        } catch (e) {\n            console.log(e);\n        }\n        if(this.keyA.isDown){\n            this.playerShip.rotation += this.angularVelocity*delta/1000;\n            this.emitter.emit(\"move\", {\n                id: this.playerID,\n                rotation: this.playerShip.rotation,\n                position: {\n                    x: this.playerShip.x,\n                    y: this.playerShip.y\n                }\n            });\n        }\n    }\n}"]}]}