{"remainingRequest":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/thread-loader/dist/cjs.js!/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/babel-loader/lib/index.js!/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/eslint-loader/index.js??ref--13-0!/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/src/scenes/LobbyScene.js","dependencies":[{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/src/scenes/LobbyScene.js","mtime":1616356594899},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/cache-loader/dist/cjs.js","mtime":1610909371557},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/thread-loader/dist/cjs.js","mtime":1610909371551},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/babel-loader/lib/index.js","mtime":1610909371562},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/eslint-loader/index.js","mtime":1610909415268}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL21lZGlhL2phY29wby9Wb2x1bWVEYXRpL0RvY3VtZW50aS9wYXBlcm8udGsvYXN0cm8ucGFwZXJvLm1lL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF9pbmhlcml0cyBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKaW1wb3J0IF9jcmVhdGVTdXBlciBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZVN1cGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzLmpzIjsKaW1wb3J0ICogYXMgUGhhc2VyIGZyb20gInBoYXNlciI7CmltcG9ydCB7IGNvbG9ycywgc2NlbmVLZXlzIH0gZnJvbSAiLi4vY29uc3RhbnRzL2NvbnN0YW50cyI7CmltcG9ydCBtaXR0IGZyb20gIm1pdHQiOwppbXBvcnQgd2Vic29ja2V0RXZlbnRzIGZyb20gIi4uL2NvbnN0YW50cy93ZWJzb2NrZXRFdmVudHMiOwp3aW5kb3cubWl0dCA9IHdpbmRvdy5taXR0IHx8IG1pdHQoKTsKCnZhciBMb2JieVNjZW5lID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfUGhhc2VyJFNjZW5lKSB7CiAgX2luaGVyaXRzKExvYmJ5U2NlbmUsIF9QaGFzZXIkU2NlbmUpOwoKICB2YXIgX3N1cGVyID0gX2NyZWF0ZVN1cGVyKExvYmJ5U2NlbmUpOwoKICBmdW5jdGlvbiBMb2JieVNjZW5lKCkgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBMb2JieVNjZW5lKTsKCiAgICBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHsKICAgICAga2V5OiBzY2VuZUtleXMubG9iYnkKICAgIH0pOwogICAgX3RoaXMubG9iYnkgPSB7CiAgICAgIHBsYXllcnM6IFtdLAogICAgICBjdXJyZW50UGxheWVyOiBudWxsLAogICAgICBzZXR0aW5nczogewogICAgICAgIHRvdGFsVHVybnM6IDUsCiAgICAgICAgdmVsb2NpdHk6IDIwMCwKICAgICAgICBhbmd1bGFyVmVsb2NpdHk6IDIwMCwKICAgICAgICByZWxvYWRpbmdWZWxvY2l0eTogMjAwCiAgICAgIH0KICAgIH07CiAgICBfdGhpcy5zaGlwcyA9IHt9OwogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKExvYmJ5U2NlbmUsIFt7CiAgICBrZXk6ICJnZXRBbmdsZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0QW5nbGUoeCwgeSkgewogICAgICB2YXIgYW5nbGU7CgogICAgICBpZiAoeCAhPT0gMCkgewogICAgICAgIGFuZ2xlID0gTWF0aC5hdGFuKHkgLyB4KTsKICAgICAgICBhbmdsZSA9IHggPCAwID8gYW5nbGUgKyBNYXRoLlBJIDogYW5nbGU7CiAgICAgIH0gZWxzZSBpZiAoeSA+PSAwKSBhbmdsZSA9IE1hdGguUEkgLyAyO2Vsc2UgaWYgKHkgPCAwKSBhbmdsZSA9IC1NYXRoLlBJIC8gMjsKCiAgICAgIHJldHVybiBhbmdsZTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjcmVhdGVOZXdTaGlwIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVOZXdTaGlwKGNvbG9yKSB7CiAgICAgIHZhciB4ID0gUGhhc2VyLk1hdGguQmV0d2VlbigwLCB0aGlzLndpZHRoKTsKICAgICAgdmFyIHkgPSBQaGFzZXIuTWF0aC5CZXR3ZWVuKDAsIHRoaXMuaGVpZ2h0KTsKICAgICAgdmFyIHNoaXAgPSB0aGlzLnBoeXNpY3MuYWRkLmltYWdlKHgsIHksICJzaGlwIiArIGNvbG9yKTsKICAgICAgdmFyIGFuZ2xlID0gUGhhc2VyLk1hdGguQmV0d2VlbihNYXRoLlBJIC8gNCwgTWF0aC5QSSAqIDMgLyA0KTsKICAgICAgc2hpcC5zZXRWZWxvY2l0eSh0aGlzLmxvYmJ5LnNldHRpbmdzLnZlbG9jaXR5ICogTWF0aC5jb3MoYW5nbGUpLCB0aGlzLmxvYmJ5LnNldHRpbmdzLnZlbG9jaXR5ICogTWF0aC5zaW4oYW5nbGUpKTsKICAgICAgc2hpcC5yb3RhdGlvbiA9IGFuZ2xlOwogICAgICBzaGlwLnNldENvbGxpZGVXb3JsZEJvdW5kcyh0cnVlKTsKICAgICAgc2hpcC5zZXRCb3VuY2UoMSwgMSk7CiAgICAgIHJldHVybiBzaGlwOwogICAgfQogIH0sIHsKICAgIGtleTogImZpbmRQbGF5ZXJCeUlkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmaW5kUGxheWVyQnlJZChpZCkgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubG9iYnkucGxheWVycy5sZW5ndGg7IGkrKykgewogICAgICAgIGlmICh0aGlzLmxvYmJ5LnBsYXllcnNbaV0ubG9jYWxJZCA9PT0gaWQpIHJldHVybiB0aGlzLmxvYmJ5LnBsYXllcnNbaV07CiAgICAgIH0KCiAgICAgIHJldHVybiBudWxsOwogICAgfQogIH0sIHsKICAgIGtleTogInByZWxvYWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHByZWxvYWQoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgLy9sb2FkIGltYWdlcwogICAgICB0aGlzLndpZHRoID0gdGhpcy5zeXMuZ2FtZS5jYW52YXMud2lkdGg7CiAgICAgIHRoaXMuaGVpZ2h0ID0gdGhpcy5zeXMuZ2FtZS5jYW52YXMuaGVpZ2h0OwogICAgICBjb2xvcnMuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUsIGluZGV4KSB7CiAgICAgICAgX3RoaXMyLmxvYWQuaW1hZ2UoInNoaXAiICsgaW5kZXgsIHJlcXVpcmUoIkAvYXNzZXRzL3NoaXAiICsgaW5kZXggKyAiLnBuZyIpKTsKICAgICAgfSk7CiAgICAgIHRoaXMubG9hZC5pbWFnZSgncGFydGljbGUnLCAnaHR0cHM6Ly9sYWJzLnBoYXNlci5pby9hc3NldHMvcGFydGljbGVzL3JlZC5wbmcnKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjcmVhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZSgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICB3aW5kb3cubWl0dC5vbih3ZWJzb2NrZXRFdmVudHMuTE9CQllfTU9ESUZJRUQsIGZ1bmN0aW9uIChnYW1lKSB7CiAgICAgICAgdmFyIGN1cnJlbnRseVBsYXlpbmdJZHMgPSBbXTsKICAgICAgICBnYW1lLnBsYXllcnMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7CiAgICAgICAgICBjdXJyZW50bHlQbGF5aW5nSWRzLnB1c2gocGxheWVyLmxvY2FsSWQpOwogICAgICAgIH0pOwogICAgICAgIHZhciBwcmV2aW91c1BsYXlpbmdJZHMgPSBbXTsKCiAgICAgICAgX3RoaXMzLmxvYmJ5LnBsYXllcnMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7CiAgICAgICAgICBwcmV2aW91c1BsYXlpbmdJZHMucHVzaChwbGF5ZXIubG9jYWxJZCk7CiAgICAgICAgfSk7CgogICAgICAgIF90aGlzMy5sb2JieSA9IF9vYmplY3RTcHJlYWQoe30sIGdhbWUpOwogICAgICAgIF90aGlzMy5sb2JieS5zZXR0aW5ncy52ZWxvY2l0eSAqPSAxMDA7CiAgICAgICAgX3RoaXMzLmxvYmJ5LnNldHRpbmdzLmFuZ3VsYXJWZWxvY2l0eSAqPSAxMDA7CiAgICAgICAgX3RoaXMzLmxvYmJ5LnNldHRpbmdzLnJlbG9hZGluZ1ZlbG9jaXR5ICo9IDEwMDsKICAgICAgICB2YXIgbmV3U2hpcHMgPSB7fTsKICAgICAgICBjdXJyZW50bHlQbGF5aW5nSWRzLmZvckVhY2goZnVuY3Rpb24gKGlkKSB7CiAgICAgICAgICBpZiAocHJldmlvdXNQbGF5aW5nSWRzLmluY2x1ZGVzKGlkKSkgewogICAgICAgICAgICBuZXdTaGlwc1tpZF0gPSBfdGhpczMuc2hpcHNbaWRdOwogICAgICAgICAgICBuZXdTaGlwc1tpZF0uc2V0VmVsb2NpdHkoX3RoaXMzLmxvYmJ5LnNldHRpbmdzLnZlbG9jaXR5ICogTWF0aC5jb3MobmV3U2hpcHNbaWRdLnJvdGF0aW9uKSwgX3RoaXMzLmxvYmJ5LnNldHRpbmdzLnZlbG9jaXR5ICogTWF0aC5zaW4obmV3U2hpcHNbaWRdLnJvdGF0aW9uKSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBuZXdTaGlwc1tpZF0gPSBfdGhpczMuY3JlYXRlTmV3U2hpcChfdGhpczMuZmluZFBsYXllckJ5SWQoaWQpLmNvbG9yKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICBfdGhpczMuc2hpcHMgPSBuZXdTaGlwczsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAidXBkYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGUoKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgaWYgKEFycmF5LmlzQXJyYXkodGhpcy5sb2JieS5wbGF5ZXJzKSAmJiB0aGlzLmxvYmJ5LnBsYXllcnMubGVuZ3RoID4gMCkgewogICAgICAgIHRoaXMubG9iYnkucGxheWVycy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHsKICAgICAgICAgIHZhciBfdGhpczQkc2hpcHMkcGxheWVyJGwgPSBfdGhpczQuc2hpcHNbcGxheWVyLmxvY2FsSWRdLmJvZHkudmVsb2NpdHksCiAgICAgICAgICAgICAgeCA9IF90aGlzNCRzaGlwcyRwbGF5ZXIkbC54LAogICAgICAgICAgICAgIHkgPSBfdGhpczQkc2hpcHMkcGxheWVyJGwueTsKICAgICAgICAgIF90aGlzNC5zaGlwc1twbGF5ZXIubG9jYWxJZF0ucm90YXRpb24gPSBfdGhpczQuZ2V0QW5nbGUoeCwgeSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9XSk7CgogIHJldHVybiBMb2JieVNjZW5lOwp9KFBoYXNlci5TY2VuZSk7CgpleHBvcnQgeyBMb2JieVNjZW5lIGFzIGRlZmF1bHQgfTs="},{"version":3,"sources":["/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/src/scenes/LobbyScene.js"],"names":["Phaser","colors","sceneKeys","mitt","websocketEvents","window","LobbyScene","key","lobby","players","currentPlayer","settings","totalTurns","velocity","angularVelocity","reloadingVelocity","ships","x","y","angle","Math","atan","PI","color","Between","width","height","ship","physics","add","image","setVelocity","cos","sin","rotation","setCollideWorldBounds","setBounce","id","i","length","localId","sys","game","canvas","forEach","value","index","load","require","on","LOBBY_MODIFIED","currentlyPlayingIds","player","push","previousPlayingIds","newShips","includes","createNewShip","findPlayerById","Array","isArray","body","getAngle","Scene"],"mappings":"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","sourcesContent":["import * as Phaser from \"phaser\";\nimport {colors, sceneKeys} from \"../constants/constants\";\nimport mitt from \"mitt\";\nimport websocketEvents from \"../constants/websocketEvents\";\n\nwindow.mitt = window.mitt || mitt();\nexport default class LobbyScene extends Phaser.Scene {\n\n    constructor() {\n        super({key: sceneKeys.lobby});\n        this.lobby = {\n            players: [],\n            currentPlayer: null,\n            settings: {\n                totalTurns: 5,\n                velocity: 200,\n                angularVelocity: 200,\n                reloadingVelocity: 200\n            }\n        }\n        this.ships = {};\n    }\n\n    getAngle(x, y){\n        let angle;\n        if(x!==0) {\n            angle = Math.atan(y / x);\n            angle = x < 0 ? angle + Math.PI : angle;\n        } else if(y>=0) angle = Math.PI / 2;\n        else if(y<0) angle = -Math.PI / 2;\n        return angle;\n    }\n\n    createNewShip(color){\n        let x = Phaser.Math.Between(0, this.width);\n        let y = Phaser.Math.Between(0, this.height);\n        let ship = this.physics.add.image(x, y, \"ship\"+color);\n        let angle = Phaser.Math.Between(Math.PI/4, Math.PI*3/4);\n        ship.setVelocity(this.lobby.settings.velocity*Math.cos(angle), this.lobby.settings.velocity*Math.sin(angle));\n        ship.rotation = angle;\n        ship.setCollideWorldBounds(true);\n        ship.setBounce(1, 1);\n        return ship;\n    }\n\n    findPlayerById(id){\n        for(let i = 0; i < this.lobby.players.length; i++){\n            if(this.lobby.players[i].localId === id) return this.lobby.players[i];\n        }\n        return null;\n    }\n\n    preload(){\n\n        //load images\n        this.width = this.sys.game.canvas.width;\n        this.height = this.sys.game.canvas.height;\n        colors.forEach((value, index) => {\n            this.load.image(\"ship\"+index, require(\"@/assets/ship\"+index+\".png\"))\n        });\n        this.load.image('particle', 'https://labs.phaser.io/assets/particles/red.png');\n\n    }\n\n    create(){\n        window.mitt.on(websocketEvents.LOBBY_MODIFIED, game => {\n            let currentlyPlayingIds = [];\n            game.players.forEach(player => {currentlyPlayingIds.push(player.localId)});\n\n            let previousPlayingIds = [];\n            this.lobby.players.forEach(player => {previousPlayingIds.push(player.localId)});\n\n            this.lobby = {...game};\n\n            this.lobby.settings.velocity *= 100;\n            this.lobby.settings.angularVelocity *= 100;\n            this.lobby.settings.reloadingVelocity *= 100;\n\n            let newShips = {};\n            currentlyPlayingIds.forEach(id => {\n                if(previousPlayingIds.includes(id)){\n                    newShips[id] = this.ships[id];\n                    newShips[id].setVelocity(\n                        this.lobby.settings.velocity * Math.cos(newShips[id].rotation),\n                        this.lobby.settings.velocity * Math.sin(newShips[id].rotation)\n                    );\n                } else {\n                    newShips[id] = this.createNewShip(this.findPlayerById(id).color);\n                }\n            });\n\n            this.ships = newShips;\n        });\n    }\n\n    update(){\n        if(Array.isArray(this.lobby.players) && this.lobby.players.length>0) {\n            this.lobby.players.forEach(player => {\n                let {x, y} = this.ships[player.localId].body.velocity;\n                this.ships[player.localId].rotation = this.getAngle(x, y);\n            });\n        }\n    }\n}"]}]}