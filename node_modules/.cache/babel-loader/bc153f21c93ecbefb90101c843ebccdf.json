{"remainingRequest":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/thread-loader/dist/cjs.js!/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/babel-loader/lib/index.js!/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/eslint-loader/index.js??ref--13-0!/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/src/scenes/LobbyScene.js","dependencies":[{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/src/scenes/LobbyScene.js","mtime":1616486081259},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/cache-loader/dist/cjs.js","mtime":1610909371557},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/thread-loader/dist/cjs.js","mtime":1610909371551},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/babel-loader/lib/index.js","mtime":1610909371562},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/eslint-loader/index.js","mtime":1610909415268}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiL21lZGlhL2phY29wby9Wb2x1bWVEYXRpL0RvY3VtZW50aS9wYXBlcm8udGsvYXN0cm8ucGFwZXJvLm1lL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF9pbmhlcml0cyBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKaW1wb3J0IF9jcmVhdGVTdXBlciBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZVN1cGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmluY2x1ZGVzLmpzIjsKaW1wb3J0ICogYXMgUGhhc2VyIGZyb20gInBoYXNlciI7CmltcG9ydCB7IGNvbG9ycywgc2NlbmVLZXlzIH0gZnJvbSAiLi4vY29uc3RhbnRzL2NvbnN0YW50cyI7CmltcG9ydCB3ZWJzb2NrZXRFdmVudHMgZnJvbSAiLi4vY29uc3RhbnRzL3dlYnNvY2tldEV2ZW50cyI7Cgp2YXIgTG9iYnlTY2VuZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1BoYXNlciRTY2VuZSkgewogIF9pbmhlcml0cyhMb2JieVNjZW5lLCBfUGhhc2VyJFNjZW5lKTsKCiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihMb2JieVNjZW5lKTsKCiAgZnVuY3Rpb24gTG9iYnlTY2VuZShzb2NrZXQpIHsKICAgIHZhciBfdGhpczsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTG9iYnlTY2VuZSk7CgogICAgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCB7CiAgICAgIGtleTogc2NlbmVLZXlzLmxvYmJ5CiAgICB9KTsKICAgIF90aGlzLnNvY2tldCA9IHNvY2tldDsKICAgIF90aGlzLmxvYmJ5ID0gewogICAgICBwbGF5ZXJzOiBbXSwKICAgICAgY3VycmVudFBsYXllcjogbnVsbCwKICAgICAgc2V0dGluZ3M6IHsKICAgICAgICB0b3RhbFR1cm5zOiA1LAogICAgICAgIHZlbG9jaXR5OiAyLAogICAgICAgIGFuZ3VsYXJWZWxvY2l0eTogMiwKICAgICAgICByZWxvYWRpbmdWZWxvY2l0eTogMiwKICAgICAgICBidWxsZXRWZWxvY2l0eTogMgogICAgICB9CiAgICB9OwogICAgLyogICAgICAgIHRoaXMubG9iYnkgPSB7CiAgICAgICAgICAgICAgICBwbGF5ZXJzOiBbCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbElkOiAwLAogICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogMAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBsb2NhbElkOiAxLAogICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogMQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICBhZG1pbjogMCwKICAgICAgICAgICAgICAgIGN1cnJlbnRQbGF5ZXI6IDEsCiAgICAgICAgICAgICAgICBzZXR0aW5nczogewogICAgICAgICAgICAgICAgICAgIHRvdGFsVHVybnM6IDUsCiAgICAgICAgICAgICAgICAgICAgdmVsb2NpdHk6IDIsCiAgICAgICAgICAgICAgICAgICAgYW5ndWxhclZlbG9jaXR5OiAyLAogICAgICAgICAgICAgICAgICAgIHJlbG9hZGluZ1ZlbG9jaXR5OiAyLAogICAgICAgICAgICAgICAgICAgIGJ1bGxldFZlbG9jaXR5OiAyCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0qLwoKICAgIF90aGlzLm5vcm1hbGl6ZXJzID0gewogICAgICB2ZWxvY2l0eTogMTAwLAogICAgICBhbmd1bGFyVmVsb2NpdHk6IE1hdGguUEkgLyAxMjAwLAogICAgICByZWxvYWRpbmdWZWxvY2l0eTogMSAvIDIwMDAsCiAgICAgIGJ1bGxldFZlbG9jaXR5OiAyMDAKICAgIH07CiAgICBfdGhpcy5zaGlwcyA9IHt9OwogICAgX3RoaXMuYXZhaWxhYmxlQnVsbGV0cyA9IDM7CiAgICB2YXIgaW50ZXJ2YWw7CgogICAgdmFyIGhhbmRsZXIgPSBmdW5jdGlvbiBoYW5kbGVyKCkgewogICAgICBfdGhpcy5hdmFpbGFibGVCdWxsZXRzID0gX3RoaXMuYXZhaWxhYmxlQnVsbGV0cyA+PSAzID8gX3RoaXMuYXZhaWxhYmxlQnVsbGV0cyA6IF90aGlzLmF2YWlsYWJsZUJ1bGxldHMgKyAxOwogICAgICBjbGVhckludGVydmFsKGludGVydmFsKTsKICAgICAgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChoYW5kbGVyLCAyMDAwIC8gX3RoaXMubG9iYnkuc2V0dGluZ3MucmVsb2FkaW5nVmVsb2NpdHkpOwogICAgfTsKCiAgICBpbnRlcnZhbCA9IHNldEludGVydmFsKGhhbmRsZXIsIDIwMDAgLyBfdGhpcy5sb2JieS5zZXR0aW5ncy5yZWxvYWRpbmdWZWxvY2l0eSk7CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoTG9iYnlTY2VuZSwgW3sKICAgIGtleTogImdldEFuZ2xlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRBbmdsZSh4LCB5KSB7CiAgICAgIHZhciBhbmdsZTsKCiAgICAgIGlmICh4ICE9PSAwKSB7CiAgICAgICAgYW5nbGUgPSBNYXRoLmF0YW4oeSAvIHgpOwogICAgICAgIGFuZ2xlID0geCA8IDAgPyBhbmdsZSArIE1hdGguUEkgOiBhbmdsZTsKICAgICAgfSBlbHNlIGlmICh5ID49IDApIGFuZ2xlID0gTWF0aC5QSSAvIDI7ZWxzZSBpZiAoeSA8IDApIGFuZ2xlID0gLU1hdGguUEkgLyAyOwoKICAgICAgcmV0dXJuIGFuZ2xlOwogICAgfQogIH0sIHsKICAgIGtleTogImNyZWF0ZU5ld1NoaXAiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZU5ld1NoaXAoY29sb3IsIGJvdW5jZSkgewogICAgICB2YXIgeCA9IFBoYXNlci5NYXRoLkJldHdlZW4oMCwgdGhpcy53aWR0aCk7CiAgICAgIHZhciB5ID0gUGhhc2VyLk1hdGguQmV0d2VlbigwLCB0aGlzLmhlaWdodCk7CiAgICAgIHZhciBzaGlwID0gdGhpcy5waHlzaWNzLmFkZC5pbWFnZSh4LCB5LCAic2hpcCIgKyBjb2xvcik7CiAgICAgIHZhciBhbmdsZSA9IFBoYXNlci5NYXRoLkJldHdlZW4oTWF0aC5QSSAvIDQsIE1hdGguUEkgKiAzIC8gNCk7CiAgICAgIHNoaXAuc2V0VmVsb2NpdHkodGhpcy5sb2JieS5zZXR0aW5ncy52ZWxvY2l0eSAqIHRoaXMubm9ybWFsaXplcnMudmVsb2NpdHkgKiBNYXRoLmNvcyhhbmdsZSksIHRoaXMubG9iYnkuc2V0dGluZ3MudmVsb2NpdHkgKiB0aGlzLm5vcm1hbGl6ZXJzLnZlbG9jaXR5ICogTWF0aC5zaW4oYW5nbGUpKTsKICAgICAgc2hpcC5yb3RhdGlvbiA9IGFuZ2xlOwogICAgICBzaGlwLnNldENvbGxpZGVXb3JsZEJvdW5kcyh0cnVlKTsKICAgICAgaWYgKGJvdW5jZSkgc2hpcC5zZXRCb3VuY2UoMSwgMSk7CiAgICAgIHJldHVybiBzaGlwOwogICAgfQogIH0sIHsKICAgIGtleTogImZpbmRQbGF5ZXJCeUlkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmaW5kUGxheWVyQnlJZChpZCkgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubG9iYnkucGxheWVycy5sZW5ndGg7IGkrKykgewogICAgICAgIGlmICh0aGlzLmxvYmJ5LnBsYXllcnNbaV0ubG9jYWxJZCA9PT0gaWQpIHJldHVybiB0aGlzLmxvYmJ5LnBsYXllcnNbaV07CiAgICAgIH0KCiAgICAgIHJldHVybiBudWxsOwogICAgfQogIH0sIHsKICAgIGtleTogInByZWxvYWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHByZWxvYWQoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgLy9sb2FkIGltYWdlcwogICAgICB0aGlzLndpZHRoID0gdGhpcy5zeXMuZ2FtZS5jYW52YXMud2lkdGg7CiAgICAgIHRoaXMuaGVpZ2h0ID0gdGhpcy5zeXMuZ2FtZS5jYW52YXMuaGVpZ2h0OwogICAgICBjb2xvcnMuZm9yRWFjaChmdW5jdGlvbiAodmFsdWUsIGluZGV4KSB7CiAgICAgICAgX3RoaXMyLmxvYWQuaW1hZ2UoInNoaXAiICsgaW5kZXgsIHJlcXVpcmUoIkAvYXNzZXRzL3NoaXBzL3NoaXAiICsgaW5kZXggKyAiLnBuZyIpKTsKICAgICAgfSk7CiAgICAgIHRoaXMudGV4dHVyZXMuYWRkQmFzZTY0KCJidWxsZXQiLCByZXF1aXJlKCJAL2Fzc2V0cy9idWxsZXQucG5nIikpOwogICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBwYXJlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGxheWVycy13cmFwcGVyIik7CiAgICAgICAgdmFyIGRpbSA9IE1hdGgubWluKHBhcmVudC5vZmZzZXRXaWR0aCwgcGFyZW50Lm9mZnNldEhlaWdodCk7CgogICAgICAgIF90aGlzMi5nYW1lLnNjYWxlLnJlc2l6ZShkaW0sIGRpbSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImNyZWF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlKCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIC8vdGhpcy5zaGlwc1siMCJdID0gdGhpcy5jcmVhdGVOZXdTaGlwKDAsIHRydWUpCiAgICAgIC8vdGhpcy5zaGlwc1siMSJdID0gdGhpcy5jcmVhdGVOZXdTaGlwKDEsIGZhbHNlKQogICAgICAvL0V2ZW50IGxvYmJ5LW1vZGlmaWVkCiAgICAgIHRoaXMuc29ja2V0Lm9uKHdlYnNvY2tldEV2ZW50cy5MT0JCWV9NT0RJRklFRCwgZnVuY3Rpb24gKGdhbWUpIHsKICAgICAgICB2YXIgY3VycmVudGx5UGxheWluZ0lkcyA9IFtdOwogICAgICAgIGdhbWUucGxheWVycy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHsKICAgICAgICAgIGN1cnJlbnRseVBsYXlpbmdJZHMucHVzaChwbGF5ZXIubG9jYWxJZCk7CiAgICAgICAgfSk7CiAgICAgICAgdmFyIHByZXZpb3VzUGxheWluZ0lkcyA9IFtdOwoKICAgICAgICBfdGhpczMubG9iYnkucGxheWVycy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHsKICAgICAgICAgIHByZXZpb3VzUGxheWluZ0lkcy5wdXNoKHBsYXllci5sb2NhbElkKTsKICAgICAgICB9KTsKCiAgICAgICAgX3RoaXMzLmxvYmJ5ID0gX29iamVjdFNwcmVhZCh7fSwgZ2FtZSk7CiAgICAgICAgdmFyIG5ld1NoaXBzID0ge307CiAgICAgICAgY3VycmVudGx5UGxheWluZ0lkcy5mb3JFYWNoKGZ1bmN0aW9uIChpZCkgewogICAgICAgICAgaWYgKHByZXZpb3VzUGxheWluZ0lkcy5pbmNsdWRlcyhpZCkpIHsKICAgICAgICAgICAgbmV3U2hpcHNbaWRdID0gX3RoaXMzLnNoaXBzW2lkXTsKICAgICAgICAgICAgbmV3U2hpcHNbaWRdLnNldFZlbG9jaXR5KF90aGlzMy5sb2JieS5zZXR0aW5ncy52ZWxvY2l0eSAqIF90aGlzMy5ub3JtYWxpemVycy52ZWxvY2l0eSAqIE1hdGguY29zKG5ld1NoaXBzW2lkXS5yb3RhdGlvbiksIF90aGlzMy5sb2JieS5zZXR0aW5ncy52ZWxvY2l0eSAqIF90aGlzMy5ub3JtYWxpemVycy52ZWxvY2l0eSAqIE1hdGguc2luKG5ld1NoaXBzW2lkXS5yb3RhdGlvbikpOwogICAgICAgICAgICBuZXdTaGlwc1tpZF0uc2V0VGV4dHVyZSgic2hpcCIgKyBfdGhpczMuZmluZFBsYXllckJ5SWQoaWQpLmNvbG9yKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG5ld1NoaXBzW2lkXSA9IF90aGlzMy5jcmVhdGVOZXdTaGlwKF90aGlzMy5maW5kUGxheWVyQnlJZChpZCkuY29sb3IsIGlkICE9PSBnYW1lLmN1cnJlbnRQbGF5ZXIpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIF90aGlzMy5zaGlwcyA9IG5ld1NoaXBzOwogICAgICB9KTsgLy9TZXR0aW5nIHVwIHJvdGF0aW9uIGFuZCBzaG9vdGluZwoKICAgICAgdGhpcy5rZXlTcGFjZSA9IHRoaXMuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KFBoYXNlci5JbnB1dC5LZXlib2FyZC5LZXlDb2Rlcy5TUEFDRSk7CiAgICAgIHRoaXMuaW5wdXQua2V5Ym9hcmQub24oImtleXVwLUVOVEVSIiwgZnVuY3Rpb24gKCkgewogICAgICAgIGlmIChfdGhpczMuYXZhaWxhYmxlQnVsbGV0cyA+IDApIHsKICAgICAgICAgIHZhciBidWxsZXQgPSBfdGhpczMucGh5c2ljcy5hZGQuaW1hZ2UoX3RoaXMzLnNoaXBzW190aGlzMy5sb2JieS5jdXJyZW50UGxheWVyXS54LCBfdGhpczMuc2hpcHNbX3RoaXMzLmxvYmJ5LmN1cnJlbnRQbGF5ZXJdLnksICJidWxsZXQiKTsKCiAgICAgICAgICBidWxsZXQucm90YXRpb24gPSBfdGhpczMuc2hpcHNbX3RoaXMzLmxvYmJ5LmN1cnJlbnRQbGF5ZXJdLnJvdGF0aW9uOwogICAgICAgICAgYnVsbGV0LnNldFZlbG9jaXR5KF90aGlzMy5sb2JieS5zZXR0aW5ncy5idWxsZXRWZWxvY2l0eSAqIF90aGlzMy5ub3JtYWxpemVycy5idWxsZXRWZWxvY2l0eSAqIE1hdGguY29zKGJ1bGxldC5yb3RhdGlvbiksIF90aGlzMy5sb2JieS5zZXR0aW5ncy5idWxsZXRWZWxvY2l0eSAqIF90aGlzMy5ub3JtYWxpemVycy5idWxsZXRWZWxvY2l0eSAqIE1hdGguc2luKGJ1bGxldC5yb3RhdGlvbikpOwogICAgICAgICAgX3RoaXMzLmF2YWlsYWJsZUJ1bGxldHMtLTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInVwZGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlKHRpbWUsIGRlbHRhKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgaWYgKEFycmF5LmlzQXJyYXkodGhpcy5sb2JieS5wbGF5ZXJzKSAmJiB0aGlzLmxvYmJ5LnBsYXllcnMubGVuZ3RoID4gMCkgewogICAgICAgIHRoaXMubG9iYnkucGxheWVycy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHsKICAgICAgICAgIGlmIChwbGF5ZXIubG9jYWxJZCAhPT0gX3RoaXM0LmxvYmJ5LmN1cnJlbnRQbGF5ZXIpIHsKICAgICAgICAgICAgdmFyIF90aGlzNCRzaGlwcyRwbGF5ZXIkbCA9IF90aGlzNC5zaGlwc1twbGF5ZXIubG9jYWxJZF0uYm9keS52ZWxvY2l0eSwKICAgICAgICAgICAgICAgIHggPSBfdGhpczQkc2hpcHMkcGxheWVyJGwueCwKICAgICAgICAgICAgICAgIHkgPSBfdGhpczQkc2hpcHMkcGxheWVyJGwueTsKICAgICAgICAgICAgX3RoaXM0LnNoaXBzW3BsYXllci5sb2NhbElkXS5yb3RhdGlvbiA9IF90aGlzNC5nZXRBbmdsZSh4LCB5KTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMubG9iYnkuY3VycmVudFBsYXllciAhPT0gbnVsbCAmJiB0aGlzLmtleVNwYWNlLmlzRG93bikgewogICAgICAgIHRoaXMuc2hpcHNbdGhpcy5sb2JieS5jdXJyZW50UGxheWVyXS5yb3RhdGlvbiArPSB0aGlzLmxvYmJ5LnNldHRpbmdzLmFuZ3VsYXJWZWxvY2l0eSAqIHRoaXMubm9ybWFsaXplcnMuYW5ndWxhclZlbG9jaXR5ICogZGVsdGE7CiAgICAgICAgdGhpcy5zaGlwc1t0aGlzLmxvYmJ5LmN1cnJlbnRQbGF5ZXJdLnNldFZlbG9jaXR5KHRoaXMubG9iYnkuc2V0dGluZ3MudmVsb2NpdHkgKiB0aGlzLm5vcm1hbGl6ZXJzLnZlbG9jaXR5ICogTWF0aC5jb3ModGhpcy5zaGlwc1t0aGlzLmxvYmJ5LmN1cnJlbnRQbGF5ZXJdLnJvdGF0aW9uKSwgdGhpcy5sb2JieS5zZXR0aW5ncy52ZWxvY2l0eSAqIHRoaXMubm9ybWFsaXplcnMudmVsb2NpdHkgKiBNYXRoLnNpbih0aGlzLnNoaXBzW3RoaXMubG9iYnkuY3VycmVudFBsYXllcl0ucm90YXRpb24pKTsKICAgICAgfQogICAgfQogIH1dKTsKCiAgcmV0dXJuIExvYmJ5U2NlbmU7Cn0oUGhhc2VyLlNjZW5lKTsKCmV4cG9ydCB7IExvYmJ5U2NlbmUgYXMgZGVmYXVsdCB9Ow=="},{"version":3,"sources":["/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/src/scenes/LobbyScene.js"],"names":["Phaser","colors","sceneKeys","websocketEvents","LobbyScene","socket","key","lobby","players","currentPlayer","settings","totalTurns","velocity","angularVelocity","reloadingVelocity","bulletVelocity","normalizers","Math","PI","ships","availableBullets","interval","handler","clearInterval","setInterval","x","y","angle","atan","color","bounce","Between","width","height","ship","physics","add","image","setVelocity","cos","sin","rotation","setCollideWorldBounds","setBounce","id","i","length","localId","sys","game","canvas","forEach","value","index","load","require","textures","addBase64","window","addEventListener","parent","document","getElementById","dim","min","offsetWidth","offsetHeight","scale","resize","on","LOBBY_MODIFIED","currentlyPlayingIds","player","push","previousPlayingIds","newShips","includes","setTexture","findPlayerById","createNewShip","keySpace","input","keyboard","addKey","Input","Keyboard","KeyCodes","SPACE","bullet","time","delta","Array","isArray","body","getAngle","isDown","Scene"],"mappings":"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","sourcesContent":["import * as Phaser from \"phaser\";\nimport {colors, sceneKeys} from \"../constants/constants\";\nimport websocketEvents from \"../constants/websocketEvents\";\n\nexport default class LobbyScene extends Phaser.Scene {\n\n    constructor(socket) {\n        super({key: sceneKeys.lobby});\n        this.socket = socket;\n        this.lobby = {\n            players: [],\n            currentPlayer: null,\n            settings: {\n                totalTurns: 5,\n                velocity: 2,\n                angularVelocity: 2,\n                reloadingVelocity: 2,\n                bulletVelocity: 2\n            }\n        }\n/*        this.lobby = {\n            players: [\n                {\n                    localId: 0,\n                    color: 0\n                },\n                {\n                    localId: 1,\n                    color: 1\n                }\n            ],\n            admin: 0,\n            currentPlayer: 1,\n            settings: {\n                totalTurns: 5,\n                velocity: 2,\n                angularVelocity: 2,\n                reloadingVelocity: 2,\n                bulletVelocity: 2\n            }\n        }*/\n        this.normalizers = {\n            velocity: 100,\n            angularVelocity: Math.PI/1200,\n            reloadingVelocity: 1/2000,\n            bulletVelocity: 200\n        }\n        this.ships = {};\n        this.availableBullets = 3;\n        let interval;\n        let handler = () => {\n            this.availableBullets = this.availableBullets>=3 ? this.availableBullets : this.availableBullets+1;\n            clearInterval(interval)\n            interval = setInterval(handler, 2000/this.lobby.settings.reloadingVelocity);\n        }\n        interval = setInterval(handler, 2000/this.lobby.settings.reloadingVelocity);\n    }\n\n    getAngle(x, y){\n        let angle;\n        if(x!==0) {\n            angle = Math.atan(y / x);\n            angle = x < 0 ? angle + Math.PI : angle;\n        } else if(y>=0) angle = Math.PI / 2;\n        else if(y<0) angle = -Math.PI / 2;\n        return angle;\n    }\n\n    createNewShip(color, bounce){\n        let x = Phaser.Math.Between(0, this.width);\n        let y = Phaser.Math.Between(0, this.height);\n        let ship = this.physics.add.image(x, y, \"ship\"+color);\n        let angle = Phaser.Math.Between(Math.PI/4, Math.PI*3/4);\n        ship.setVelocity(\n            this.lobby.settings.velocity*this.normalizers.velocity*Math.cos(angle),\n            this.lobby.settings.velocity*this.normalizers.velocity*Math.sin(angle)\n        );\n        ship.rotation = angle;\n        ship.setCollideWorldBounds(true);\n        if(bounce) ship.setBounce(1, 1);\n        return ship;\n    }\n\n    findPlayerById(id){\n        for(let i = 0; i < this.lobby.players.length; i++){\n            if(this.lobby.players[i].localId === id) return this.lobby.players[i];\n        }\n        return null;\n    }\n\n    preload(){\n\n        //load images\n        this.width = this.sys.game.canvas.width;\n        this.height = this.sys.game.canvas.height;\n        colors.forEach((value, index) => {\n            this.load.image(\"ship\"+index, require(\"@/assets/ships/ship\"+index+\".png\"));\n        });\n        this.textures.addBase64(\"bullet\", require(\"@/assets/bullet.png\"));\n\n        window.addEventListener('resize', () => {\n            let parent = document.getElementById(\"players-wrapper\");\n            let dim = Math.min(parent.offsetWidth, parent.offsetHeight);\n            this.game.scale.resize(dim, dim);\n        });\n\n    }\n\n    create(){\n        //this.ships[\"0\"] = this.createNewShip(0, true)\n        //this.ships[\"1\"] = this.createNewShip(1, false)\n\n        //Event lobby-modified\n        this.socket.on(websocketEvents.LOBBY_MODIFIED, game => {\n            let currentlyPlayingIds = [];\n            game.players.forEach(player => {currentlyPlayingIds.push(player.localId)});\n\n            let previousPlayingIds = [];\n            this.lobby.players.forEach(player => {previousPlayingIds.push(player.localId)});\n\n            this.lobby = {...game};\n\n            let newShips = {};\n            currentlyPlayingIds.forEach(id => {\n                if(previousPlayingIds.includes(id)){\n                    newShips[id] = this.ships[id];\n                    newShips[id].setVelocity(\n                        this.lobby.settings.velocity* this.normalizers.velocity * Math.cos(newShips[id].rotation),\n                        this.lobby.settings.velocity* this.normalizers.velocity * Math.sin(newShips[id].rotation)\n                    );\n                    newShips[id].setTexture(\"ship\"+this.findPlayerById(id).color);\n                } else {\n                    newShips[id] = this.createNewShip(this.findPlayerById(id).color, id!==game.currentPlayer);\n                }\n            });\n\n            this.ships = newShips;\n        });\n\n        //Setting up rotation and shooting\n        this.keySpace = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE);\n        this.input.keyboard.on(\"keyup-ENTER\", ()=>{\n            if(this.availableBullets>0){\n                let bullet = this.physics.add.image(\n                    this.ships[this.lobby.currentPlayer].x,\n                    this.ships[this.lobby.currentPlayer].y,\n                    \"bullet\"\n                );\n                bullet.rotation = this.ships[this.lobby.currentPlayer].rotation;\n                bullet.setVelocity(\n                    this.lobby.settings.bulletVelocity*this.normalizers.bulletVelocity*Math.cos(bullet.rotation),\n                    this.lobby.settings.bulletVelocity*this.normalizers.bulletVelocity*Math.sin(bullet.rotation)\n                );\n                this.availableBullets--;\n            }\n        });\n    }\n\n    update(time, delta){\n        if(Array.isArray(this.lobby.players) && this.lobby.players.length>0) {\n            this.lobby.players.forEach(player => {\n                if(player.localId !== this.lobby.currentPlayer) {\n                    let {x, y} = this.ships[player.localId].body.velocity;\n                    this.ships[player.localId].rotation = this.getAngle(x, y);\n                }\n            });\n        }\n        if(this.lobby.currentPlayer!==null && this.keySpace.isDown){\n            this.ships[this.lobby.currentPlayer].rotation += this.lobby.settings.angularVelocity* this.normalizers.angularVelocity *delta;\n            this.ships[this.lobby.currentPlayer].setVelocity(\n                this.lobby.settings.velocity* this.normalizers.velocity * Math.cos(this.ships[this.lobby.currentPlayer].rotation),\n                this.lobby.settings.velocity* this.normalizers.velocity * Math.sin(this.ships[this.lobby.currentPlayer].rotation)\n            );\n        }\n    }\n}"]}]}