{"remainingRequest":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/thread-loader/dist/cjs.js!/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/babel-loader/lib/index.js!/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/eslint-loader/index.js??ref--13-0!/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/src/scenes/LobbyScene.js","dependencies":[{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/src/scenes/LobbyScene.js","mtime":1616337632421},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/cache-loader/dist/cjs.js","mtime":1610909371557},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/thread-loader/dist/cjs.js","mtime":1610909371551},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/babel-loader/lib/index.js","mtime":1610909371562},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/eslint-loader/index.js","mtime":1610909415268}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF9pbmhlcml0cyBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKaW1wb3J0IF9jcmVhdGVTdXBlciBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZVN1cGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgKiBhcyBQaGFzZXIgZnJvbSAicGhhc2VyIjsKaW1wb3J0IHsgY29sb3JzLCBzY2VuZUtleXMgfSBmcm9tICIuLi9jb25zdGFudHMvY29uc3RhbnRzIjsKaW1wb3J0IG1pdHQgZnJvbSAibWl0dCI7CmltcG9ydCB3ZWJzb2NrZXRFdmVudHMgZnJvbSAiLi4vY29uc3RhbnRzL3dlYnNvY2tldEV2ZW50cyI7Cgp2YXIgTG9iYnlTY2VuZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoX1BoYXNlciRTY2VuZSkgewogIF9pbmhlcml0cyhMb2JieVNjZW5lLCBfUGhhc2VyJFNjZW5lKTsKCiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihMb2JieVNjZW5lKTsKCiAgZnVuY3Rpb24gTG9iYnlTY2VuZShwbGF5ZXJzLCBjdXJyZW50UGxheWVyKSB7CiAgICB2YXIgX3RoaXM7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIExvYmJ5U2NlbmUpOwoKICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgewogICAgICBrZXk6IHNjZW5lS2V5cy5sb2JieQogICAgfSk7CiAgICBfdGhpcy5zaGlwVmVsb2NpdHkgPSAyMDA7CiAgICBfdGhpcy5wbGF5ZXJzID0ge307CiAgICBwbGF5ZXJzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikgewogICAgICBfdGhpcy5wbGF5ZXJzW3BsYXllci5sb2NhbElkICsgIiJdID0gcGxheWVyOwogICAgfSk7CiAgICBfdGhpcy5jdXJyZW50UGxheWVyID0gY3VycmVudFBsYXllcjsKICAgIF90aGlzLmVtaXR0ZXIgPSBtaXR0KCk7CiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoTG9iYnlTY2VuZSwgW3sKICAgIGtleTogImdldEFuZ2xlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRBbmdsZSh4LCB5KSB7CiAgICAgIHZhciBhbmdsZTsKCiAgICAgIGlmICh4ICE9PSAwKSB7CiAgICAgICAgYW5nbGUgPSBNYXRoLmF0YW4oeSAvIHgpOwogICAgICAgIGFuZ2xlID0geCA8IDAgPyBhbmdsZSArIE1hdGguUEkgOiBhbmdsZTsKICAgICAgfSBlbHNlIGlmICh5ID49IDApIGFuZ2xlID0gTWF0aC5QSSAvIDI7ZWxzZSBpZiAoeSA8IDApIGFuZ2xlID0gLU1hdGguUEkgLyAyOwoKICAgICAgcmV0dXJuIGFuZ2xlOwogICAgfQogIH0sIHsKICAgIGtleTogImNyZWF0ZU5ld1NoaXAiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZU5ld1NoaXAoY29sb3IpIHsKICAgICAgdmFyIHggPSBQaGFzZXIuTWF0aC5CZXR3ZWVuKDAsIHRoaXMud2lkdGgpOwogICAgICB2YXIgeSA9IFBoYXNlci5NYXRoLkJldHdlZW4oMCwgdGhpcy5oZWlnaHQpOwogICAgICB2YXIgc2hpcCA9IHRoaXMucGh5c2ljcy5hZGQuaW1hZ2UoeCwgeSwgInNoaXAiICsgY29sb3IpOwogICAgICB2YXIgYW5nbGUgPSBQaGFzZXIuTWF0aC5CZXR3ZWVuKE1hdGguUEkgLyA0LCBNYXRoLlBJICogMyAvIDQpOwogICAgICBzaGlwLnNldFZlbG9jaXR5KHRoaXMuc2hpcFZlbG9jaXR5ICogTWF0aC5jb3MoYW5nbGUpLCB0aGlzLnNoaXBWZWxvY2l0eSAqIE1hdGguc2luKGFuZ2xlKSk7CiAgICAgIHNoaXAucm90YXRpb24gPSBhbmdsZTsKICAgICAgc2hpcC5zZXRDb2xsaWRlV29ybGRCb3VuZHModHJ1ZSk7CiAgICAgIHNoaXAuc2V0Qm91bmNlKDEsIDEpOwogICAgfQogIH0sIHsKICAgIGtleTogInByZWxvYWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHByZWxvYWQoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdGhpcy53aWR0aCA9IHRoaXMuc3lzLmdhbWUuY2FudmFzLndpZHRoOwogICAgICB0aGlzLmhlaWdodCA9IHRoaXMuc3lzLmdhbWUuY2FudmFzLmhlaWdodDsKICAgICAgY29sb3JzLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlLCBpbmRleCkgewogICAgICAgIF90aGlzMi5sb2FkLmltYWdlKCJzaGlwIiArIGluZGV4LCByZXF1aXJlKCJAL2Fzc2V0cy9zaGlwIiArIGluZGV4ICsgIi5wbmciKSk7CiAgICAgIH0pOwogICAgICB0aGlzLmxvYWQuaW1hZ2UoJ3BhcnRpY2xlJywgJ2h0dHBzOi8vbGFicy5waGFzZXIuaW8vYXNzZXRzL3BhcnRpY2xlcy9yZWQucG5nJyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiY3JlYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGUoKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdGhpcy5wbGF5ZXJzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikgewogICAgICAgIHBsYXllci5zaGlwID0gX3RoaXMzLmNyZWF0ZU5ld1NoaXAocGxheWVyLmNvbG9yKTsKICAgICAgICAvKmlmKHBsYXllci5sb2NhbElkPT09dGhpcy5jdXJyZW50UGxheWVyKSB7CiAgICAgICAgICAgIGxldCBwYXJ0aWNsZSA9IHRoaXMuYWRkLnBhcnRpY2xlcygicGFydGljbGUiKTsKICAgICAgICAgICAgbGV0IGVtaXR0ZXIgPSBwYXJ0aWNsZS5jcmVhdGVFbWl0dGVyKHsKICAgICAgICAgICAgICAgIHNwZWVkOiAxMDAsCiAgICAgICAgICAgICAgICBzY2FsZToge3N0YXJ0OiAwLjMsIGVuZDogMH0sCiAgICAgICAgICAgICAgICBibGVuZE1vZGU6ICJBREQiCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBlbWl0dGVyLnN0YXJ0Rm9sbG93KHRoaXMuc2hpcHNbcGxheWVyLmxvY2FsSWQrIiJdKTsKICAgICAgICB9Ki8KICAgICAgfSk7CiAgICAgIHRoaXMuZW1pdHRlci5vbih3ZWJzb2NrZXRFdmVudHMuTE9CQllfTU9ESUZJRUQsIGZ1bmN0aW9uIChnYW1lKSB7CiAgICAgICAgX3RoaXMzLmN1cnJlbnRQbGF5ZXIgPSBnYW1lLmN1cnJlbnRQbGF5ZXI7CiAgICAgICAgX3RoaXMzLnNoaXBWZWxvY2l0eSA9IGdhbWUuc2V0dGluZ3MudmVsb2NpdHk7CgogICAgICAgIHZhciBwcmV2aW91c0lkcyA9IF90aGlzMy5wbGF5ZXJzLmtleXMoKTsKCiAgICAgICAgdmFyIG5ld0lkcyA9IFtdOwogICAgICAgIGdhbWUucGxheWVycy5mb3JFYWNoKGZ1bmN0aW9uIChuZXdQbGF5ZXIpIHsKICAgICAgICAgIG5ld0lkcy5wdXNoKG5ld1BsYXllci5sb2NhbElkKTsKCiAgICAgICAgICBpZiAocHJldmlvdXNJZHMuaW5jbHVkZXMobmV3UGxheWVyLmxvY2FsSWQgKyAiIikgJiYgX3RoaXMzLnBsYXllcnNbbmV3UGxheWVyLmxvY2FsSWQgKyAiIl0uY29sb3IgIT09IG5ld1BsYXllci5jb2xvcikgewogICAgICAgICAgICBfdGhpczMucGxheWVyc1tuZXdQbGF5ZXIubG9jYWxJZCArICIiXS5jb2xvciA9IG5ld1BsYXllci5jb2xvcjsKCiAgICAgICAgICAgIF90aGlzMy5wbGF5ZXJzW25ld1BsYXllci5sb2NhbElkICsgIiJdLnNoaXAuc2V0VGV4dHVyZSgic2hpcCIgKyBuZXdQbGF5ZXIuY29sb3IpOwogICAgICAgICAgfSBlbHNlIGlmICghcHJldmlvdXNJZHMuaW5jbHVkZXMobmV3UGxheWVyLmxvY2FsSWQgKyAiIikpIHsKICAgICAgICAgICAgX3RoaXMzLnBsYXllcnNbbmV3UGxheWVyLmxvY2FsSWQgKyAiIl0gPSBuZXdQbGF5ZXI7CiAgICAgICAgICAgIF90aGlzMy5wbGF5ZXJzW25ld1BsYXllci5sb2NhbElkICsgIiJdLnNoaXAgPSBfdGhpczMuY3JlYXRlTmV3U2hpcChuZXdQbGF5ZXIuY29sb3IpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgIHZhciBkaWZmZXJlbmNlID0gcHJldmlvdXNJZHMuZmlsdGVyKGZ1bmN0aW9uICh4KSB7CiAgICAgICAgICByZXR1cm4gIW5ld0lkcy5pbmNsdWRlcyh4KTsKICAgICAgICB9KTsKICAgICAgICBkaWZmZXJlbmNlLmZvckVhY2goZnVuY3Rpb24gKGlkKSB7CiAgICAgICAgICBfdGhpczMucGxheWVyc1tpZF0uc2hpcC5yZW1vdmVkRnJvbVNjZW5lKCk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInVwZGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlKCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHRoaXMucGxheWVycy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHsKICAgICAgICB2YXIgX3BsYXllciRzaGlwJGJvZHkkdmVsID0gcGxheWVyLnNoaXAuYm9keS52ZWxvY2l0eSwKICAgICAgICAgICAgeCA9IF9wbGF5ZXIkc2hpcCRib2R5JHZlbC54LAogICAgICAgICAgICB5ID0gX3BsYXllciRzaGlwJGJvZHkkdmVsLnk7CiAgICAgICAgcGxheWVyLnNoaXAucm90YXRpb24gPSBfdGhpczQuZ2V0QW5nbGUoeCwgeSk7CiAgICAgICAgcGxheWVyLnNoaXAuc2V0VmVsb2NpdHkoX3RoaXM0LnNoaXBWZWxvY2l0eSAqIE1hdGguY29zKHBsYXllci5zaGlwLnJvdGF0aW9uKSwgX3RoaXM0LnNoaXBWZWxvY2l0eSAqIE1hdGguc2luKHBsYXllci5zaGlwLnJvdGF0aW9uKSk7CiAgICAgIH0pOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIExvYmJ5U2NlbmU7Cn0oUGhhc2VyLlNjZW5lKTsKCmV4cG9ydCB7IExvYmJ5U2NlbmUgYXMgZGVmYXVsdCB9Ow=="},{"version":3,"sources":["/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/src/scenes/LobbyScene.js"],"names":["Phaser","colors","sceneKeys","mitt","websocketEvents","LobbyScene","players","currentPlayer","key","lobby","shipVelocity","forEach","player","localId","emitter","x","y","angle","Math","atan","PI","color","Between","width","height","ship","physics","add","image","setVelocity","cos","sin","rotation","setCollideWorldBounds","setBounce","sys","game","canvas","value","index","load","require","createNewShip","on","LOBBY_MODIFIED","settings","velocity","previousIds","keys","newIds","newPlayer","push","includes","setTexture","difference","filter","id","removedFromScene","body","getAngle","Scene"],"mappings":"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","sourcesContent":["import * as Phaser from \"phaser\";\nimport {colors, sceneKeys} from \"../constants/constants\";\nimport mitt from \"mitt\";\nimport websocketEvents from \"../constants/websocketEvents\";\n\nexport default class LobbyScene extends Phaser.Scene {\n\n    constructor(players, currentPlayer) {\n        super({key: sceneKeys.lobby});\n        this.shipVelocity = 200;\n        this.players = {};\n        players.forEach(player => {\n            this.players[player.localId+\"\"] = player;\n        })\n        this.currentPlayer = currentPlayer;\n        this.emitter = mitt();\n    }\n\n    getAngle(x, y){\n        let angle;\n        if(x!==0) {\n            angle = Math.atan(y / x);\n            angle = x < 0 ? angle + Math.PI : angle;\n        } else if(y>=0) angle = Math.PI / 2;\n        else if(y<0) angle = -Math.PI / 2;\n        return angle;\n    }\n\n    createNewShip(color){\n        let x = Phaser.Math.Between(0, this.width);\n        let y = Phaser.Math.Between(0, this.height);\n        let ship = this.physics.add.image(x, y, \"ship\"+color);\n        let angle = Phaser.Math.Between(Math.PI/4, Math.PI*3/4);\n        ship.setVelocity(this.shipVelocity*Math.cos(angle), this.shipVelocity*Math.sin(angle));\n        ship.rotation = angle;\n        ship.setCollideWorldBounds(true);\n        ship.setBounce(1, 1);\n    }\n\n    preload(){\n        this.width = this.sys.game.canvas.width;\n        this.height = this.sys.game.canvas.height;\n\n        colors.forEach((value, index) => {\n            this.load.image(\"ship\"+index, require(\"@/assets/ship\"+index+\".png\"))\n        });\n        this.load.image('particle', 'https://labs.phaser.io/assets/particles/red.png');\n    }\n\n    create(){\n        this.players.forEach(player => {\n            player.ship = this.createNewShip(player.color);\n            /*if(player.localId===this.currentPlayer) {\n                let particle = this.add.particles(\"particle\");\n                let emitter = particle.createEmitter({\n                    speed: 100,\n                    scale: {start: 0.3, end: 0},\n                    blendMode: \"ADD\"\n                });\n                emitter.startFollow(this.ships[player.localId+\"\"]);\n            }*/\n        });\n\n        this.emitter.on(websocketEvents.LOBBY_MODIFIED, game => {\n            this.currentPlayer = game.currentPlayer;\n            this.shipVelocity = game.settings.velocity;\n            let previousIds = this.players.keys();\n            let newIds = [];\n            game.players.forEach(newPlayer => {\n                newIds.push(newPlayer.localId);\n                if( previousIds.includes(newPlayer.localId+\"\") &&\n                    this.players[newPlayer.localId+\"\"].color !== newPlayer.color){\n\n                    this.players[newPlayer.localId+\"\"].color = newPlayer.color;\n                    this.players[newPlayer.localId+\"\"].ship.setTexture(\"ship\"+newPlayer.color);\n\n                } else if( !previousIds.includes(newPlayer.localId+\"\") ){\n                    this.players[newPlayer.localId+\"\"] = newPlayer;\n                    this.players[newPlayer.localId+\"\"].ship = this.createNewShip(newPlayer.color);\n                }\n            });\n            let difference = previousIds.filter(x => !newIds.includes(x));\n            difference.forEach(id => {\n                this.players[id].ship.removedFromScene();\n            });\n        });\n    }\n\n    update(){\n        this.players.forEach(player =>{\n            let {x, y} = player.ship.body.velocity;\n            player.ship.rotation = this.getAngle(x, y);\n            player.ship.setVelocity(\n                this.shipVelocity*Math.cos(player.ship.rotation),\n                this.shipVelocity*Math.sin(player.ship.rotation));\n        })\n    }\n}"]}]}