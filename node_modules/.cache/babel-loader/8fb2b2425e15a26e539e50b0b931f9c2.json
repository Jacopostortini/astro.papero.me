{"remainingRequest":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/thread-loader/dist/cjs.js!/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/babel-loader/lib/index.js!/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/eslint-loader/index.js??ref--13-0!/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/src/MainScene.js","dependencies":[{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/src/MainScene.js","mtime":1616149482964},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/cache-loader/dist/cjs.js","mtime":1610909371557},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/thread-loader/dist/cjs.js","mtime":1610909371551},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/babel-loader/lib/index.js","mtime":1610909371562},{"path":"/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/node_modules/eslint-loader/index.js","mtime":1610909415268}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF9pbmhlcml0cyBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKaW1wb3J0IF9jcmVhdGVTdXBlciBmcm9tICIvbWVkaWEvamFjb3BvL1ZvbHVtZURhdGkvRG9jdW1lbnRpL3BhcGVyby50ay9hc3Ryby5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZVN1cGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaC5qcyI7CmltcG9ydCAqIGFzIFBoYXNlciBmcm9tICJwaGFzZXIiOwppbXBvcnQgaW8gZnJvbSAic29ja2V0LmlvLWNsaWVudCI7Cgp2YXIgTWFpblNjZW5lID0gLyojX19QVVJFX18qL2Z1bmN0aW9uIChfUGhhc2VyJFNjZW5lKSB7CiAgX2luaGVyaXRzKE1haW5TY2VuZSwgX1BoYXNlciRTY2VuZSk7CgogIHZhciBfc3VwZXIgPSBfY3JlYXRlU3VwZXIoTWFpblNjZW5lKTsKCiAgZnVuY3Rpb24gTWFpblNjZW5lKCkgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBNYWluU2NlbmUpOwoKICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgewogICAgICBrZXk6ICJNYWluIgogICAgfSk7CiAgICBfdGhpcy5hbmd1bGFyVmVsb2NpdHkgPSBNYXRoLlBJICogMjsKICAgIF90aGlzLnZlbG9jaXR5ID0gMjAwOwogICAgX3RoaXMuc29ja2V0ID0gaW8oImh0dHBzOi8vcGFwZXJvLm1lIiwgewogICAgICBwYXRoOiAiL3NlcnZlci9hc3Ryby9zb2NrZXQuaW8iLAogICAgICBhdXRvQ29ubmVjdDogdHJ1ZQogICAgfSk7CgogICAgX3RoaXMuc29ja2V0Lm9uKCJjb25uZWN0IiwgZnVuY3Rpb24gKCkgewogICAgICBjb25zb2xlLmxvZygiY29ubmVjdGVkIik7CiAgICB9KTsKCiAgICByZXR1cm4gX3RoaXM7CiAgfQoKICBfY3JlYXRlQ2xhc3MoTWFpblNjZW5lLCBbewogICAga2V5OiAicHJlbG9hZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcHJlbG9hZCgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB0aGlzLmxvYWQuaW1hZ2UoInNoaXAiLCAiaHR0cDovL2xhYnMucGhhc2VyLmlvL2Fzc2V0cy9zcHJpdGVzL2FzdGVyb2lkc19zaGlwLnBuZyIpOwogICAgICB0aGlzLnNvY2tldC5lbWl0KCJnZXQtZ2FtZSIsIGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgX3RoaXMyLnBsYXllcnMgPSBbXTsKCiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLnBsYXllcnMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIF90aGlzMi5wbGF5ZXJzLnB1c2goewogICAgICAgICAgICBpZDogZGF0YS5wbGF5ZXJzW2ldLmlkLAogICAgICAgICAgICBwb3NpdGlvbjogZGF0YS5wbGF5ZXJzW2ldLnBvc2l0aW9uLAogICAgICAgICAgICByb3RhdGlvbjogZGF0YS5wbGF5ZXJzW2ldLnJvdGF0aW9uCiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIF90aGlzMi5zb2NrZXQuZW1pdCgibmV3LXBsYXllciIpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJjcmVhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZSgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICB0aGlzLnBsYXllcnMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7CiAgICAgICAgcGxheWVyLnNoaXAgPSBfdGhpczMucGh5c2ljcy5hZGQuaW1hZ2UocGxheWVyLnBvc2l0aW9uLngsIHBsYXllci5wb3NpdGlvbi55LCAic2hpcCIpOwogICAgICAgIHBsYXllci5zaGlwLnJvdGF0aW9uID0gcGxheWVyLnJvdGF0aW9uOwogICAgICAgIHBsYXllci5zaGlwLnNldENvbGxpZGVXb3JsZEJvdW5kcyh0cnVlKTsKICAgICAgfSk7CiAgICAgIHRoaXMua2V5QSA9IHRoaXMuaW5wdXQua2V5Ym9hcmQuYWRkS2V5KFBoYXNlci5JbnB1dC5LZXlib2FyZC5LZXlDb2Rlcy5BKTsKICAgICAgdGhpcy5zb2NrZXQub24oIm1vdmUiLCBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIF90aGlzMy5wbGF5ZXJzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllcikgewogICAgICAgICAgaWYgKHBsYXllci5pZCA9PT0gZGF0YS5pZCkgewogICAgICAgICAgICBwbGF5ZXIuc2hpcC5yb3RhdGlvbiA9IGRhdGEucm90YXRpb247CiAgICAgICAgICAgIHBsYXllci5zaGlwLnggPSBkYXRhLnBvc2l0aW9uLng7CiAgICAgICAgICAgIHBsYXllci5zaGlwLnkgPSBkYXRhLnBvc2l0aW9uLnk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgICB0aGlzLnNvY2tldC5vbigibmV3LXBsYXllciIsIGZ1bmN0aW9uIChpZCkgewogICAgICAgIF90aGlzMy5wbGF5ZXJJRCA9IGlkOwoKICAgICAgICBfdGhpczMucGxheWVycy5wdXNoKHsKICAgICAgICAgIGlkOiBpZCwKICAgICAgICAgIHBvc2l0aW9uOiB7CiAgICAgICAgICAgIHg6IDMwMCwKICAgICAgICAgICAgeTogNDAwCiAgICAgICAgICB9LAogICAgICAgICAgcm90YXRpb246IDAKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAidXBkYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGUodGltZSwgZGVsdGEpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICB0aGlzLnBsYXllcnMuZm9yRWFjaChmdW5jdGlvbiAocGxheWVyKSB7CiAgICAgICAgaWYgKHBsYXllci5pZCA9PT0gX3RoaXM0LnBsYXllcklEKSB7CiAgICAgICAgICBpZiAoX3RoaXM0LmtleUEuaXNEb3duKSB7CiAgICAgICAgICAgIHBsYXllci5zaGlwLnJvdGF0aW9uICs9IF90aGlzNC5hbmd1bGFyVmVsb2NpdHkgKiBkZWx0YSAvIDEwMDA7CgogICAgICAgICAgICBfdGhpczQuc29ja2V0LmVtaXQoIm1vdmUiLCB7CiAgICAgICAgICAgICAgcGxheWVyOiBfdGhpczQucGxheWVySUQsCiAgICAgICAgICAgICAgcm90YXRpb246IHBsYXllci5zaGlwLnJvdGF0aW9uLAogICAgICAgICAgICAgIHBvc2l0aW9uOiB7CiAgICAgICAgICAgICAgICB4OiBwbGF5ZXIuc2hpcC54LAogICAgICAgICAgICAgICAgeTogcGxheWVyLnNoaXAueQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBwbGF5ZXIuc2hpcC5zZXRWZWxvY2l0eShfdGhpczQudmVsb2NpdHkgKiBNYXRoLmNvcyhwbGF5ZXIuc2hpcC5yb3RhdGlvbiksIHBsYXllci52ZWxvY2l0eSAqIE1hdGguc2luKHBsYXllci5zaGlwLnJvdGF0aW9uKSk7CiAgICAgIH0pOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIE1haW5TY2VuZTsKfShQaGFzZXIuU2NlbmUpOwoKZXhwb3J0IHsgTWFpblNjZW5lIGFzIGRlZmF1bHQgfTs="},{"version":3,"sources":["/media/jacopo/VolumeDati/Documenti/papero.tk/astro.papero.me/src/MainScene.js"],"names":["Phaser","io","MainScene","key","angularVelocity","Math","PI","velocity","socket","path","autoConnect","on","console","log","load","image","emit","data","players","i","length","push","id","position","rotation","forEach","player","ship","physics","add","x","y","setCollideWorldBounds","keyA","input","keyboard","addKey","Input","Keyboard","KeyCodes","A","playerID","time","delta","isDown","setVelocity","cos","sin","Scene"],"mappings":"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","sourcesContent":["import * as Phaser from \"phaser\";\nimport io from \"socket.io-client\";\n\nexport default class MainScene extends Phaser.Scene {\n\n    constructor() {\n        super({key: \"Main\"});\n        this.angularVelocity = Math.PI*2;\n        this.velocity = 200;\n        this.socket = io(\"https://papero.me\", {\n            path: \"/server/astro/socket.io\",\n            autoConnect: true\n        });\n        this.socket.on(\"connect\", ()=>{\n            console.log(\"connected\");\n        });\n    }\n\n    preload(){\n        this.load.image(\"ship\", \"http://labs.phaser.io/assets/sprites/asteroids_ship.png\");\n        this.socket.emit(\"get-game\", (data)=>{\n           this.players = [];\n           for(let i= 0; i < data.players.length; i++){\n               this.players.push({\n                   id: data.players[i].id,\n                   position: data.players[i].position,\n                   rotation: data.players[i].rotation\n               });\n           }\n            this.socket.emit(\"new-player\");\n        });\n    }\n\n    create(){\n        this.players.forEach((player)=>{\n            player.ship = this.physics.add.image(player.position.x, player.position.y, \"ship\");\n            player.ship.rotation = player.rotation;\n            player.ship.setCollideWorldBounds(true);\n        })\n        this.keyA = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A);\n        this.socket.on(\"move\", (data)=>{\n           this.players.forEach(player => {\n               if(player.id === data.id){\n                   player.ship.rotation = data.rotation;\n                   player.ship.x  = data.position.x;\n                   player.ship.y = data.position.y;\n               }\n           });\n        });\n        this.socket.on(\"new-player\", (id)=> {\n            this.playerID = id;\n            this.players.push({\n                id: id,\n                position: {\n                    x: 300,\n                    y: 400\n                },\n                rotation: 0\n            });\n        });\n    }\n\n    update(time, delta){\n        this.players.forEach(player => {\n            if(player.id === this.playerID){\n                if(this.keyA.isDown){\n                    player.ship.rotation += this.angularVelocity*delta/1000;\n                    this.socket.emit(\"move\", {\n                        player: this.playerID,\n                        rotation: player.ship.rotation,\n                        position: {\n                            x: player.ship.x,\n                            y: player.ship.y\n                        }\n                    });\n                }\n            }\n            player.ship.setVelocity(this.velocity*Math.cos(player.ship.rotation), player.velocity*Math.sin(player.ship.rotation));\n        });\n    }\n}"]}]}