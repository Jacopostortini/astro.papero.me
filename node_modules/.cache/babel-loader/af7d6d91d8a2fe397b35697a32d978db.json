{"remainingRequest":"C:\\Users\\matte\\Desktop\\papero\\cosmos.papero.me\\node_modules\\thread-loader\\dist\\cjs.js!C:\\Users\\matte\\Desktop\\papero\\cosmos.papero.me\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\matte\\Desktop\\papero\\cosmos.papero.me\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\matte\\Desktop\\papero\\cosmos.papero.me\\src\\phaser\\RankingScene.js","dependencies":[{"path":"C:\\Users\\matte\\Desktop\\papero\\cosmos.papero.me\\src\\phaser\\RankingScene.js","mtime":1618302275351},{"path":"C:\\Users\\matte\\Desktop\\papero\\cosmos.papero.me\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1618302247254},{"path":"C:\\Users\\matte\\Desktop\\papero\\cosmos.papero.me\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1618302273214},{"path":"C:\\Users\\matte\\Desktop\\papero\\cosmos.papero.me\\node_modules\\babel-loader\\lib\\index.js","mtime":1618302246598},{"path":"C:\\Users\\matte\\Desktop\\papero\\cosmos.papero.me\\node_modules\\eslint-loader\\index.js","mtime":1618302253346}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJDOi9Vc2Vycy9tYXR0ZS9EZXNrdG9wL3BhcGVyby9jb3Ntb3MucGFwZXJvLm1lL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiQzovVXNlcnMvbWF0dGUvRGVza3RvcC9wYXBlcm8vY29zbW9zLnBhcGVyby5tZS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIkM6L1VzZXJzL21hdHRlL0Rlc2t0b3AvcGFwZXJvL2Nvc21vcy5wYXBlcm8ubWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKaW1wb3J0IF9jcmVhdGVTdXBlciBmcm9tICJDOi9Vc2Vycy9tYXR0ZS9EZXNrdG9wL3BhcGVyby9jb3Ntb3MucGFwZXJvLm1lL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVTdXBlciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm51bWJlci50by1maXhlZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5tYXRoLnNpZ24uanMiOwppbXBvcnQgUGhhc2VyIGZyb20gInBoYXNlciI7CmltcG9ydCB7IGdhbWVEaW1lbnNpb25zLCBzY2VuZUtleXMgfSBmcm9tICIuLi9jb25zdGFudHMvZ2FtZVNldHRpbmdzIjsKaW1wb3J0IHdlYnNvY2tldEV2ZW50cyBmcm9tICIuLi9jb25zdGFudHMvd2Vic29ja2V0RXZlbnRzIjsKaW1wb3J0IF8gZnJvbSAibG9kYXNoIjsKCnZhciBSYW5raW5nU2NlbmUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKF9QaGFzZXIkU2NlbmUpIHsKICBfaW5oZXJpdHMoUmFua2luZ1NjZW5lLCBfUGhhc2VyJFNjZW5lKTsKCiAgdmFyIF9zdXBlciA9IF9jcmVhdGVTdXBlcihSYW5raW5nU2NlbmUpOwoKICBmdW5jdGlvbiBSYW5raW5nU2NlbmUoc29ja2V0LCBwb2ludHNUb1dpbikgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBSYW5raW5nU2NlbmUpOwoKICAgIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgewogICAgICBrZXk6IHNjZW5lS2V5cy5yYW5raW5nCiAgICB9KTsKICAgIF90aGlzLnNvY2tldCA9IHNvY2tldDsKICAgIF90aGlzLnBvaW50c1RvV2luID0gcG9pbnRzVG9XaW47CiAgICBfdGhpcy5zcGVlZCA9IDMwMDsKICAgIF90aGlzLmFuZ3VsYXJTcGVlZCA9IDEyMDA7CgogICAgX3RoaXMuc29ja2V0Lm9uKHdlYnNvY2tldEV2ZW50cy5TVEFSVF9UVVJOLCBmdW5jdGlvbiAoZ2FtZSkgewogICAgICBfdGhpcy5zY2VuZS5zdGFydChzY2VuZUtleXMuZ2FtZSwgXy5jbG9uZURlZXAoZ2FtZSkpOwogICAgfSk7CgogICAgcmV0dXJuIF90aGlzOwogIH0KCiAgX2NyZWF0ZUNsYXNzKFJhbmtpbmdTY2VuZSwgW3sKICAgIGtleTogImluaXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGluaXQoZGF0YSkgewogICAgICBjb25zb2xlLmxvZyhfLmNsb25lRGVlcChkYXRhKSk7CiAgICAgIHRoaXMucGxheWVycyA9IF8uY2xvbmVEZWVwKGRhdGEucGxheWVycyk7CiAgICAgIHRoaXMudGltZXIgPSBkYXRhLnRpbWVyID8gZGF0YS50aW1lciA6IEluZmluaXR5OwogICAgICB0aGlzLmJhbmRXaWR0aCA9IGdhbWVEaW1lbnNpb25zLndpZHRoIC8gKHRoaXMucG9pbnRzVG9XaW4gKyAxKTsKICAgICAgdGhpcy5saW5lSGVpZ2h0ID0gZ2FtZURpbWVuc2lvbnMuaGVpZ2h0IC8gdGhpcy5wbGF5ZXJzLmxlbmd0aDsKICAgICAgdGhpcy5wbGF5ZXJzU3RvcHBlZCA9IDA7CiAgICB9CiAgfSwgewogICAga2V5OiAicHJlbG9hZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcHJlbG9hZCgpIHsKICAgICAgdGhpcy5sb2FkLmltYWdlKCJzaGlwMCIsICIuL3NoaXBzL3NoaXAwLnBuZyIpOwogICAgICB0aGlzLmxvYWQuaW1hZ2UoInNoaXAxIiwgIi4vc2hpcHMvc2hpcDEucG5nIik7CiAgICAgIHRoaXMubG9hZC5pbWFnZSgic2hpcDIiLCAiLi9zaGlwcy9zaGlwMi5wbmciKTsKICAgICAgdGhpcy5sb2FkLmltYWdlKCJzaGlwMyIsICIuL3NoaXBzL3NoaXAzLnBuZyIpOwogICAgfQogIH0sIHsKICAgIGtleTogImNyZWF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHRoaXMuZHJhd0ZpbmlzaExpbmUoKTsKICAgICAgdGhpcy5jcmVhdGVTaGlwcygpOwogICAgICB0aGlzLnNldFNoaXBzTW92ZW1lbnRzKCk7CiAgICAgIHRoaXMudGltZXJUZXh0ID0gdGhpcy5hZGQudGV4dChnYW1lRGltZW5zaW9ucy53aWR0aCAvIDIsIDIwLCAoKHRoaXMudGltZXIgLSBEYXRlLm5vdygpKSAvIDEwMDApLnRvRml4ZWQoMCksIHsKICAgICAgICBmb250U2l6ZTogMzAKICAgICAgfSk7CiAgICAgIHRoaXMudGltZXJUZXh0LnNldE9yaWdpbigwLjUpOwogICAgICB0aGlzLnNjZW5lLnBhdXNlKCk7CiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzMi5zY2VuZS5yZXN1bWUoKTsKICAgICAgfSwgMTAwMCk7CiAgICB9CiAgfSwgewogICAga2V5OiAidXBkYXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGUoKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdmFyIHRleHQgPSB0aGlzLnRpbWVyID09PSBJbmZpbml0eSA/ICJHYW1lIG92ZXIgKEY1IHRvIHJlc3RhcnQpIiA6ICgodGhpcy50aW1lciAtIERhdGUubm93KCkpIC8gMTAwMCkudG9GaXhlZCgwKTsKICAgICAgdGhpcy50aW1lclRleHQuc2V0VGV4dCh0ZXh0KTsKCiAgICAgIGlmICh0aGlzLnRpbWVyIDwgRGF0ZS5ub3coKSkgewogICAgICAgIGNvbnNvbGUubG9nKCJ0aW1lb3V0Iik7CiAgICAgICAgdGhpcy5zb2NrZXQuZW1pdCh3ZWJzb2NrZXRFdmVudHMuU1RBUlRfVFVSTik7CiAgICAgIH0KCiAgICAgIHRoaXMucGxheWVycy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHsKICAgICAgICB2YXIgdGFyZ2V0ID0gX3RoaXMzLmJhbmRXaWR0aCAqIChwbGF5ZXIudG8gKyAwLjUpOwoKICAgICAgICBpZiAocGxheWVyLnNoaXAueCA+PSB0YXJnZXQgJiYgcGxheWVyLnNoaXAuYm9keS52ZWxvY2l0eS54ID4gMCB8fCBwbGF5ZXIuc2hpcC54IDw9IHRhcmdldCAmJiBwbGF5ZXIuc2hpcC5ib2R5LnZlbG9jaXR5LnggPCAwKSB7CiAgICAgICAgICBwbGF5ZXIuc2hpcC5zZXRWZWxvY2l0eVgoMCk7CiAgICAgICAgICBwbGF5ZXIuc2hpcC5zZXRBbmd1bGFyVmVsb2NpdHkoMCk7CiAgICAgICAgICBfdGhpczMucGxheWVyc1N0b3BwZWQrKzsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgaWYgKHRoaXMucGxheWVyc1N0b3BwZWQgPj0gdGhpcy5wbGF5ZXJzLmxlbmd0aCkgewogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXMzLnNvY2tldC5lbWl0KHdlYnNvY2tldEV2ZW50cy5SRUFEWV9UVVJOKTsKICAgICAgICB9LCAxMDAwKTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImRyYXdGaW5pc2hMaW5lIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkcmF3RmluaXNoTGluZSgpIHsKICAgICAgdmFyIGdyYXBoaWNzID0gdGhpcy5hZGQuZ3JhcGhpY3MoKTsKICAgICAgdmFyIG51bWJlck9mU3F1YXJlcyA9IDM7CiAgICAgIHZhciBzcXVhcmVEaW0gPSB0aGlzLmJhbmRXaWR0aCAvIG51bWJlck9mU3F1YXJlczsKICAgICAgdmFyIHggPSB0aGlzLmJhbmRXaWR0aCAqIHRoaXMucG9pbnRzVG9XaW47CiAgICAgIHZhciB5ID0gMDsKICAgICAgdmFyIGN1cnJlbnRDb2xvciA9IDB4MDsKCiAgICAgIHdoaWxlICh5IDwgZ2FtZURpbWVuc2lvbnMuaGVpZ2h0KSB7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1iZXJPZlNxdWFyZXM7IGkrKykgewogICAgICAgICAgZ3JhcGhpY3MuZmlsbFN0eWxlKGN1cnJlbnRDb2xvciwgMS4wKTsKICAgICAgICAgIGdyYXBoaWNzLmZpbGxSZWN0KHggKyBzcXVhcmVEaW0gKiBpLCB5LCBzcXVhcmVEaW0sIHNxdWFyZURpbSk7CiAgICAgICAgICBjdXJyZW50Q29sb3IgPSBjdXJyZW50Q29sb3IgPT09IDB4MCA/IDB4Q0NDQ0NDIDogMHgwOwogICAgICAgIH0KCiAgICAgICAgeSArPSBzcXVhcmVEaW07CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJjcmVhdGVTaGlwcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlU2hpcHMoKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgdGhpcy5wbGF5ZXJzLmZvckVhY2goZnVuY3Rpb24gKHBsYXllciwgaW5kZXgpIHsKICAgICAgICBwbGF5ZXIuc2hpcCA9IF90aGlzNC5waHlzaWNzLmFkZC5zcHJpdGUoX3RoaXM0LmJhbmRXaWR0aCAqIChwbGF5ZXIuZnJvbSArIDAuNSksIF90aGlzNC5saW5lSGVpZ2h0ICogKGluZGV4ICsgMC41KSwgInNoaXAiICsgcGxheWVyLmNvbG9yKTsKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAic2V0U2hpcHNNb3ZlbWVudHMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldFNoaXBzTW92ZW1lbnRzKCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIHRoaXMucGxheWVycy5mb3JFYWNoKGZ1bmN0aW9uIChwbGF5ZXIpIHsKICAgICAgICBwbGF5ZXIuc2hpcC5zZXRWZWxvY2l0eVgoTWF0aC5zaWduKHBsYXllci50byAtIHBsYXllci5mcm9tKSAqIF90aGlzNS5zcGVlZCk7CgogICAgICAgIGlmIChwbGF5ZXIudG8gPCBwbGF5ZXIuZnJvbSkgewogICAgICAgICAgcGxheWVyLnNoaXAuc2V0QW5ndWxhclZlbG9jaXR5KF90aGlzNS5hbmd1bGFyU3BlZWQpOwogICAgICAgIH0gZWxzZSBpZiAocGxheWVyLnRvID09PSBwbGF5ZXIuZnJvbSkgX3RoaXM1LnBsYXllcnNTdG9wcGVkKys7CiAgICAgIH0pOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIFJhbmtpbmdTY2VuZTsKfShQaGFzZXIuU2NlbmUpOwoKZXhwb3J0IHsgUmFua2luZ1NjZW5lIGFzIGRlZmF1bHQgfTs="},{"version":3,"sources":["C:/Users/matte/Desktop/papero/cosmos.papero.me/src/phaser/RankingScene.js"],"names":["Phaser","gameDimensions","sceneKeys","websocketEvents","_","RankingScene","socket","pointsToWin","key","ranking","speed","angularSpeed","on","START_TURN","game","scene","start","cloneDeep","data","console","log","players","timer","Infinity","bandWidth","width","lineHeight","height","length","playersStopped","load","image","drawFinishLine","createShips","setShipsMovements","timerText","add","text","Date","now","toFixed","fontSize","setOrigin","pause","setTimeout","resume","setText","emit","forEach","player","target","to","ship","x","body","velocity","setVelocityX","setAngularVelocity","READY_TURN","graphics","numberOfSquares","squareDim","y","currentColor","i","fillStyle","fillRect","index","physics","sprite","from","color","Math","sign","Scene"],"mappings":"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","sourcesContent":["import Phaser from \"phaser\";\r\nimport {gameDimensions, sceneKeys} from \"../constants/gameSettings\";\r\nimport websocketEvents from \"../constants/websocketEvents\";\r\nimport _ from \"lodash\";\r\n\r\nexport default class RankingScene extends Phaser.Scene {\r\n\r\n    constructor(socket, pointsToWin) {\r\n        super({key: sceneKeys.ranking});\r\n\r\n        this.socket = socket;\r\n        this.pointsToWin = pointsToWin;\r\n\r\n        this.speed = 300;\r\n        this.angularSpeed = 1200;\r\n        this.socket.on(websocketEvents.START_TURN, game => {\r\n            this.scene.start(sceneKeys.game, _.cloneDeep(game));\r\n        });\r\n    }\r\n\r\n    init(data){\r\n        console.log(_.cloneDeep(data))\r\n        this.players = _.cloneDeep(data.players);\r\n        this.timer = data.timer ? data.timer : Infinity;\r\n        this.bandWidth = gameDimensions.width / (this.pointsToWin+1);\r\n        this.lineHeight = gameDimensions.height / this.players.length;\r\n        this.playersStopped = 0;\r\n    }\r\n\r\n    preload(){\r\n        this.load.image(\"ship0\", \"./ships/ship0.png\");\r\n        this.load.image(\"ship1\", \"./ships/ship1.png\");\r\n        this.load.image(\"ship2\", \"./ships/ship2.png\");\r\n        this.load.image(\"ship3\", \"./ships/ship3.png\");\r\n    }\r\n\r\n    create(){\r\n\r\n        this.drawFinishLine();\r\n\r\n        this.createShips();\r\n\r\n        this.setShipsMovements();\r\n\r\n        this.timerText = this.add.text(gameDimensions.width/2, 20, ((this.timer-Date.now())/1000).toFixed(0), {fontSize: 30});\r\n        this.timerText.setOrigin(0.5);\r\n        this.scene.pause();\r\n        setTimeout(()=>{\r\n            this.scene.resume();\r\n        }, 1000);\r\n\r\n    }\r\n\r\n    update(){\r\n        const text = this.timer===Infinity ? \"Game over (F5 to restart)\" : ((this.timer-Date.now())/1000).toFixed(0);\r\n        this.timerText.setText(text);\r\n        if(this.timer<Date.now()) {\r\n            console.log(\"timeout\");\r\n            this.socket.emit(websocketEvents.START_TURN);\r\n        }\r\n        this.players.forEach(player => {\r\n            const target = this.bandWidth * (player.to+0.5);\r\n            if(\r\n                (player.ship.x >= target && player.ship.body.velocity.x > 0) ||\r\n                (player.ship.x <= target && player.ship.body.velocity.x < 0)\r\n            ) {\r\n                player.ship.setVelocityX(0);\r\n                player.ship.setAngularVelocity(0);\r\n                this.playersStopped++;\r\n            }\r\n        });\r\n        if(this.playersStopped >= this.players.length) {\r\n            setTimeout(()=>{\r\n                this.socket.emit(websocketEvents.READY_TURN);\r\n            }, 1000);\r\n        }\r\n    }\r\n\r\n    drawFinishLine(){\r\n        const graphics = this.add.graphics();\r\n        const numberOfSquares = 3;\r\n        const squareDim = this.bandWidth / numberOfSquares;\r\n        let x = this.bandWidth * this.pointsToWin;\r\n        let y = 0;\r\n        let currentColor = 0x0\r\n        while( y < gameDimensions.height){\r\n            for(let i = 0; i < numberOfSquares; i++){\r\n                graphics.fillStyle(currentColor, 1.0);\r\n                graphics.fillRect(x+squareDim*i, y, squareDim, squareDim);\r\n                currentColor = currentColor === 0x0 ? 0xCCCCCC : 0x0;\r\n            }\r\n\r\n            y += squareDim;\r\n        }\r\n    }\r\n\r\n    createShips(){\r\n        this.players.forEach((player, index) => {\r\n            player.ship = this.physics.add.sprite(this.bandWidth * (player.from+0.5), this.lineHeight * (index+0.5), \"ship\"+player.color);\r\n        });\r\n    }\r\n\r\n    setShipsMovements(){\r\n        this.players.forEach(player => {\r\n            player.ship.setVelocityX(Math.sign(player.to-player.from) * this.speed);\r\n            if(player.to < player.from){\r\n                player.ship.setAngularVelocity(this.angularSpeed);\r\n            } else if(player.to === player.from) this.playersStopped++;\r\n        });\r\n    }\r\n}"]}]}